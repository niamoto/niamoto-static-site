<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Niamoto - MARE</title>
    <link rel="stylesheet" href="../js/vendor/tailwindcss/2.2.19_dist_tailwind.css">
    <link rel="stylesheet" href="../js/vendor/leaflet/1.9.4_leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
<script src="../js/shape_list.js"></script>

<style>
    #shape-type-list li, #shape-list li {
        list-style: none;
        text-transform: capitalize;
    }

    .shape-type-link, .shape-link {
        display: block;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
    }

    .shape-type-link:hover, .shape-link:hover {
        background-color: #f0f0f0;
    }

    .shape-type-link.active, .shape-link.active {
        background-color: #3498db;
        color: #fff;
    }

    #shapeMap, #allShapesMap {
        position: relative;
        height: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #allShapesMap {
        height: 400px;
    }

    .chart-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .chart-container > div {
        flex: 1 1 calc(33.333% - 10px);
        margin: 5px;
    }
    .custom-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    padding: 5px;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    font-size: 12px;
    max-width: 300px;
    word-wrap: break-word;
}
</style>

    <style>
        .gauge {
            height: 349px;
        }

        ul {
            list-style-type: none;
        }

        .loader-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bg p-4 fixed w-full top-0 shadow-md z-50 custom-nav">
    <div class="container mx-auto flex flex-wrap items-center justify-between">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <a id="home-link" class="inline-flex items-center py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                <span class="site-title">Niamoto</span>
            </a>
        </div>

        <div class="block lg:hidden">
            <button id="nav-toggle"
                class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
                <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0zm0 6h20v2H0zm0 6h20v2H0z" />
                </svg>
            </button>
        </div>
        <div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block pt-6 lg:pt-0" id="nav-content">
            <ul class="list-reset lg:flex justify-end flex-1 items-center">
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                        <i class="fas fa-home menu-icon"></i>Accueil
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#introduction">Introduction</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#project">Projet</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#objective">Objectifs</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#context">Contexte</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#flora">Flore</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="methodology.html">
                        <i class="fas fa-flask menu-icon"></i>Méthodologie
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#methodes">Nos méthodes</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#faq">FAQ</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="trees.html">
                        <i class="fas fa-leaf menu-icon"></i>Arbres
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#learnTaxon">Étudier les
                arbres</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#taxon">Les arbres de
                Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="plots.html">
                        <i class="fas fa-map-marked-alt menu-icon"></i>Peuplements
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#learnPlot">Étudier les
                            peuplements forestiers</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#plot">Les
                peuplements forestiers de Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="forests.html">
                        <i class="fas fa-tree menu-icon"></i>Forêt
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#learnForest">Étudier les
                forêts</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPN">La forêt de la
                province Nord</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPS">La forêt de la
                province Sud</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="resources.html">
                        <i class="fas fa-book menu-icon"></i>Ressources
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#equipe">L'équipe</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#article">Articles</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#academic">Académique</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#media-production">Médias</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
  document.getElementById('nav-toggle').onclick = function () {
    document.getElementById('nav-content').classList.toggle('hidden');
  };

  // Function to adjust the navigation links based on page depth
  function adjustNavLinks(depth) {
    document.querySelectorAll('a[data-link]').forEach(link => {
      link.href = depth + link.getAttribute('data-link');
    });
  }

  // Adjust the navigation links based on the depth
  adjustNavLinks("../");
</script>

<style>
    .site-title {
        font-family: 'Arial Black', sans-serif; /* Custom font for a bold effect */
        font-size: 2rem; /* Increased font size */
        text-transform: uppercase; /* Uppercase letters for visibility */
        letter-spacing: 2px; /* Spacing between letters */
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7); /* Text shadow for better visibility */
        transition: color 0.3s; /* Smooth transition for hover effect */
    }

    .site-title:hover {
        color: #ffdd57; /* Change color on hover */
    }

    .text-contour {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .nav-bg {
        background-color: rgba(34, 139, 34, 0.8); /* Fond vert semi-transparent */
        transition: background-color 0.3s;
    }

    .nav-bg:hover {
        background-color: rgba(34, 139, 34, 1); /* Fond vert opaque au survol */
    }

    .group:hover .group-hover\:block {
        display: block;
    }

    .custom-nav {
        z-index: 500;
    }

    .custom-dropdown {
        z-index: 500;
    }

    .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.2); /* Fond blanc transparent au survol */
        border-radius: 4px;
    }

    .menu-icon {
        margin-right: 8px;
    }
</style>
    <div class="flex">
        
<aside class="w-1/4 p-4 mt-28">
    <h2 class="font-semibold text-lg mb-4">Shape Types</h2>
    <ul id="shape-type-list" class="list-disc pl-5">
        <!-- The list of shape types will be generated by JavaScript -->
    </ul>
</aside>

        <div class="w-full">
            
<div id="allShapesMap" class="mt-28"></div>

<div class="rounded overflow-hidden shadow-lg mb-2 mt-8">
    <div class="px-6 py-4">
        <div class="font-bold text-4xl mb-2">MARE</div>
    </div>
</div>

<div class="chart-container">
    <!-- Section for general information -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">General Information</h2>
            
                
                    
                        
                        
                            <p>Shape Area (Total Area): 65969.83521858504</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Number of Families (Number of Families): 41</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Species (Number of Species): 119</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Occurrences (Number of Occurrences): 598</p>
                        
                    
                
            
                
                    
                        
                        
                    
                
                    
                        
                        
                    
                
            
                
                    
                        
                        
                    
                
                    
                        
                        
                    
                
                    
                
            
                
                    
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        </div>
    </div>

    <!-- Section for shape map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Shape Map</h2>
            <div id="shapeMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="shapeMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Section for forest map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Forest Map</h2>
            <div id="forestMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="forestMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>
</div>

<div class="flex flex-wrap -mx-2">
    

    

    
    
        
    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
    
        
            
            

            
            
                
            
                
            
                
            

    
        
    
        
            
            

            
            
                
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
</div>

        </div>
    </div>
    <footer class="bg-green-700 text-white p-4 mt-8">
        <div class="container mx-auto">
            <div class="flex justify-center mb-4">
                <div class="bg-white p-2 rounded-lg shadow-md flex justify-center">
                    <figure class="mx-2"><img class="img-fluid" src="../files/ps_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/pn_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/amap_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/herbarium_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/iac_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/ird_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/cirad_100.png"></figure>
                </div>
            </div>
            <div class="text-center">
                <p>Niamoto - Portail de la forêt de Nouvelle-Calédonie</p>
                <a class="inline-block py-2 px-4 text-white no-underline" href="https://github.com/niamoto/niamoto" target="_blank">
                    <span class="fab fa-github fa-lg" aria-hidden="true"></span> Github
                </a>
            </div>
        </div>
    </footer>
    <script src="../js/vendor/chart/4.4.2_chart.js"></script>
    <script src="../js/vendor/d3/7.8.5_d3.js"></script>
    <script src="../js/vendor/jquery/3.6.0_jquery.js"></script>
    <script src="../js/vendor/raphael/2.3.0_raphael.js"></script>
    <script src="../js/vendor/justgage/1.6.1_justgage.js"></script>
    <script src="../js/vendor/leaflet/1.9.4_leaflet.js"></script>
    
<script>
    var shape = {"elevation_elevation_distribution": null, "elevation_max": null, "elevation_median": null, "forest_area": null, "forest_coordinates": null, "forest_cover_percentage": null, "forest_fragmentation_effective_mesh_size": null, "forest_fragmentation_fragment_size_distribution": null, "forest_humidity_category_distribution": null, "frequencies": {}, "id": 18, "land_use_category_distribution": null, "name": "MARE", "num_families_unique_taxonomic_count": 41, "num_occurrences_count": 598, "num_species_unique_taxonomic_count": 119, "rainfall_mean": null, "rainfall_range": null, "shape_area": "65969.83521858504", "shape_coordinates": "{\"type\": \"FeatureCollection\", \"features\": [{\"id\": \"0\", \"type\": \"Feature\", \"properties\": {}, \"geometry\": {\"type\": \"MultiPolygon\", \"coordinates\": [[[[167.9726847380591, -21.425776451185595], [167.98069780572825, -21.43863506348901], [167.9921165904284, -21.449018678865173], [167.9993142769768, -21.45813338865532], [168.00440828458392, -21.460168174928466], [168.01581638525855, -21.46119056405615], [168.01980080530592, -21.463400529875674], [168.02325587377243, -21.46271579912325], [168.02919357207, -21.466689860703752], [168.04157538693786, -21.462401399561774], [168.0533408024287, -21.454760730469296], [168.08427790689876, -21.454966368440452], [168.09750706679853, -21.4485079124371], [168.09893920782665, -21.446164731157328], [168.10046976841193, -21.446921274245014], [168.1015143129435, -21.444365964872993], [168.11647579863066, -21.43530413354306], [168.13339384966935, -21.446625526330884], [168.13174198119123, -21.454670026664182], [168.12657082617076, -21.457379098166214], [168.12052201452502, -21.4653519561759], [168.12128051048217, -21.46687607141568], [168.11694878935043, -21.4845174980856], [168.11812809456148, -21.488759882442583], [168.12404960255748, -21.49558665778188], [168.1238237270963, -21.50263197733675], [168.12268283354427, -21.50527478404508], [168.11757322664016, -21.507556600857455], [168.11431372707236, -21.5117299216438], [168.1112022613111, -21.52349906257662], [168.113732060011, -21.532151227331397], [168.11403649968236, -21.54364707733429], [168.10721858748, -21.56527105026073], [168.10736374234355, -21.587632128601605], [168.11639479672394, -21.617594506270688], [168.11632746557075, -21.626405039885302], [168.1143254560804, -21.628522332404156], [168.10363763837424, -21.6309931724331], [168.08860754755452, -21.63040828344638], [168.0759359270636, -21.634802828614152], [168.07162249379027, -21.64161355285508], [168.06708048639697, -21.643677509043233], [168.06239430448656, -21.643470104465283], [168.05327680685292, -21.639906157733837], [168.04800207132425, -21.64191931552108], [168.04293184845324, -21.64817527721138], [168.04138800914265, -21.656929029302223], [168.03825261032827, -21.659258482413197], [168.02902953514553, -21.659054277275757], [168.02615499994982, -21.660409883177294], [168.01733850956896, -21.657925380853374], [168.01744854678617, -21.65810359314395], [168.01710251771823, -21.658565532665243], [168.0146720655187, -21.659617792073842], [168.00655241119682, -21.65911928002527], [168.00132503755918, -21.65522748207277], [167.99774776323176, -21.65482433638], [167.9939797447412, -21.6565784961067], [167.98389316635087, -21.657431558762404], [167.97973334414863, -21.660920757978886], [167.97774208142698, -21.66015474936173], [167.976231807303, -21.655004176246106], [167.9735794015316, -21.6523821219241], [167.9587477664673, -21.64969363980963], [167.95357842895768, -21.63685440023897], [167.9462886663273, -21.634645241309123], [167.94468429778826, -21.63063019666526], [167.9525515340653, -21.617246434447374], [167.9478216823493, -21.60986973042806], [167.94516797550153, -21.60188035849597], [167.94032139893523, -21.604751954883373], [167.93566681707478, -21.604909022527885], [167.92033053814768, -21.60125082409202], [167.91539476372787, -21.602645008770754], [167.90864246951654, -21.59722711045035], [167.90271186164028, -21.596781687981224], [167.8898927131015, -21.60039498645369], [167.8776104478362, -21.600527008821953], [167.86364176321402, -21.59831858465443], [167.85863092901474, -21.601926140228674], [167.845818940939, -21.600422702535077], [167.84503749751028, -21.59747504161846], [167.8499384943811, -21.59224515264071], [167.85927497057523, -21.590067737013676], [167.86444425449372, -21.57538833066014], [167.86896496848962, -21.57480305466108], [167.87395955882488, -21.571475909333778], [167.8740553084601, -21.567846480750138], [167.87489633954945, -21.567949643673124], [167.87687264272657, -21.56647400097135], [167.87526965742174, -21.561609195545547], [167.8776463836626, -21.559678407453834], [167.87881287256008, -21.550459899024613], [167.87786912783022, -21.54840188662616], [167.87613140164595, -21.548098521047184], [167.87518151550802, -21.54725393525197], [167.87734119391908, -21.54798758370628], [167.87568838551485, -21.544514249914876], [167.87588044664008, -21.543588265744987], [167.87046161380903, -21.544340179023315], [167.86431428202, -21.532517634053846], [167.85343203662242, -21.52642614941336], [167.85210020257423, -21.5194396947238], [167.84844416889143, -21.517205825754797], [167.8499341480372, -21.515021867050006], [167.8477577642549, -21.51524982131861], [167.8459493521993, -21.512172683826236], [167.8443228891516, -21.506873902912293], [167.84610715711537, -21.505410861862398], [167.84075216887965, -21.498738973033134], [167.8410687003136, -21.49637641482718], [167.8386837725932, -21.49596576433297], [167.83846448464712, -21.49316979332474], [167.835774199663, -21.49223497588309], [167.8322757328571, -21.481558374331527], [167.8350430149314, -21.47843703041075], [167.8354719424748, -21.46827398241412], [167.83865075183925, -21.461329859022907], [167.8393325927318, -21.45492716529996], [167.83527042076463, -21.444143757991778], [167.8343062226208, -21.438353964081553], [167.83483016734573, -21.43751565030463], [167.82561137247188, -21.420532274997445], [167.80694178456793, -21.405868766900653], [167.80425842630873, -21.389557941332946], [167.80030707106403, -21.381921570168736], [167.8062133467537, -21.37936463027651], [167.810972807942, -21.379845793440612], [167.81263012071696, -21.377423480011785], [167.81710839117264, -21.375537470424433], [167.81822856519454, -21.375751307295356], [167.81906844734797, -21.374661931895943], [167.81895797581112, -21.3742738513427], [167.82069046293756, -21.374764694518333], [167.82159079993463, -21.373522715726775], [167.82434908922815, -21.37468146079436], [167.8265436281249, -21.37446029870496], [167.8267940215325, -21.375062889455194], [167.83293101437238, -21.37491422068179], [167.83332464534794, -21.37592158642502], [167.8394862498811, -21.37578798882517], [167.8544106219291, -21.385990608315627], [167.8578962760913, -21.389160080806683], [167.85763822195352, -21.389832664704446], [167.86804626995186, -21.39422831951624], [167.86604566591538, -21.39352890974543], [167.86589268284195, -21.395533693930652], [167.86719621151153, -21.396325871219858], [167.86759409728805, -21.396118660784047], [167.86867714266052, -21.396528407242464], [167.86883460576766, -21.39636143627036], [167.87083712904789, -21.398973091044418], [167.87400573798882, -21.400518915431935], [167.88749659868446, -21.403479224810898], [167.89184764479742, -21.402555463857365], [167.89621781936603, -21.399012409840886], [167.89777360462585, -21.396837697280215], [167.8992203050686, -21.381498881039363], [167.90747026522786, -21.37970345024857], [167.9188100680161, -21.382363159301164], [167.9261828028725, -21.374553877608182], [167.93356584405663, -21.37369900365159], [167.94595769853453, -21.36790551303325], [167.95681166843667, -21.36878592217107], [167.95846097841545, -21.36725935449114], [167.95794528377735, -21.363868252062414], [167.96000978863313, -21.363310745964363], [167.96854189503887, -21.350561024905623], [167.97420314861537, -21.348340185871727], [167.97747000193434, -21.350167682726035], [167.97891457631573, -21.35797729748674], [167.9747467615904, -21.362178951620006], [167.96439838344912, -21.36795744310167], [167.96257147060643, -21.37021372603574], [167.95953242239142, -21.373080872577418], [167.95790988468607, -21.375304612308923], [167.9592597898493, -21.373151823065086], [167.96189226255333, -21.370525980087475], [167.96225054055, -21.370413621384408], [167.96274687710815, -21.369900367357864], [167.9617033197853, -21.370494299309208], [167.95918031320807, -21.373066045717845], [167.95689413652673, -21.376635635977223], [167.95263041526465, -21.38795727964863], [167.95371965731877, -21.394467302116105], [167.9583418638355, -21.40434824878791], [167.9655359913838, -21.410541801636683], [167.9726847380591, -21.425776451185595]], [[167.8703212367488, -21.574131985949926], [167.87023062895386, -21.57405166675194], [167.8699752749336, -21.574209657070075], [167.8703802292858, -21.57434913864789], [167.8703212367488, -21.574131985949926]]], [[[167.73741062483984, -21.37923414702186], [167.73303207627907, -21.37571432735006], [167.7350025121649, -21.367447409849483], [167.73092558703252, -21.356289854102176], [167.73427386455222, -21.346036698708787], [167.74074322823176, -21.34235659899239], [167.74340621655256, -21.345645405001274], [167.74430536236608, -21.3505068954517], [167.73568490330496, -21.36043773463093], [167.73734785181142, -21.36459151317327], [167.73687526733886, -21.368831685730218], [167.73872147818716, -21.370951576903916], [167.73920633111226, -21.377078533061514], [167.73741062483984, -21.37923414702186]]], [[[167.54819272350124, -21.13458881039258], [167.54429974153456, -21.13252887085145], [167.54359135415075, -21.130251687212514], [167.5492531123981, -21.12952678538245], [167.5548307510781, -21.131706555684683], [167.56705607678168, -21.14311346573507], [167.5677160307109, -21.148395909593773], [167.5628877381516, -21.148131899354595], [167.55361220028757, -21.138187142679744], [167.54819272350124, -21.13458881039258]]], [[[167.59429507668807, -21.26634938684996], [167.59052615206622, -21.261652025000533], [167.58881097693413, -21.260710451536827], [167.5866617951596, -21.258230183365367], [167.58621659323083, -21.25799613478066], [167.58744705417368, -21.255303141396816], [167.59289082026498, -21.25500529457276], [167.5959086506624, -21.25805843433958], [167.5974835115561, -21.26451072885931], [167.59618784576975, -21.26692482790103], [167.59429507668807, -21.26634938684996]]], [[[167.56871089285616, -21.31764260821531], [167.5674120908015, -21.31520036365294], [167.5683258506572, -21.313290570420996], [167.57296820520028, -21.309705784879696], [167.57605906712857, -21.31033953903662], [167.5767264993963, -21.31542841169851], [167.57551304024096, -21.317098228460804], [167.57113174951849, -21.320336409592812], [167.57031169949428, -21.319874330380546], [167.56871089285616, -21.31764260821531]]], [[[167.8208195614305, -21.372538485304638], [167.82091747287015, -21.372307929159344], [167.82235466767614, -21.373101081401085], [167.82189520696147, -21.373003065486138], [167.82134705319768, -21.373261020138152], [167.8208195614305, -21.372538485304638]]], [[[167.81884827944742, -21.373709786990748], [167.81919515218556, -21.373370459903395], [167.81936446306415, -21.373415613826694], [167.8190570998349, -21.37404508978432], [167.81884827944742, -21.373709786990748]]], [[[167.8193546134121, -21.372335759911795], [167.82018272363763, -21.372265927739694], [167.82035145438536, -21.372504189195823], [167.81944869588463, -21.372517881867036], [167.8193546134121, -21.372335759911795]]], [[[167.73381728732963, -21.36891578597735], [167.73375253642521, -21.36815965465973], [167.73397895695246, -21.368127872304676], [167.73406200452513, -21.368438715354976], [167.73381728732963, -21.36891578597735]]], [[[167.8669533595048, -21.394554694870937], [167.86686761939575, -21.394757220503116], [167.86655594693894, -21.394602065269314], [167.8668805048528, -21.394426624173896], [167.8669533595048, -21.394554694870937]]], [[[167.82247486401096, -21.373704973664527], [167.82243896209505, -21.373487458390944], [167.8227697380928, -21.373577149646593], [167.8227375742833, -21.373756782406016], [167.8225890852535, -21.373646708882546], [167.82247486401096, -21.373704973664527]]], [[[167.8728205503492, -21.571651009891212], [167.87273087756444, -21.571553202664074], [167.8729410450304, -21.571379120771553], [167.87325230251102, -21.571561630899353], [167.8728205503492, -21.571651009891212]]], [[[167.8736983007925, -21.570811533835556], [167.87341797345513, -21.570848180050888], [167.8733536386713, -21.570730613922237], [167.87356536309275, -21.570521429520024], [167.8736983007925, -21.570811533835556]]], [[[167.81202871682015, -21.37634024944535], [167.81216007865817, -21.376259132523916], [167.81197988537258, -21.376559752648472], [167.81191245670576, -21.37642285537544], [167.81202871682015, -21.37634024944535]]], [[[167.81741459154534, -21.374494833595097], [167.81750943909176, -21.374403821250024], [167.81770572587325, -21.3746945299165], [167.81754323327868, -21.374726362047348], [167.81741459154534, -21.374494833595097]]], [[[167.8268520985521, -21.37449017346236], [167.82685563790562, -21.3746942303713], [167.8267036935915, -21.37465615660096], [167.82674645547885, -21.37436475693837], [167.8268520985521, -21.37449017346236]]], [[[167.90071089511977, -21.380771340518606], [167.9009029011425, -21.38076491715084], [167.90097548713356, -21.38085045707205], [167.90065184316327, -21.380882137077673], [167.90071089511977, -21.380771340518606]]], [[[167.8684614556041, -21.395758773011178], [167.86830284137636, -21.39583174810442], [167.86820769627246, -21.395684939712464], [167.86839957329664, -21.395630525943307], [167.8684614556041, -21.395758773011178]]], [[[167.83418476303368, -21.449845697598306], [167.83424578708133, -21.44970204197758], [167.8343045266165, -21.449661732273523], [167.83434714112335, -21.449961543157], [167.83418476303368, -21.449845697598306]]], [[[167.86872822236833, -21.396381588010982], [167.86871247697184, -21.396116052966462], [167.8688395006299, -21.39611698847006], [167.86887569598667, -21.39621186531314], [167.86872822236833, -21.396381588010982]]], [[[167.85592497475594, -21.38783127974798], [167.85589235911095, -21.387670255461707], [167.85601645915244, -21.38763897563156], [167.8560661272795, -21.387834244781466], [167.85592497475594, -21.38783127974798]]], [[[167.8185670241016, -21.37391333430097], [167.81852891409915, -21.373703927004932], [167.8185582173133, -21.373675586788828], [167.81875262833358, -21.373812868160783], [167.8185670241016, -21.37391333430097]]], [[[167.81877820410375, -21.37465756157181], [167.81871547136052, -21.37442943493285], [167.81875153622843, -21.37438410186418], [167.81893504399955, -21.3744797053543], [167.81877820410375, -21.37465756157181]]], [[[167.82866572443623, -21.374552630191026], [167.82866844084538, -21.37439253246659], [167.8288509407731, -21.374610752562084], [167.82873948310754, -21.374692477630717], [167.82866572443623, -21.374552630191026]]], [[[167.8235148803344, -21.373652367652266], [167.82334528054636, -21.37359033807085], [167.82347454064976, -21.37345033877412], [167.82359220314052, -21.37359099144028], [167.8235148803344, -21.373652367652266]]], [[[167.8230028804101, -21.37377772311295], [167.82290590236914, -21.373564072828966], [167.82297930321036, -21.373457230593853], [167.8230640634015, -21.373644628392398], [167.8230028804101, -21.37377772311295]]], [[[167.73371836174678, -21.36713034207519], [167.73369626020715, -21.36725425320822], [167.73356239699223, -21.367242681293924], [167.73356673813717, -21.367088052360522], [167.73371836174678, -21.36713034207519]]], [[[167.82052392369957, -21.373049293796218], [167.82044724085887, -21.372966754069452], [167.82038039133042, -21.372817993231937], [167.82060220729485, -21.372952652008976], [167.82052392369957, -21.373049293796218]]], [[[167.82258864387092, -21.373938196257452], [167.822481815784, -21.373789303754265], [167.82260292759557, -21.373722120236135], [167.8226863039836, -21.37387430394134], [167.82258864387092, -21.373938196257452]]], [[[167.86805034815924, -21.395392263903723], [167.86792579800093, -21.39535457116892], [167.86799633857584, -21.395178718480963], [167.86813704651527, -21.395330689893694], [167.86805034815924, -21.395392263903723]]], [[[167.86826749460027, -21.395172982715106], [167.8681146389898, -21.395217971586906], [167.8680484479751, -21.395111822633613], [167.86826727169154, -21.395073132306102], [167.86826749460027, -21.395172982715106]]], [[[167.8784112490286, -21.55004075566498], [167.87830340614397, -21.550131042813174], [167.87825002776967, -21.549875285056245], [167.87835227953732, -21.549927800949305], [167.8784112490286, -21.55004075566498]]], [[[167.8191353311729, -21.372437470082584], [167.81911880712153, -21.37256987782414], [167.81896505817375, -21.37247236035801], [167.81901227392032, -21.372392344752253], [167.8191353311729, -21.372437470082584]]], [[[167.82238405655173, -21.37339505236426], [167.82227009501716, -21.373286652055715], [167.8223505608874, -21.373225955722294], [167.82248829219824, -21.373303157770675], [167.82238405655173, -21.37339505236426]]], [[[167.85541296203436, -21.387288486166167], [167.85549827940082, -21.38719173169686], [167.8556066568581, -21.387336909646734], [167.8554943306864, -21.387368735773006], [167.85541296203436, -21.387288486166167]]], [[[167.81548222358035, -21.376407764011013], [167.81556787244196, -21.37655624995453], [167.81555896113514, -21.37658501817987], [167.81535467125235, -21.37637518678008], [167.81548222358035, -21.376407764011013]]], [[[167.8351365464035, -21.441850814815226], [167.83493302346412, -21.44185327743632], [167.83491248952774, -21.441786937967986], [167.8349989536943, -21.441743414596033], [167.8351365464035, -21.441850814815226]]], [[[167.9559966570152, -21.38183532579164], [167.95592482266608, -21.381898036484788], [167.95585166606688, -21.38183866904445], [167.95596051318094, -21.38170713376949], [167.9559966570152, -21.38183532579164]]], [[[167.83711645388988, -21.447754783013394], [167.8372458407916, -21.447687571145245], [167.83732448279147, -21.44770401328394], [167.83721903024826, -21.447811601896152], [167.83711645388988, -21.447754783013394]]], [[[167.86913912564407, -21.396011802308013], [167.86898126992585, -21.3960180142642], [167.86895949825842, -21.395976316936423], [167.8691381383138, -21.39589367728048], [167.86913912564407, -21.396011802308013]]], [[[167.82195836817576, -21.373482281543083], [167.82186329928112, -21.373424251460772], [167.82176473998635, -21.37343603168317], [167.82190237844293, -21.37332674529154], [167.82195836817576, -21.373482281543083]]], [[[167.8766976641951, -21.56357961729945], [167.8765169324338, -21.563597671480967], [167.87650662841006, -21.563503572729925], [167.8766186601914, -21.563490526558223], [167.8766976641951, -21.56357961729945]]], [[[167.81798143894983, -21.375544240177568], [167.81786173311906, -21.375421238629745], [167.81790458175243, -21.375315598665342], [167.81801200940393, -21.375363162411748], [167.81798143894983, -21.375544240177568]]], [[[168.0171550646472, -21.658562730881084], [168.0172301763636, -21.658494267020135], [168.01725840004232, -21.658712534058488], [168.01715957794715, -21.658650982996956], [168.0171550646472, -21.658562730881084]]], [[[167.89608849912875, -21.398879817052148], [167.89616863078825, -21.398802007077883], [167.89623884285191, -21.398810287833044], [167.8961850887988, -21.39893996497151], [167.89608849912875, -21.398879817052148]]], [[[167.8695793765311, -21.39676425064811], [167.8694923077599, -21.39666239201112], [167.869654302502, -21.396601834701865], [167.869670143378, -21.396629253664383], [167.8695793765311, -21.39676425064811]]], [[[167.83040501852224, -21.374943163696905], [167.83025864304412, -21.37491015388711], [167.83030177124155, -21.374820658898592], [167.83038790748932, -21.374815676378518], [167.83040501852224, -21.374943163696905]]], [[[167.82256855706981, -21.373366552283105], [167.82254788144726, -21.373258940007265], [167.82260030136743, -21.373208215332635], [167.82266751529448, -21.373377530834727], [167.82256855706981, -21.373366552283105]]], [[[167.82277911136808, -21.373983025349645], [167.8227039431194, -21.37389679360119], [167.82275783295623, -21.373840181262608], [167.8228674723983, -21.3739251512234], [167.82277911136808, -21.373983025349645]]], [[[167.8786663814763, -21.5512675013059], [167.87850901644256, -21.551158814469797], [167.8785065246084, -21.55109487047685], [167.87864532364674, -21.55113757191923], [167.8786663814763, -21.5512675013059]]], [[[167.81867225506284, -21.374378850387046], [167.81856715269907, -21.374329780288615], [167.8185794535605, -21.374225340188538], [167.81870640560123, -21.37431371940556], [167.81867225506284, -21.374378850387046]]], [[[167.87858567093872, -21.551368350307424], [167.87853059805596, -21.551485875095338], [167.87839419698213, -21.551476532722745], [167.8784841014178, -21.55135850800959], [167.87858567093872, -21.551368350307424]]], [[[167.8702235643316, -21.573447256889267], [167.870138151263, -21.573461969988273], [167.87014525699473, -21.573344786546354], [167.87030637382776, -21.573381509284744], [167.8702235643316, -21.573447256889267]]], [[[167.85595499865627, -21.38811348597698], [167.85611079516696, -21.388146332523334], [167.8561400163531, -21.388203151513093], [167.85596737256637, -21.38819332823565], [167.85595499865627, -21.38811348597698]]], [[[168.08852268223353, -21.4526855013848], [168.08848485601675, -21.452750363887127], [168.08842546370977, -21.452755749846958], [168.08843894764652, -21.452607263397034], [168.08852268223353, -21.4526855013848]]], [[[167.9040088908539, -21.380286486240273], [167.90388879981785, -21.38032816250449], [167.9038540660432, -21.380301892642144], [167.9038953879522, -21.380211052844682], [167.9040088908539, -21.380286486240273]]], [[[167.87654993407227, -21.54521694938657], [167.87635847112222, -21.545287850119323], [167.87633073410532, -21.545258713861905], [167.8763873059121, -21.545185064442663], [167.87654993407227, -21.54521694938657]]], [[[167.95405850810673, -21.3859169173869], [167.9540295990058, -21.385995429676434], [167.9539650066048, -21.386009835144634], [167.9539854947862, -21.38585826108395], [167.95405850810673, -21.3859169173869]]], [[[167.87654360160352, -21.563127212034175], [167.87642546980032, -21.563140462150763], [167.8763842159716, -21.563030496632162], [167.87649776779273, -21.563047134059378], [167.87654360160352, -21.563127212034175]]], [[[167.8212049089094, -21.373291080083522], [167.82110645665, -21.373218416617014], [167.82110415296697, -21.373175868394714], [167.82121450071733, -21.37321090533465], [167.8212049089094, -21.373291080083522]]], [[[167.895856532111, -21.398957436569653], [167.89584498064215, -21.398993501873264], [167.8957182047985, -21.399032041128123], [167.89575563528973, -21.39891922484316], [167.895856532111, -21.398957436569653]]], [[[167.81860489126566, -21.374789564089482], [167.81855082069788, -21.37474559264365], [167.81851226533269, -21.374646322661846], [167.81860663938025, -21.37466398392702], [167.81860489126566, -21.374789564089482]]], [[[168.01763316528238, -21.658098646726145], [168.01758940689504, -21.658139588329384], [168.017497776081, -21.65811106566095], [168.01757942115748, -21.658023824505253], [168.01763316528238, -21.658098646726145]]], [[[167.8146208018584, -21.37651305572065], [167.8146144508875, -21.376417707403633], [167.81471397424306, -21.376461718841483], [167.81470431439138, -21.376537485707626], [167.8146208018584, -21.37651305572065]]], [[[167.82361486792226, -21.37405569950034], [167.82366264948467, -21.373963201566042], [167.82369712978917, -21.373962671218734], [167.82370714945108, -21.37408806869659], [167.82361486792226, -21.37405569950034]]], [[[167.8727989346742, -21.399666086501316], [167.87287580423137, -21.399642180347193], [167.8728682371051, -21.399756399627353], [167.87279428512082, -21.399724872479457], [167.8727989346742, -21.399666086501316]]], [[[167.83594174559263, -21.375587973804084], [167.8358885609428, -21.375518958184], [167.83596466580565, -21.375489991634925], [167.83600858112212, -21.375561204904617], [167.83594174559263, -21.375587973804084]]], [[[167.58783849048402, -21.259675090949], [167.58776848277722, -21.259686660472664], [167.58772460765124, -21.259576287317334], [167.58778819599186, -21.2595832516106], [167.58783849048402, -21.259675090949]]], [[[167.58685676999403, -21.258591061034867], [167.58674440075433, -21.258496632423668], [167.58679313175696, -21.258449521832492], [167.58688870811852, -21.258562031872934], [167.58685676999403, -21.258591061034867]]], [[[167.8414647421732, -21.37677491513552], [167.84139156628606, -21.376759146632573], [167.8414841223748, -21.37667256304364], [167.8415154207728, -21.376759451187937], [167.8414647421732, -21.37677491513552]]], [[[167.81765423153453, -21.375116750241258], [167.817596385204, -21.3750809133348], [167.81761867165343, -21.375009362747193], [167.81770442174334, -21.375072672737804], [167.81765423153453, -21.375116750241258]]], [[[167.87604562019703, -21.562157381051534], [167.87597059427748, -21.562227741498084], [167.87588906533063, -21.562120133949342], [167.8760259071137, -21.56214199329082], [167.87604562019703, -21.562157381051534]]], [[[167.5696513265827, -21.318745722407037], [167.56958061936552, -21.318674981370233], [167.56960205076066, -21.31863641635192], [167.56970268660368, -21.318712169149723], [167.5696513265827, -21.318745722407037]]], [[[167.81472785877088, -21.376357984508626], [167.81464234526206, -21.37635340409869], [167.81462271946452, -21.37630671727446], [167.81471230991576, -21.376274524494697], [167.81472785877088, -21.376357984508626]]], [[[167.95325335328087, -21.389855375530203], [167.95320322175635, -21.389895428492103], [167.95314740220027, -21.38979831477471], [167.9531995920941, -21.389766512203845], [167.95325335328087, -21.389855375530203]]], [[[167.89579987531948, -21.398771381724735], [167.8957290655268, -21.39881600604098], [167.89567997368337, -21.398801469093875], [167.89575965107346, -21.398707187904698], [167.89579987531948, -21.398771381724735]]], [[[167.85914250371405, -21.389950347544627], [167.8592382381355, -21.390000273509262], [167.85924678360277, -21.39004052054351], [167.85907921067, -21.389962334993417], [167.85914250371405, -21.389950347544627]]], [[[167.8556293747459, -21.387380612571626], [167.85571931846928, -21.387413730916233], [167.85573007492096, -21.38744587787299], [167.85560942032424, -21.38744992928666], [167.8556293747459, -21.387380612571626]]], [[[167.87665419884806, -21.563699151672903], [167.87656011987713, -21.563762725735973], [167.87651171841668, -21.563669949070377], [167.87655522395053, -21.5636566245991], [167.87665419884806, -21.563699151672903]]], [[[167.80417408251648, -21.389810101172696], [167.80414580197262, -21.38966050169839], [167.80419028439817, -21.389616643670763], [167.80422351281334, -21.389647277231067], [167.80417408251648, -21.389810101172696]]], [[[167.83713305158722, -21.448651119982628], [167.83719397131287, -21.448626240933155], [167.83724948302344, -21.448667092182298], [167.83718392994984, -21.448718724147383], [167.83713305158722, -21.448651119982628]]], [[[167.55627395047657, -21.133317893388774], [167.5562436688125, -21.133371272826704], [167.55617782800718, -21.13337083994766], [167.55620869898985, -21.133278630729862], [167.55627395047657, -21.133317893388774]]], [[[167.87240628658785, -21.5721528920821], [167.87244594309558, -21.57223619281718], [167.872332236996, -21.572223863058618], [167.87236209789893, -21.572129684545516], [167.87240628658785, -21.5721528920821]]], [[[167.85538952226386, -21.38715889464048], [167.8553636663984, -21.38724886356799], [167.85528825435438, -21.387195692418764], [167.85532740738708, -21.387148094912284], [167.85538952226386, -21.38715889464048]]], [[[167.9760484895758, -21.655453077250034], [167.97610283322075, -21.655425263867897], [167.97614871689214, -21.655494248387456], [167.9760556102178, -21.655519475757647], [167.9760484895758, -21.655453077250034]]], [[[167.81602361882227, -21.376574307928475], [167.8159415014591, -21.376540306323932], [167.81593116608386, -21.37648612942738], [167.81603769241966, -21.37652710100184], [167.81602361882227, -21.376574307928475]]], [[[167.8012272025434, -21.385109704547894], [167.80113526181674, -21.385101266144318], [167.80114812551452, -21.385024246148777], [167.8011637135585, -21.385015017673663], [167.8012272025434, -21.385109704547894]]], [[[167.83043464656689, -21.374856111166963], [167.83040025857088, -21.374771468023376], [167.8304476925177, -21.37474945783619], [167.83048778081704, -21.374846495205627], [167.83043464656689, -21.374856111166963]]], [[[167.85618730861023, -21.388217846496655], [167.85627092159527, -21.38815782147582], [167.85629966228925, -21.38823226953414], [167.85621150451087, -21.388256383987457], [167.85618730861023, -21.388217846496655]]], [[[167.9559903409222, -21.38138998761569], [167.9560542046955, -21.38136524678362], [167.95607856429297, -21.381373714516833], [167.9560112265614, -21.381464727968105], [167.9559903409222, -21.38138998761569]]], [[[167.86928396161875, -21.3961311167159], [167.86923307109626, -21.3960675871048], [167.86924619577005, -21.396050746785505], [167.8693406010678, -21.396119877430298], [167.86928396161875, -21.3961311167159]]], [[[167.89582624349535, -21.39883743115444], [167.89572996166527, -21.398893401423607], [167.89570001937642, -21.39887610866238], [167.89575883599377, -21.398811837845887], [167.89582624349535, -21.39883743115444]]], [[[168.01644449522817, -21.65838298109498], [168.0164840376329, -21.658395014955705], [168.01648778161004, -21.658464659362274], [168.0163775787408, -21.658375215699685], [168.01644449522817, -21.65838298109498]]], [[[167.8692563088239, -21.396821625468327], [167.86928509815408, -21.3967677904331], [167.86934648192434, -21.39680175430596], [167.86929993132628, -21.396870394933373], [167.8692563088239, -21.396821625468327]]], [[[168.04258642368643, -21.461480443486284], [168.04256014874093, -21.461418354086145], [168.04268656938316, -21.46142920132436], [168.04268509947786, -21.461448333682576], [168.04258642368643, -21.461480443486284]]], [[[168.04255444699695, -21.461417068839438], [168.04257340413267, -21.46147893158671], [168.04248238208916, -21.461522203150157], [168.04250008854123, -21.461431554615256], [168.04255444699695, -21.461417068839438]]], [[[167.8557988033528, -21.387878733880836], [167.8558467934956, -21.387843494764027], [167.85589785842407, -21.38789484069333], [167.85584837190245, -21.38793377297111], [167.8557988033528, -21.387878733880836]]], [[[167.8724530628847, -21.399470360343017], [167.87250074308213, -21.399407884875774], [167.87252180062177, -21.39941022310883], [167.87250498391904, -21.399504907977082], [167.8724530628847, -21.399470360343017]]], [[[167.96332083167218, -21.3572853754927], [167.96324070278035, -21.357297212387138], [167.9632957813019, -21.357192753833868], [167.9633233611753, -21.357210803046115], [167.96332083167218, -21.3572853754927]]], [[[167.5879243358964, -21.25974937467498], [167.58785755820108, -21.259762006483147], [167.58785634187652, -21.25967287949282], [167.5878812283968, -21.259675171792125], [167.5879243358964, -21.25974937467498]]], [[[167.81723845360585, -21.374967307659784], [167.81718266751128, -21.374964581854407], [167.8171499400567, -21.37489111911799], [167.81719818270184, -21.37489137068383], [167.81723845360585, -21.374967307659784]]], [[[167.86859614954054, -21.395972246098125], [167.86856886198368, -21.395925353153107], [167.86860056570112, -21.39588825121017], [167.86864987437076, -21.3959518077538], [167.86859614954054, -21.395972246098125]]], [[[167.59083745274958, -21.26230932968228], [167.59076938606697, -21.26226101058655], [167.59079536461616, -21.262213835844705], [167.59084070170374, -21.262254431671384], [167.59083745274958, -21.26230932968228]]], [[[167.59282375028846, -21.26479120904811], [167.59276526158095, -21.264829860240763], [167.59276450656418, -21.26473735049493], [167.5928092604833, -21.264763182254015], [167.59282375028846, -21.26479120904811]]], [[[168.02945610804528, -21.46649509330114], [168.0294642736681, -21.466580087231335], [168.02943857129804, -21.466594428216386], [168.02940982196503, -21.466501102848863], [168.02945610804528, -21.46649509330114]]], [[[168.0332498432408, -21.464850647696192], [168.03332515481998, -21.464904950960804], [168.03328598015864, -21.464942111977997], [168.03323202162093, -21.464888307504214], [168.0332498432408, -21.464850647696192]]], [[[167.8065581103741, -21.402530331630324], [167.80658758563132, -21.402473853566864], [167.80662439426675, -21.402473075793353], [167.80660996323058, -21.40255585815201], [167.8065581103741, -21.402530331630324]]], [[[167.8158926052659, -21.376659254183657], [167.81584874559135, -21.376615866323313], [167.81586688249243, -21.37657668182278], [167.81593040928027, -21.376624173540012], [167.8158926052659, -21.376659254183657]]], [[[167.82073448011468, -21.372354450233065], [167.82073077244576, -21.372317644355473], [167.82080369233063, -21.372272866249514], [167.8207815931151, -21.37236707046436], [167.82073448011468, -21.372354450233065]]], [[[167.82984769912255, -21.426967517375928], [167.82978119218876, -21.42694536536592], [167.8298012569272, -21.426888868996986], [167.82984311457056, -21.426900993388216], [167.82984769912255, -21.426967517375928]]], [[[167.81629025252943, -21.37629534363009], [167.816230804996, -21.376227618518634], [167.8162499650221, -21.376186959465564], [167.8163160948034, -21.37631601030905], [167.81629025252943, -21.37629534363009]]], [[[167.81763295663933, -21.375379323349023], [167.81764781784491, -21.3753202561748], [167.81772287485168, -21.37538372778288], [167.81769925835235, -21.375402521074776], [167.81763295663933, -21.375379323349023]]], [[[167.87788053935327, -21.548977009780007], [167.8779394317386, -21.54896897693522], [167.87798367038693, -21.549023617436543], [167.87788726845298, -21.549016796979895], [167.87788053935327, -21.548977009780007]]], [[[167.87850259539348, -21.550461255725036], [167.878435398354, -21.550431687230652], [167.87848948941595, -21.55036027814515], [167.8785026939438, -21.550383236222043], [167.87850259539348, -21.550461255725036]]], [[[167.822447341914, -21.373065896898087], [167.82244652580226, -21.3730189242544], [167.82249262060122, -21.373010146494234], [167.82250615725053, -21.373067205780302], [167.822447341914, -21.373065896898087]]], [[[167.55662248137227, -21.142164036801763], [167.5565840806698, -21.142185623335028], [167.5565331296652, -21.14218231443034], [167.55658565183978, -21.1421186552822], [167.55662248137227, -21.142164036801763]]], [[[167.5516569470376, -21.13671612897545], [167.5516337704441, -21.13676786059242], [167.55159760855423, -21.136776209705804], [167.5516095838031, -21.13670683235777], [167.5516569470376, -21.13671612897545]]], [[[167.58833487911042, -21.26023278224819], [167.58829072326245, -21.260243256645555], [167.58825048661848, -21.260203686495426], [167.5883064083064, -21.260188755127082], [167.58833487911042, -21.26023278224819]]], [[[167.81828402662208, -21.375160954294465], [167.81831656276705, -21.37513819753847], [167.81836064819794, -21.37515469957571], [167.81830779653842, -21.375200341914532], [167.81828402662208, -21.375160954294465]]], [[[167.8175871121455, -21.375469720773868], [167.8175665519657, -21.3754325112245], [167.81759694837137, -21.37540828744105], [167.81763237850208, -21.37546948070662], [167.8175871121455, -21.375469720773868]]], [[[167.95409448499058, -21.38577973261846], [167.95405940088625, -21.385785807235475], [167.95402606234236, -21.38577669456552], [167.95407984272072, -21.38573193744062], [167.95409448499058, -21.38577973261846]]], [[[167.87544762330344, -21.567033733276176], [167.87543958801567, -21.567081852023456], [167.8753914590312, -21.56707961901189], [167.875393040362, -21.56702296422709], [167.87544762330344, -21.567033733276176]]], [[[167.85828285363556, -21.389461406159757], [167.8582515597253, -21.389509612410414], [167.8582241162694, -21.389464517138894], [167.8582558615834, -21.38944199625847], [167.85828285363556, -21.389461406159757]]], [[[168.01653982572216, -21.65841211913183], [168.01657264250085, -21.658447241116146], [168.0165715493973, -21.658470261336376], [168.01651442326778, -21.65845843050934], [168.01653982572216, -21.65841211913183]]], [[[167.55717732358085, -21.134315208043954], [167.55714643277918, -21.13434203600792], [167.55711878334736, -21.13432865441817], [167.55714171093283, -21.13428724014991], [167.55717732358085, -21.134315208043954]]], [[[168.01683261642202, -21.658566475734897], [168.01682086438547, -21.658581738710073], [168.01676978693342, -21.658601396300377], [168.01679842540082, -21.65853400801031], [168.01683261642202, -21.658566475734897]]], [[[168.016290865968, -21.6585182328687], [168.0163250841646, -21.6585526785939], [168.01629441090608, -21.65857275844433], [168.0162566487045, -21.658536377219548], [168.016290865968, -21.6585182328687]]], [[[167.80289253739812, -21.38107709977396], [167.80290761277067, -21.381042728352234], [167.802929917293, -21.381026814876545], [167.80293552872504, -21.381076806989213], [167.80289253739812, -21.38107709977396]]], [[[167.55464530050654, -21.1402900245178], [167.55467300963036, -21.140298961681523], [167.55468680364658, -21.14035130627881], [167.5546387016508, -21.14033421280071], [167.55464530050654, -21.1402900245178]]], [[[167.5565129829449, -21.141838133563716], [167.55647332729333, -21.141875738457415], [167.5564509033789, -21.141869480217924], [167.55648106543936, -21.141815559892667], [167.5565129829449, -21.141838133563716]]], [[[167.8020182389289, -21.381424960218656], [167.80197464147608, -21.381414410488084], [167.801997640737, -21.38137813793415], [167.80203355384694, -21.38139671077393], [167.8020182389289, -21.381424960218656]]], [[[167.82182523348874, -21.373172261980653], [167.82182375724378, -21.373131899795155], [167.82185346718313, -21.3731277815316], [167.82186385110677, -21.373184152629467], [167.82182523348874, -21.373172261980653]]], [[[167.8781017155021, -21.552924610121188], [167.87803263710975, -21.55298170752744], [167.8780146260916, -21.55296644539219], [167.87801856157816, -21.552945074153598], [167.8781017155021, -21.552924610121188]]], [[[167.80132006037996, -21.38529223801754], [167.80128503865748, -21.38530463911945], [167.8012690145112, -21.385262744659585], [167.80130239454522, -21.38524782296258], [167.80132006037996, -21.38529223801754]]], [[[167.55458201156299, -21.140233598056366], [167.5546374595452, -21.140239747153366], [167.55464209271452, -21.140275348553814], [167.55462336311456, -21.140276950535366], [167.55458201156299, -21.140233598056366]]], [[[167.55158665548635, -21.13664916174934], [167.55153946344106, -21.136646033126954], [167.55154771383908, -21.136606806833075], [167.55157715443468, -21.136620226865414], [167.55158665548635, -21.13664916174934]]], [[[168.01730685165026, -21.65851736980136], [168.01734711769632, -21.658501320179504], [168.0173143119816, -21.658572706259484], [168.0172905666435, -21.658532552000633], [168.01730685165026, -21.65851736980136]]], [[[167.87657362097008, -21.54518929515578], [167.87654962753535, -21.54520810947503], [167.87648267827404, -21.545150977593064], [167.876531034753, -21.545158708787618], [167.87657362097008, -21.54518929515578]]], [[[167.87862311652705, -21.55069494053824], [167.87859447248582, -21.550734366622315], [167.87856942276298, -21.55070182217046], [167.87860686625316, -21.55067391365321], [167.87862311652705, -21.55069494053824]]], [[[167.87573011016994, -21.562105035526884], [167.87570118299234, -21.56210907279836], [167.87566670004395, -21.562063165587666], [167.87569809797566, -21.56206128658152], [167.87573011016994, -21.562105035526884]]], [[[167.8101838531153, -21.379878778124855], [167.8101354200381, -21.37986715382566], [167.8101373550678, -21.379842689096353], [167.81020134060304, -21.379863358536774], [167.8101838531153, -21.379878778124855]]], [[[167.55207879088073, -21.13688837259526], [167.5520710226001, -21.136929473310975], [167.5520317792264, -21.136899568932378], [167.55205248754666, -21.136865718695347], [167.55207879088073, -21.13688837259526]]], [[[167.80929796907662, -21.379621978163332], [167.80931266393108, -21.379599091417408], [167.8093452742742, -21.37962272996936], [167.80931363149443, -21.379646170810773], [167.80929796907662, -21.379621978163332]]], [[[167.8757924402584, -21.562065719686007], [167.87576249393672, -21.56208365217071], [167.87573161797536, -21.562049438387042], [167.87575240355028, -21.56203552003689], [167.8757924402584, -21.562065719686007]]], [[[167.8114462253909, -21.378625414975577], [167.81146778550175, -21.378607900517864], [167.81149967208518, -21.378639287931048], [167.8114660428143, -21.378650230782196], [167.8114462253909, -21.378625414975577]]], [[[167.81648107607995, -21.37607183665796], [167.81644956346852, -21.376069858119408], [167.81644345217583, -21.37604134368103], [167.8164969641629, -21.376048078118178], [167.81648107607995, -21.37607183665796]]], [[[167.87616016657418, -21.56664687214721], [167.87613485884302, -21.566652341228327], [167.87610097071598, -21.566619019476864], [167.87614418374696, -21.566618200114007], [167.87616016657418, -21.56664687214721]]], [[[167.55292892924044, -21.137878148542733], [167.55289238804437, -21.137861606237504], [167.55289422746372, -21.137832547666974], [167.55294045719876, -21.13785750885618], [167.55292892924044, -21.137878148542733]]], [[[167.55635152919785, -21.141610191787994], [167.55638137286977, -21.141624257603045], [167.55638669482974, -21.141633990745376], [167.55634038932416, -21.14164923755477], [167.55635152919785, -21.141610191787994]]], [[[167.55748161071517, -21.134713415790173], [167.55744446855059, -21.134724575606654], [167.55743406765677, -21.134696227576676], [167.55748314802963, -21.134692263951322], [167.55748161071517, -21.134713415790173]]], [[[167.55204664266427, -21.137041259230703], [167.55208242274904, -21.13704595737746], [167.55209827057513, -21.137074137563403], [167.55207167751485, -21.13708324675499], [167.55204664266427, -21.137041259230703]]], [[[167.87786403380255, -21.54896916490236], [167.87784005434244, -21.548978575835807], [167.87780684878024, -21.54893495808234], [167.87786259416856, -21.54894126897377], [167.87786403380255, -21.54896916490236]]], [[[167.80343460043076, -21.381010305626248], [167.8034019770798, -21.38100826435237], [167.8033919865891, -21.38098721664598], [167.80343107349566, -21.380981573126217], [167.80343460043076, -21.381010305626248]]], [[[168.01720751305226, -21.65813910107442], [168.01725060353368, -21.65812676609476], [168.01726618715745, -21.6581482753554], [168.0172156473778, -21.658155768187246], [168.01720751305226, -21.65813910107442]]], [[[167.87652674443396, -21.564251642655808], [167.87649670345203, -21.564246424683102], [167.87651139515026, -21.56420911590893], [167.87652043237577, -21.56421954693447], [167.87652674443396, -21.564251642655808]]], [[[167.551853251668, -21.13673204177182], [167.55186754304566, -21.136723236886073], [167.55188786201234, -21.136767237576397], [167.55186199774516, -21.136760595248788], [167.551853251668, -21.13673204177182]]], [[[168.01747269737396, -21.65797083288144], [168.01747455121932, -21.65799102636055], [168.01743719240866, -21.657997872450167], [168.01743841893622, -21.657971228379548], [168.01747269737396, -21.65797083288144]]], [[[167.81571910643427, -21.37618717141687], [167.81570533720569, -21.376149273505707], [167.81571813422707, -21.37614221487077], [167.81574318530446, -21.37617452496923], [167.81571910643427, -21.37618717141687]]], [[[167.55031809551403, -21.13572324363346], [167.55035090120725, -21.13575081453918], [167.55034735619031, -21.13576065747363], [167.55030864947048, -21.135742292006046], [167.55031809551403, -21.13572324363346]]], [[[167.8157908030251, -21.376185009294627], [167.81580353946373, -21.37616295624901], [167.81582108948922, -21.37617443615808], [167.81580947285647, -21.376205130798866], [167.8157908030251, -21.376185009294627]]], [[[167.55020823079582, -21.135661494819377], [167.55022476354432, -21.135672542045153], [167.5502155342827, -21.135699347830002], [167.55019622822348, -21.13567642077747], [167.55020823079582, -21.135661494819377]]], [[[167.87664548186655, -21.566604477770767], [167.8766228658485, -21.566618778093023], [167.87661294438325, -21.56660793245247], [167.8766284345803, -21.566582411842468], [167.87664548186655, -21.566604477770767]]], [[[167.8736886087608, -21.570382258141507], [167.87366200573248, -21.570370352805693], [167.8736568606593, -21.570356951298173], [167.8736867153542, -21.570357339215423], [167.8736886087608, -21.570382258141507]]], [[[167.5465192094217, -21.133787868305458], [167.546518252925, -21.133797596799145], [167.5464786229025, -21.133791099481115], [167.54648713160486, -21.13378082213597], [167.5465192094217, -21.133787868305458]]], [[[167.87842014110205, -21.552089864618093], [167.8784042295515, -21.552102734911813], [167.87838039398483, -21.5520978269256], [167.87841029219564, -21.552080842930792], [167.87842014110205, -21.552089864618093]]], [[[167.54778393537194, -21.134660004281272], [167.547750473286, -21.134662311437882], [167.54774326094602, -21.134654926127023], [167.54777289495925, -21.134648427041242], [167.54778393537194, -21.134660004281272]]], [[[167.55019012258202, -21.13569359531169], [167.55019359429568, -21.13571143048708], [167.55017183291932, -21.135711262593198], [167.55016899379973, -21.135696799912058], [167.55019012258202, -21.13569359531169]]], [[[167.55199061796333, -21.136827633314958], [167.55196361438303, -21.136836159161795], [167.5519592768721, -21.136832974745392], [167.55198127076895, -21.136818705343117], [167.55199061796333, -21.136827633314958]]], [[[167.55204219223685, -21.1367963139012], [167.55203420565522, -21.136807688706863], [167.55202148649576, -21.136804022313143], [167.55203760562085, -21.13678869655364], [167.55204219223685, -21.1367963139012]]]]}, \"bbox\": [167.54359135415075, -21.660920757978886, 168.13339384966935, -21.12952678538245]}], \"bbox\": [167.54359135415075, -21.660920757978886, 168.13339384966935, -21.12952678538245]}", "shape_id": 18, "type": "communes"};
    var mapping = {"fields": {"elevation": {"data_source": {"name": "elevation", "type": "layer"}, "description": "Altitude metrics within the shape", "field_type": "JSON", "label": "Altitude", "transformations": [{"chart_options": {"title": "Median Altitude"}, "chart_type": "text", "name": "median"}, {"chart_options": {"title": "Maximum Altitude"}, "chart_type": "text", "name": "max"}, {"chart_options": {"title": "Elevation Distribution", "x_label": "Elevation (m)", "y_label": "Area (ha)"}, "chart_type": "stacked_bar", "data_structure": {"x_field": "altitudes", "y_fields": [{"color": "#4BC0C0", "label": "For\u00eat", "name": "forest"}, {"color": "#FF6384", "label": "Hors-for\u00eat", "name": "non_forest"}]}, "name": "elevation_distribution"}]}, "forest": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "TEXT", "label": "Forest Area", "transformations": [{"chart_options": {"title": "Forest Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "forest_coordinates", "title": "Forest Location"}, "chart_type": "map", "name": "coordinates"}]}, "forest_cover": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "JSON", "label": "Forest Area", "transformations": [{"chart_options": {"categories": ["UM", "Non-UM", "Commune"], "title": "Forest Cover"}, "chart_type": "donut", "layer_params": {"forest_cover": [{"name": "area"}, {"attribute": "cover_type"}], "soil_types": [{"attribute": "soil_category"}]}, "name": "percentage"}]}, "forest_fragmentation": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Analysis of forest fragmentation", "field_type": "JSON", "label": "Forest Fragmentation", "transformations": [{"chart_options": {"bins": [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 7000, 12000, 17000, 27000, 500000], "title": "Forest Fragment Distribution", "x_label": "Area (ha)", "y_label": "Cumulative Area (%)"}, "chart_type": "line", "data_structure": {"color": "#4BC0C0", "x_field": "keys", "y_field": "values"}, "name": "fragment_size_distribution"}, {"chart_options": {"label": "Effective Mesh Size (km\u00b2)", "max": 1000, "min": 0, "title": "Fragmentation"}, "chart_type": "gauge", "name": "effective_mesh_size"}]}, "forest_humidity": {"data_source": [{"name": "forest_cover", "type": "layer"}, {"name": "holdridge", "type": "shape"}], "description": "Distribution of forests by humidity level", "field_type": "JSON", "label": "Forest and Living Environments", "transformations": [{"chart_options": {"categories": ["Dry", "Humid", "Very Humid"], "title": "Forest and Living Environments", "x_label": "Category", "y_label": "Frequency (%)"}, "chart_type": "stacked_bar", "layer_params": {"forest_cover": [{"name": "area"}], "humidity": [{"name": "value"}]}, "name": "category_distribution"}]}, "land_use": {"data_source": [{"name": "ultramafic", "type": "shape"}, {"name": "holdridge", "type": "shape"}, {"name": "forest_cover", "type": "layer"}], "description": "Land use distribution", "field_type": "JSON", "label": "Land Use", "transformations": [{"chart_options": {"title": "Land Use", "x_label": "Category", "y_label": "Area (ha)"}, "chart_type": "bar", "name": "category_distribution"}]}, "num_families": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of families in the zone", "field_type": "INTEGER", "label": "Number of Families", "transformations": [{"chart_options": {"title": "Number of Families"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["family"]}]}, "num_occurrences": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of occurrences in the zone", "field_type": "INTEGER", "label": "Number of Occurrences", "source_field": "id_occurrence", "transformations": [{"chart_options": {"title": "Number of Occurrences"}, "chart_type": "text", "name": "count"}]}, "num_species": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of species in the zone", "field_type": "INTEGER", "label": "Number of Species", "transformations": [{"chart_options": {"title": "Number of Species"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["species", "infra"]}]}, "rainfall": {"data_source": {"name": "rainfall", "type": "layer"}, "description": "Average annual rainfall within the shape", "field_type": "TEXT", "label": "Average Rainfall", "transformations": [{"chart_options": {"title": "Average Rainfall"}, "chart_type": "text", "name": "mean"}, {"chart_options": {"title": "Rainfall Range"}, "chart_type": "text", "name": "range"}]}, "shape": {"data_source": {"name": "self", "type": "shape"}, "description": "Total area of the reference zone", "field_type": "TEXT", "label": "Shape Area", "transformations": [{"chart_options": {"title": "Total Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "shape_coordinates", "title": "Location"}, "chart_type": "map", "name": "coordinates"}]}}, "group_by": "shape", "source_location_field": "geo_pt", "source_table_name": "occurrences"};
    var currentShapeType = "communes";

    document.addEventListener('DOMContentLoaded', function () {
        loadShapeCharts(shape, mapping);
        loadShapeTypeList();
        initShapeMaps(mapping, shape);
        loadAllShapesMap(shape);
    });

    function loadShapeCharts(shape, mapping) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            if (field.field_type !== 'TEXT' && shape[field_key] !== null) {
                // Handle bins chart if present
                if (field.bins && field.bins.values && field.bins.values.length > 0) {
                    var binChartId = field_key + 'BinChart';
                    var binCtx = document.getElementById(binChartId);
                    if (binCtx) {
                        createBinChart(binCtx, field, shape);
                    }
                }

                // Handle transformations
                field.transformations.forEach(function(transformation) {
                    var transformationName = transformation.name ? transformation.name : '';
                    var valueKey = field_key + '_' + transformationName;

                    if (shape[valueKey] !== null) {
                        switch(transformation.chart_type) {
                            case 'pie':
                                var pieChartId = field_key + 'PieChart';
                                var pieCtx = document.getElementById(pieChartId);
                                if (pieCtx) {
                                    createPieChart(pieCtx, transformation, shape[valueKey]);
                                }
                                break;
                            case 'gauge':
                                var gaugeId = field_key + transformationName + 'Gauge';
                                var gaugeElement = document.getElementById(gaugeId);
                                if (gaugeElement) {
                                    createGauge({
                                        id: gaugeId,
                                        value: parseFloat(shape[valueKey]),
                                        min: 0,
                                        max: transformation.chart_options.max,
                                        title: transformation.chart_options.title,
                                        label: transformation.chart_options.label
                                    });
                                }
                                break;
                            case 'bar':
                                var barChartId = field_key + transformationName + 'BarChart';
                                var barCtx = document.getElementById(barChartId);
                                if (barCtx) {
                                    createBarChart(barCtx, field, transformation, shape[valueKey]);
                                }
                                break;
                            case 'stacked_bar':
                                if (field_key === 'elevation' && transformationName === 'elevation_distribution') {
                                    var stackedBarChartId = 'elevationDistributionChart';
                                    var stackedBarCtx = document.getElementById(stackedBarChartId);
                                    if (stackedBarCtx) {
                                        createElevationDistributionChart(stackedBarCtx, shape.elevation_elevation_distribution, transformation);
                                    }
                                }
                                break;
                            case 'line':
                                if (field_key === 'forest_fragmentation' && transformationName === 'fragment_size_distribution') {
                                    var lineChartId = 'forestFragmentationChart';
                                    var lineCtx = document.getElementById(lineChartId);
                                    if (lineCtx) {
                                        createForestFragmentationChart(lineCtx, shape.forest_fragmentation_fragment_size_distribution, transformation);
                                    }
                                }
                                break;
                        }
                    }
                });
            }
        });
    }

    function createBinChart(ctx, field, shape) {
        var binData = {
            labels: field.bins.values,
            datasets: [{
                label: field.label,
                data: field.bins.values.map(value => shape.frequencies[field.field_key][value] || 0),
                backgroundColor: field.bins.chart_options.color
            }]
        };

        new Chart(ctx, {
            type: field.bins.chart_type,
            data: binData,
            options: field.bins.chart_options
        });
    }

    function createPieChart(ctx, transformation, data) {
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['True', 'False'],
                datasets: [{
                    data: [data.true || 0, data.false || 0],
                    backgroundColor: ['#FF6384', '#36A2EB']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: transformation.chart_options.title
                }
            }
        });
    }

    function createBarChart(ctx, field, transformation, data) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: field.label,
                    data: Object.values(data),
                    backgroundColor: getColor(0).background,
                    borderColor: getColor(0).border,
                    borderWidth: 1
                }]
            },
            options: transformation.chart_options
        });
    }

    function createElevationDistributionChart(ctx, elevationData, chartConfig) {
        const altitudes = elevationData.altitudes.reverse();
        const forestData = elevationData.forest.reverse();
        const nonForestData = elevationData.non_forest.reverse();

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: altitudes,
                datasets: [
                    {
                        label: 'Forest',
                        data: forestData,
                        backgroundColor: '#4CAF50',
                        stack: 'Stack 0',
                    },
                    {
                        label: 'Non-Forest',
                        data: nonForestData,
                        backgroundColor: '#FFF59D',
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Area (ha)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString(); // Format les grands nombres
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Elevation (m)'
                        },
                        reverse: false
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                layout: {
                    padding: {
                        left: 10,
                        right: 10,
                        top: 0,
                        bottom: 10
                    }
                }
            }
        });
    }

    function createForestFragmentationChart(ctx, fragmentationData, chartConfig) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(fragmentationData),
                datasets: [{
                    label: 'Cumulative Area (%)',
                    data: Object.values(fragmentationData),
                    borderColor: '#4BC0C0',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.x_label
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.y_label
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: chartConfig.chart_options.title
                    }
                }
            }
        });
    }

    function createGauge(options) {
        new JustGage({
            id: options.id,
            value: options.value || 0,
            min: options.min || 0,
            max: options.max,
            title: options.title,
            label: options.label,
            pointer: true,
            pointerOptions: {
                toplength: 10,
                bottomlength: 10,
                bottomwidth: 2,
                color: '#8e8e93',
                stroke: '#ffffff',
                stroke_width: 3,
                stroke_linecap: 'round'
            },
            gaugeWidthScale: 0.6,
            counter: true,
            donut: true,
            relativeGaugeSize: true,
            donutStartAngle: 270,
            hideInnerShadow: true,
            customSectors: [{
                color: "#ff0000",
                lo: 0,
                hi: options.max * 0.33
            }, {
                color: "#ffff00",
                lo: options.max * 0.33,
                hi: options.max * 0.66
            }, {
                color: "#00ff00",
                lo: options.max * 0.66,
                hi: options.max
            }],
            humanFriendly: true,
            formatNumber: true,
            textRenderer: function (val) {
                return parseFloat(val).toFixed(2);
            }
        });
    }

    // Function to get a color based on the index
    function getColor(index) {
        var colors = [
            {background: 'rgba(54, 162, 235, 0.6)', border: 'rgba(54, 162, 235, 1)'},
            {background: 'rgba(75, 192, 192, 0.6)', border: 'rgba(75, 192, 192, 1)'},
            {background: 'rgba(255, 99, 132, 0.6)', border: 'rgba(255, 99, 132, 1)'}
        ];
        return colors[index % colors.length];
    }

// Rest of the code (loadShapeTypeList, initShapeMaps, loadAllShapesMap) remains the same...

    let maps = {};  // Object to keep track of initialized maps

    function initMap(field_key, geometry) {
        const mapId = field_key + 'Map';
        const mapLoaderId = field_key + 'MapLoader';

        // Check if the map already exists
        if (maps[mapId]) {
            return; // Map is already initialized, so do nothing
        }

        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        map.on('load', function () {
            document.getElementById(mapLoaderId).style.display = 'none';
        });

        if (geometry) {
            const geoJsonLayer = L.geoJSON(geometry, {
                style: function() {
                    return {
                        color: '#228b22', // Border color
                        weight: 2,       // Border width
                        fillColor: '#228b22cc', // Fill color with opacity
                        fillOpacity: 0.8 // Fill opacity
                    };
                }
            }).addTo(map);
            map.fitBounds(geoJsonLayer.getBounds());
        } else {
            console.warn("No geographic coordinates found.");
            // Set default view if no geometry is found
            map.setView([-21.291237, 165.516418], 10);
        }

        // Store the map instance in the maps object
        maps[mapId] = map;
    }

    function initShapeMaps(mapping, shape) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            field.transformations.forEach(function(transformation) {
                if (transformation.chart_type === 'map') {
                    var coordinatesField = transformation.chart_options.coordinates_field;
                    var geometry = shape[coordinatesField];

                    // Check if geometry is a string, if so, parse it as JSON
                    if (typeof geometry === 'string') {
                        try {
                            geometry = JSON.parse(geometry);
                        } catch (e) {
                            console.error("Invalid JSON for field", coordinatesField, ":", geometry);
                            return; // Skip this field if JSON is invalid
                        }
                    }

                    // Initialize the map with the parsed geometry
                    initMap(field_key, geometry);
                }
            });
        });
    }

    function loadAllShapesMap(currentShape) {
        const mapId = 'allShapesMap';
        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        var group = L.featureGroup(); // Create a group to hold all the layers

        shapeTypes.forEach(function(shapeTypeItem) {
            if (shapeTypeItem.type === currentShape.type) {
                shapeTypeItem.shapes.forEach(function(shapeItem) {
                    var geometry = shapeItem.geometry;
                    // No need to parse geometry if it's already GeoJSON
                    var layer = L.geoJSON(geometry, {
                        style: function() {
                            return {
                                color: '#228b22', // Border color
                                weight: 2,       // Border width
                                fillColor: '#228b22cc', // Fill color with opacity
                                fillOpacity: 0.8 // Fill opacity
                            };
                        }
                    }).addTo(map);
                    group.addLayer(layer); // Add each layer to the group

                    // Highlight current shape
                    if (shapeItem.id === currentShape.id) {
                        layer.setStyle({color: 'red', weight: 3, fillOpacity: 0.4});
                        layer.bringToFront(); // Ensure the highlighted shape is on top
                    } else {
                        layer.setStyle({fillOpacity: 0.2}); // Reduce opacity for other shapes
                    }

                    // Show tooltip on hover with additional content
                    var tooltipContent = "<strong>" + shapeItem.name + "</strong><br>";

                    


                    layer.bindTooltip(tooltipContent, {
                        permanent: false,
                        direction: 'right',
                        offset: L.point(10, 0),
                        opacity: 0.9,
                        className: 'custom-tooltip'
                    });


                    layer.on('mousemove', function(e) {
                        var tooltip = e.target.getTooltip();
                        tooltip.setLatLng(e.latlng);
                    });

                    layer.on('click', function() {
                        window.location.href = '../shape/' + shapeItem.id + '.html';
                    });
                });
            }
        });

        map.fitBounds(group.getBounds()); // Adjust the view to fit the bounds of the group

        map.attributionControl.setPrefix(false);
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        maps['allShapesMap'] = map;
    }

    function loadShapeTypeList() {
            var shapeTypeListElement = document.getElementById("shape-type-list");
            shapeTypes.forEach(function (shapeTypeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "javascript:void(0)";
                a.textContent = shapeTypeItem.type;
                a.className = "shape-type-link";
                if (shapeTypeItem.type === currentShapeType) {
                    a.classList.add("active");
                }
                a.onclick = function () {
                    if (shapeTypeItem.shapes.length > 0) {
                        // Redirect to the first shape of the selected type
                        window.location.href = "../shape/" + shapeTypeItem.shapes[0].id + ".html";
                    }
                    loadShapeList(shapeTypeItem.shapes);
                };
                li.appendChild(a);
                shapeTypeListElement.appendChild(li);
            });
        }

        function loadShapeList(shapes) {
            var shapeListElement = document.getElementById("shape-list");
            shapeListElement.innerHTML = ''; // Clear the previous list
            shapes.forEach(function (shapeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "../shape/" + shapeItem.id + ".html";
                a.textContent = shapeItem.name;
                a.className = "shape-link";
                if (shapeItem.id === shape.id) {
                    a.classList.add("active");
                }
                li.appendChild(a);
                shapeListElement.appendChild(li);
            });
        }

</script>

</body>
</html>