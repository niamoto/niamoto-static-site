<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Niamoto - NOUMEA</title>
    <link rel="stylesheet" href="../js/vendor/tailwindcss/2.2.19_dist_tailwind.css">
    <link rel="stylesheet" href="../js/vendor/leaflet/1.9.4_leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
<script src="../js/shape_list.js"></script>

<style>
    #shape-type-list li, #shape-list li {
        list-style: none;
        text-transform: capitalize;
    }

    .shape-type-link, .shape-link {
        display: block;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
    }

    .shape-type-link:hover, .shape-link:hover {
        background-color: #f0f0f0;
    }

    .shape-type-link.active, .shape-link.active {
        background-color: #3498db;
        color: #fff;
    }

    #shapeMap, #allShapesMap {
        position: relative;
        height: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #allShapesMap {
        height: 400px;
    }

    .chart-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .chart-container > div {
        flex: 1 1 calc(33.333% - 10px);
        margin: 5px;
    }
    .custom-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    padding: 5px;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    font-size: 12px;
    max-width: 300px;
    word-wrap: break-word;
}
</style>

    <style>
        .gauge {
            height: 349px;
        }

        ul {
            list-style-type: none;
        }

        .loader-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bg p-4 fixed w-full top-0 shadow-md z-50 custom-nav">
    <div class="container mx-auto flex flex-wrap items-center justify-between">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <a id="home-link" class="inline-flex items-center py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                <span class="site-title">Niamoto</span>
            </a>
        </div>

        <div class="block lg:hidden">
            <button id="nav-toggle"
                class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
                <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0zm0 6h20v2H0zm0 6h20v2H0z" />
                </svg>
            </button>
        </div>
        <div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block pt-6 lg:pt-0" id="nav-content">
            <ul class="list-reset lg:flex justify-end flex-1 items-center">
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                        <i class="fas fa-home menu-icon"></i>Accueil
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#introduction">Introduction</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#project">Projet</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#objective">Objectifs</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#context">Contexte</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#flora">Flore</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="methodology.html">
                        <i class="fas fa-flask menu-icon"></i>Méthodologie
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#methodes">Nos méthodes</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#faq">FAQ</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="trees.html">
                        <i class="fas fa-leaf menu-icon"></i>Arbres
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#learnTaxon">Étudier les
                arbres</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#taxon">Les arbres de
                Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="plots.html">
                        <i class="fas fa-map-marked-alt menu-icon"></i>Peuplements
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#learnPlot">Étudier les
                            peuplements forestiers</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#plot">Les
                peuplements forestiers de Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="forests.html">
                        <i class="fas fa-tree menu-icon"></i>Forêt
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#learnForest">Étudier les
                forêts</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPN">La forêt de la
                province Nord</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPS">La forêt de la
                province Sud</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="resources.html">
                        <i class="fas fa-book menu-icon"></i>Ressources
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#equipe">L'équipe</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#article">Articles</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#academic">Académique</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#media-production">Médias</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
  document.getElementById('nav-toggle').onclick = function () {
    document.getElementById('nav-content').classList.toggle('hidden');
  };

  // Function to adjust the navigation links based on page depth
  function adjustNavLinks(depth) {
    document.querySelectorAll('a[data-link]').forEach(link => {
      link.href = depth + link.getAttribute('data-link');
    });
  }

  // Adjust the navigation links based on the depth
  adjustNavLinks("../");
</script>

<style>
    .site-title {
        font-family: 'Arial Black', sans-serif; /* Custom font for a bold effect */
        font-size: 2rem; /* Increased font size */
        text-transform: uppercase; /* Uppercase letters for visibility */
        letter-spacing: 2px; /* Spacing between letters */
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7); /* Text shadow for better visibility */
        transition: color 0.3s; /* Smooth transition for hover effect */
    }

    .site-title:hover {
        color: #ffdd57; /* Change color on hover */
    }

    .text-contour {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .nav-bg {
        background-color: rgba(34, 139, 34, 0.8); /* Fond vert semi-transparent */
        transition: background-color 0.3s;
    }

    .nav-bg:hover {
        background-color: rgba(34, 139, 34, 1); /* Fond vert opaque au survol */
    }

    .group:hover .group-hover\:block {
        display: block;
    }

    .custom-nav {
        z-index: 500;
    }

    .custom-dropdown {
        z-index: 500;
    }

    .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.2); /* Fond blanc transparent au survol */
        border-radius: 4px;
    }

    .menu-icon {
        margin-right: 8px;
    }
</style>
    <div class="flex">
        
<aside class="w-1/4 p-4 mt-28">
    <h2 class="font-semibold text-lg mb-4">Shape Types</h2>
    <ul id="shape-type-list" class="list-disc pl-5">
        <!-- The list of shape types will be generated by JavaScript -->
    </ul>
</aside>

        <div class="w-full">
            
<div id="allShapesMap" class="mt-28"></div>

<div class="rounded overflow-hidden shadow-lg mb-2 mt-8">
    <div class="px-6 py-4">
        <div class="font-bold text-4xl mb-2">NOUMEA</div>
    </div>
</div>

<div class="chart-container">
    <!-- Section for general information -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">General Information</h2>
            
                
                    
                        
                        
                            <p>Shape Area (Total Area): 4940.431824218239</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Forest Area (Forest Area): 322.80790467596347</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Number of Families (Number of Families): 65</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Species (Number of Species): 213</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Occurrences (Number of Occurrences): 1781</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Average Rainfall (Average Rainfall): 992.1052856445312</p>
                        
                    
                
                    
                        
                        
                            <p>Average Rainfall (Rainfall Range): {"min": 880.0, "max": 1080.0}</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Altitude (Median Altitude): 13.0</p>
                        
                    
                
                    
                        
                        
                            <p>Altitude (Maximum Altitude): 151.0</p>
                        
                    
                
                    
                
            
                
                    
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        </div>
    </div>

    <!-- Section for shape map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Shape Map</h2>
            <div id="shapeMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="shapeMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Section for forest map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Forest Map</h2>
            <div id="forestMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="forestMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>
</div>

<div class="flex flex-wrap -mx-2">
    

    

    
    
        
    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
    
        
            
            

            
            
                
            
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Elevation Distribution</h2>
        
    
    
        <canvas id="elevationDistributionChart"></canvas>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Forest Fragment Distribution</h2>
        
    
    
        <canvas id="forestFragmentationChart"></canvas>
    
    
                        </div>
                    </div>
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Fragmentation</h2>
        
    
    
        <div class="gauge" id="forest_fragmentationeffective_mesh_sizeGauge"></div>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
</div>

        </div>
    </div>
    <footer class="bg-green-700 text-white p-4 mt-8">
        <div class="container mx-auto">
            <div class="flex justify-center mb-4">
                <div class="bg-white p-2 rounded-lg shadow-md flex justify-center">
                    <figure class="mx-2"><img class="img-fluid" src="../files/ps_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/pn_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/amap_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/herbarium_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/iac_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/ird_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/cirad_100.png"></figure>
                </div>
            </div>
            <div class="text-center">
                <p>Niamoto - Portail de la forêt de Nouvelle-Calédonie</p>
                <a class="inline-block py-2 px-4 text-white no-underline" href="https://github.com/niamoto/niamoto" target="_blank">
                    <span class="fab fa-github fa-lg" aria-hidden="true"></span> Github
                </a>
            </div>
        </div>
    </footer>
    <script src="../js/vendor/chart/4.4.2_chart.js"></script>
    <script src="../js/vendor/d3/7.8.5_d3.js"></script>
    <script src="../js/vendor/jquery/3.6.0_jquery.js"></script>
    <script src="../js/vendor/raphael/2.3.0_raphael.js"></script>
    <script src="../js/vendor/justgage/1.6.1_justgage.js"></script>
    <script src="../js/vendor/leaflet/1.9.4_leaflet.js"></script>
    
<script>
    var shape = {"elevation_elevation_distribution": {"altitudes": [-10.0, 90.0], "forest": [295.60074505445266, 25.559462918242147], "non_forest": [4259.540059374876, 73.3445457653905]}, "elevation_max": 151.0, "elevation_median": 13.0, "forest_area": "322.80790467596347", "forest_coordinates": "{\"type\": \"MultiPolygon\", \"coordinates\": [[[[166.42715520731744, -22.290595654734044], [166.42763455341907, -22.29072815979038], [166.42730525006215, -22.292078148643437], [166.42658749300685, -22.29076929069391], [166.42715520731744, -22.290595654734044]]], [[[166.42552148002196, -22.2882963779984], [166.4257496931992, -22.288956244209146], [166.42571879467505, -22.289369104343766], [166.4247801943782, -22.28813596368844], [166.42552148002196, -22.2882963779984]]], [[[166.42508552118147, -22.27801598089638], [166.42580965000008, -22.27763844006228], [166.42509005086654, -22.27885068820641], [166.4247523014635, -22.278486596432103], [166.42508552118147, -22.27801598089638]]], [[[166.41561703123165, -22.27026818036061], [166.41579024158412, -22.270254766856002], [166.41619194056344, -22.271579521447606], [166.4153765912071, -22.271147543150608], [166.41561703123165, -22.27026818036061]]], [[[166.41706997637573, -22.270340890340023], [166.4164450552083, -22.27157951407388], [166.416065987276, -22.269433739045695], [166.4165717938138, -22.268202967344557], [166.41706997637573, -22.270340890340023]]], [[[166.4068236350376, -22.265585600062625], [166.4100996500936, -22.26680431569695], [166.407922863793, -22.268809192696914], [166.4039442299945, -22.26786544543455], [166.4042019190206, -22.270565653524823], [166.40098889532166, -22.2696885161921], [166.4027358682927, -22.266389808571375], [166.4068236350376, -22.265585600062625]]], [[[166.40125986190142, -22.26471391771443], [166.40252203922623, -22.265089717496732], [166.40088977382615, -22.2672232814402], [166.40047991279857, -22.264631054042756], [166.40125986190142, -22.26471391771443]]], [[[166.4054309936022, -22.26516984775163], [166.40776477234863, -22.263898764609326], [166.40843378606905, -22.264828292088968], [166.40767112164403, -22.265391420358185], [166.4054309936022, -22.26516984775163]]], [[[166.40658832369388, -22.262686677360968], [166.4076152442338, -22.26311780884787], [166.40738153558635, -22.26407379277416], [166.4054583844358, -22.26323432693127], [166.40658832369388, -22.262686677360968]]], [[[166.39513328809917, -22.259562232361628], [166.39562277720506, -22.259834064034344], [166.39610245009771, -22.25908216371337], [166.3966661167345, -22.25924421309909], [166.39545588840795, -22.261010343054995], [166.39513328809917, -22.259562232361628]]], [[[166.39617605690427, -22.253503167358936], [166.396795070726, -22.25311084286849], [166.39820289099094, -22.255652304555802], [166.3963819186183, -22.254666680079747], [166.39617605690427, -22.253503167358936]]], [[[166.39522706643123, -22.25455353476415], [166.39309635797355, -22.256766223649148], [166.39113309151855, -22.253638449951236], [166.39012699998102, -22.255955512888868], [166.38835533169765, -22.255349549249203], [166.38607013651233, -22.25249904928971], [166.38762778977036, -22.250883729223936], [166.38716403982366, -22.248929727927845], [166.3895429434683, -22.252820855543362], [166.39181171527292, -22.252159833681205], [166.39171193758258, -22.25052515828197], [166.39522706643123, -22.25455353476415]]], [[[166.41031882708776, -22.238446952226717], [166.41103484715484, -22.238951804927385], [166.4110492752273, -22.23992468485334], [166.40987162954715, -22.238602422934232], [166.41031882708776, -22.238446952226717]]], [[[166.4306210209477, -22.236843107590804], [166.43104925054504, -22.23704301518042], [166.43232297005352, -22.23867960115229], [166.43112342728298, -22.23794690225523], [166.4306210209477, -22.236843107590804]]], [[[166.41186057327548, -22.236433886350916], [166.41246927265556, -22.236577958029716], [166.41307672735866, -22.236898337915385], [166.41165203259578, -22.237052216142438], [166.41186057327548, -22.236433886350916]]], [[[166.42161776365452, -22.23648240434788], [166.42383231727706, -22.235976107730067], [166.42428778641448, -22.23623170122577], [166.42372884944155, -22.2375369375623], [166.42161776365452, -22.23648240434788]]], [[[166.41293750057213, -22.235975665484435], [166.41320688773004, -22.23457570267367], [166.41439509331136, -22.235226999252355], [166.4140653949598, -22.236806897816606], [166.41293750057213, -22.235975665484435]]], [[[166.41090981872753, -22.234522291666966], [166.41204226839713, -22.234656292071747], [166.4110784258428, -22.236024322387117], [166.41004827939463, -22.234521907449025], [166.41090981872753, -22.234522291666966]]], [[[166.39982502150283, -22.23453236264377], [166.40042212540956, -22.23421285009946], [166.40071622605888, -22.234532789470844], [166.39930152478362, -22.23476556238025], [166.39982502150283, -22.23453236264377]]], [[[166.41898221543022, -22.2335352853644], [166.41840712281592, -22.232450395169593], [166.41774613214108, -22.2334418278931], [166.41826608007176, -22.231967437255886], [166.42149220780212, -22.23225221817749], [166.42079711686753, -22.235038191121884], [166.41657573691214, -22.235316827744438], [166.42003868886385, -22.2335706201397], [166.41898221543022, -22.2335352853644]]], [[[166.39417967695354, -22.229763958790553], [166.39549216455273, -22.231362447449857], [166.39676437365048, -22.23035628923482], [166.39903047591943, -22.230809983349115], [166.40191666035733, -22.229834809326807], [166.40102475812813, -22.228984880196748], [166.40242637994854, -22.227820721617796], [166.40623417593113, -22.231140220639073], [166.40524267989994, -22.233351812462935], [166.40672921239292, -22.232392525672175], [166.4068485974779, -22.233578295771803], [166.40421646073273, -22.235670303837303], [166.40133039137345, -22.235297976251385], [166.40222631553212, -22.232325221930022], [166.40101115612583, -22.23122546244967], [166.39996821704378, -22.23318006938379], [166.40012393497133, -22.23121305862825], [166.3971283650407, -22.231074495635216], [166.39741932797344, -22.233064059134353], [166.3953987441783, -22.231844197840047], [166.39417967695354, -22.229763958790553]], [[166.40367301342823, -22.23529600054235], [166.40467693663663, -22.234632073140713], [166.40433231024457, -22.23300792251742], [166.40317341709547, -22.234789601623916], [166.40367301342823, -22.23529600054235]], [[166.40422771978302, -22.231819563128354], [166.4046019373232, -22.231804333817717], [166.40534856443506, -22.230999810171706], [166.40364214644484, -22.2314395644352], [166.40422771978302, -22.231819563128354]], [[166.40229633863393, -22.231941207425955], [166.40225210443973, -22.23175304120017], [166.403459695945, -22.23096362519064], [166.4023331943693, -22.23125653120421], [166.40195066272236, -22.231776327409833], [166.40229633863393, -22.231941207425955]]], [[[166.4163585894995, -22.23180816763337], [166.41676760367687, -22.229789173632025], [166.41845798972227, -22.229153552324817], [166.41815899565577, -22.23157651476293], [166.4163585894995, -22.23180816763337]]], [[[166.4144615237585, -22.229202785264118], [166.41626612615832, -22.228453213285484], [166.41694900484345, -22.229328007912017], [166.41535018167076, -22.2316290603115], [166.4144615237585, -22.229202785264118]]], [[[166.42197977308822, -22.22607931034767], [166.42147912650773, -22.226795173000045], [166.420880525096, -22.226048893054728], [166.42098904542988, -22.225717236808993], [166.42197977308822, -22.22607931034767]]], [[[166.45477654467652, -22.310824003181693], [166.45537648652808, -22.31121899505755], [166.45647700919855, -22.311060250897082], [166.45570182063554, -22.311520016799324], [166.45421145948103, -22.311108355007566], [166.45477654467652, -22.310824003181693]]], [[[166.45316816379912, -22.30716068560923], [166.4547486194181, -22.308019718409852], [166.4550879610874, -22.310572380457927], [166.4517341918195, -22.308708489444626], [166.45214232520553, -22.30701936536841], [166.45316816379912, -22.30716068560923]], [[166.45231257895048, -22.308910648689444], [166.45245744987912, -22.30821497024278], [166.452160386595, -22.307798947503628], [166.4519768469884, -22.30872300972], [166.45231257895048, -22.308910648689444]]], [[[166.45766631762822, -22.30825822459856], [166.45743456170985, -22.30923990926268], [166.4552073120577, -22.306713241535743], [166.45613706921557, -22.306736026080856], [166.45766631762822, -22.30825822459856]]], [[[166.44799546025052, -22.306664503456048], [166.44805528547013, -22.305459576762246], [166.44977790881808, -22.30722180793939], [166.44856849816873, -22.307316380335838], [166.44799546025052, -22.306664503456048]]], [[[166.45750652956008, -22.306284273181156], [166.45799392789368, -22.30573994060799], [166.45960015812153, -22.306164250941638], [166.45877642312726, -22.30698536420392], [166.45750652956008, -22.306284273181156]]], [[[166.45086839370705, -22.306636280635743], [166.45037189465387, -22.30598567777004], [166.4509063467703, -22.30577385337354], [166.4512208072129, -22.306465242815772], [166.45086839370705, -22.306636280635743]]], [[[166.4518019363133, -22.305946776716418], [166.45340824087162, -22.305114668438936], [166.45435214437438, -22.305446831343744], [166.45383262084422, -22.306557753880107], [166.4518019363133, -22.305946776716418]]], [[[166.4480576313502, -22.297120139116004], [166.44873499213477, -22.296696874800062], [166.44852940564041, -22.297446087912828], [166.4472645369069, -22.297286471672106], [166.4480576313502, -22.297120139116004]]], [[[166.4463643691809, -22.28552519683013], [166.4467569626989, -22.285813767037364], [166.44652950330808, -22.28691816629563], [166.44617808613964, -22.28661625036864], [166.4463643691809, -22.28552519683013]]], [[[166.4532248643174, -22.2771039343406], [166.45360245265306, -22.277232676767785], [166.45413884847548, -22.27697534611212], [166.45392874485103, -22.277680165275914], [166.4532248643174, -22.2771039343406]]], [[[166.44988678124815, -22.265215124155226], [166.44987012169472, -22.26580049187418], [166.45042481437196, -22.26685351517995], [166.44981718441443, -22.266547886326997], [166.44988678124815, -22.265215124155226]]], [[[166.4493005866831, -22.263996012382567], [166.44992685083733, -22.26433392232666], [166.44873920425425, -22.264519451993724], [166.44897484795686, -22.264164407056754], [166.4493005866831, -22.263996012382567]]], [[[166.45603864557307, -22.262591839372032], [166.4564143699511, -22.2631488605589], [166.45733636942575, -22.263733406730037], [166.45555951586553, -22.262700588473486], [166.45603864557307, -22.262591839372032]]], [[[166.45313059346566, -22.25701970148665], [166.4587432722094, -22.259039759736034], [166.45838909048723, -22.256940890568366], [166.45991250055062, -22.256019806706046], [166.46037592137117, -22.25994135804773], [166.45390556076183, -22.258585251453837], [166.45313059346566, -22.25701970148665]]], [[[166.45398134890095, -22.256446342537085], [166.45496758998323, -22.256476333694316], [166.45517551122052, -22.256880689676], [166.45315877538053, -22.256817758369138], [166.45398134890095, -22.256446342537085]]], [[[166.46081432865662, -22.253257613171872], [166.46208221735702, -22.253159643210335], [166.46264078978004, -22.25357110758518], [166.46009066143546, -22.25355239112979], [166.46081432865662, -22.253257613171872]]], [[[166.45753973266275, -22.24927137456852], [166.45834792803856, -22.248989339885796], [166.45991008338933, -22.253430574664304], [166.45747604221563, -22.25203322354234], [166.45753973266275, -22.24927137456852]]], [[[166.45995063731667, -22.249475590813983], [166.46076154462637, -22.248919233714812], [166.46136238581204, -22.24943878657785], [166.46023346242012, -22.24989059217701], [166.45945757464864, -22.249663591364165], [166.45995063731667, -22.249475590813983]]], [[[166.46097191033928, -22.247477927946456], [166.4621051550083, -22.248049312206593], [166.46175216615322, -22.24869230981321], [166.46068050335936, -22.24843787826896], [166.46097191033928, -22.247477927946456]]], [[[166.4371401710251, -22.239206699612577], [166.43816064226428, -22.239284497740776], [166.43842286363224, -22.240303049713447], [166.4374571653862, -22.24074698874489], [166.4371401710251, -22.239206699612577]]], [[[166.44283986760976, -22.238996925928028], [166.44326839454686, -22.238716985083364], [166.4437426090109, -22.239059487472208], [166.44240043983243, -22.23977665294781], [166.44283986760976, -22.238996925928028]]], [[[166.45450490016367, -22.237670456039027], [166.4552471281107, -22.237808467756835], [166.45555581551005, -22.238631725186494], [166.45411995071626, -22.238310977431073], [166.45450490016367, -22.237670456039027]]], [[[166.4510112344882, -22.23464913088168], [166.45109503184875, -22.232450249163875], [166.45276585169964, -22.232148093045843], [166.4513871660666, -22.2355065255077], [166.4510112344882, -22.23464913088168]]], [[[166.44849729176414, -22.233129936183598], [166.4492122694774, -22.2324065129696], [166.44911171684336, -22.23447322456473], [166.44831134272496, -22.234190468335857], [166.44849729176414, -22.233129936183598]]], [[[166.47224022047317, -22.312766041849716], [166.473412904529, -22.31274097045918], [166.47385157454133, -22.314900917956088], [166.47253652016292, -22.31444870203857], [166.47224022047317, -22.312766041849716]]], [[[166.48355400505548, -22.30278939399473], [166.48478243708632, -22.30346104046428], [166.48475228281885, -22.30162332871503], [166.48574164608712, -22.302017822859717], [166.48272802757472, -22.30965557127206], [166.48072302149657, -22.310892787324253], [166.47785200362642, -22.310158747393952], [166.47997685466873, -22.309787724809254], [166.47791647207688, -22.306411137529746], [166.48273598394823, -22.30480284657431], [166.4835769976399, -22.300127212039467], [166.48355400505548, -22.30278939399473]]], [[[166.4824883244833, -22.297046415283944], [166.4829597618634, -22.294287427857206], [166.48165980336924, -22.292963253027928], [166.48422684114936, -22.294427062752263], [166.48462459101344, -22.300195186576808], [166.4824883244833, -22.297046415283944]]], [[[166.48211743155284, -22.289375414678556], [166.48266798801455, -22.290825308119057], [166.4822713392517, -22.291396909974644], [166.48158080862686, -22.28919278797804], [166.48211743155284, -22.289375414678556]]], [[[166.4804809991901, -22.256670797021872], [166.48082533731917, -22.257518244817618], [166.4815804635329, -22.257210040507417], [166.48045465984367, -22.257686933735755], [166.4804809991901, -22.256670797021872]]], [[[166.47483859417423, -22.25473946471528], [166.47545915048738, -22.25415570480571], [166.47635371943394, -22.25470647691323], [166.4757577742202, -22.255812593789397], [166.47483859417423, -22.25473946471528]]], [[[166.48622204448313, -22.25374250030999], [166.4859476797804, -22.25641483883346], [166.4843613561059, -22.25669108841293], [166.48409041089087, -22.25296404328174], [166.48622204448313, -22.25374250030999]]], [[[166.47727234271764, -22.25263903707606], [166.47824743123977, -22.253269614330303], [166.47798185799442, -22.25364040960812], [166.4771799059447, -22.253432859545484], [166.47727234271764, -22.25263903707606]]], [[[166.4838671933171, -22.25281906232502], [166.48376983880664, -22.25277254952976], [166.48366759207522, -22.252606202564376], [166.4836670563182, -22.25247195096183], [166.4838671933171, -22.25281906232502]]], [[[166.47776938206434, -22.25151056529114], [166.47766732559617, -22.251808311838897], [166.47888710813254, -22.25248886473311], [166.47765091498246, -22.25216698552649], [166.4775039751291, -22.251500081599577], [166.47776938206434, -22.25151056529114]]], [[[166.47887425278637, -22.24969071418855], [166.48347348901987, -22.2527710138251], [166.48361235612046, -22.254041967622936], [166.47886368248098, -22.252208457990175], [166.47887425278637, -22.24969071418855]]], [[[166.48108912377458, -22.24887632772083], [166.48214316545304, -22.24959543188559], [166.4820518812671, -22.249923163513582], [166.48100387599519, -22.24953826116905], [166.48108912377458, -22.24887632772083]]], [[[166.4752699454997, -22.24837979391563], [166.4760631470536, -22.248148744568553], [166.47635635513646, -22.248451115236275], [166.47516624451725, -22.249026482050507], [166.4752699454997, -22.24837979391563]]], [[[166.48361913272953, -22.247120659445073], [166.4850076827043, -22.24667368854723], [166.4854141442234, -22.24719382721245], [166.48478985143734, -22.247733467398078], [166.48322231998947, -22.247272116050166], [166.4830318573544, -22.247000409371516], [166.48361913272953, -22.247120659445073]]], [[[166.47442967779398, -22.247029019330178], [166.47502176178207, -22.246815392088752], [166.47567467675253, -22.247593927947413], [166.47407444332356, -22.24722157363062], [166.47442967779398, -22.247029019330178]]], [[[166.47598093636367, -22.247061743067633], [166.47641931730132, -22.246590286160654], [166.4771581722358, -22.24730363668221], [166.4768634906849, -22.24739610798005], [166.47598093636367, -22.247061743067633]]], [[[166.4851298902657, -22.246051490913484], [166.4851748775201, -22.246045647404596], [166.48523221784197, -22.24606670073104], [166.485168874194, -22.246057067776185], [166.4851298902657, -22.246051490913484]]], [[[166.48385267012918, -22.24392128863281], [166.4843469784355, -22.242635395077034], [166.48621715707037, -22.243524473463726], [166.48524369691768, -22.24429570339538], [166.48636468526917, -22.246255062934264], [166.48385267012918, -22.24392128863281]]], [[[166.4816184457439, -22.241890067387963], [166.4824512389963, -22.2416015214441], [166.48360003145723, -22.241957385087986], [166.48279542359705, -22.242372451291075], [166.48109933514516, -22.241769991435632], [166.4816184457439, -22.241890067387963]]], [[[166.47055074083246, -22.240843566339354], [166.47150811432527, -22.241895331556613], [166.47014001976538, -22.242670315101073], [166.4700002429776, -22.24169010543756], [166.47055074083246, -22.240843566339354]]], [[[166.4825370654437, -22.239455641296406], [166.48235158647972, -22.239231009773068], [166.48279852322682, -22.23891330612638], [166.48288967483387, -22.23953167825312], [166.4825370654437, -22.239455641296406]]], [[[166.48294909683557, -22.23872573378418], [166.48284720380562, -22.238813340521276], [166.48283888332955, -22.23868899667298], [166.48294909683557, -22.23872573378418]]], [[[166.47970533465974, -22.229768175913954], [166.48022778521567, -22.229753364954387], [166.48079308102632, -22.230361287548934], [166.4790152550753, -22.229778967202858], [166.47970533465974, -22.229768175913954]]], [[[166.47576674964185, -22.228254519988244], [166.47691513792054, -22.22782778699809], [166.4774329375912, -22.229120882361347], [166.47683453088163, -22.229659439453116], [166.47576674964185, -22.228254519988244]]], [[[166.50364148621844, -22.273727252142468], [166.50436000726035, -22.27439396103338], [166.50431193711876, -22.27490631032662], [166.50325961351595, -22.273595698306817], [166.50364148621844, -22.273727252142468]]], [[[166.50410439849375, -22.267579875887805], [166.50458629910923, -22.267890916681974], [166.50476107130717, -22.26826269878813], [166.50368317510856, -22.268336899192885], [166.50410439849375, -22.267579875887805]]], [[[166.50133871010414, -22.259192317292847], [166.50171719745788, -22.25998039795367], [166.50085373842617, -22.25994180609296], [166.50078059850517, -22.259537633571366], [166.50133871010414, -22.259192317292847]]], [[[166.49739340906802, -22.25849472894403], [166.49823956840393, -22.258746429248276], [166.4982993570452, -22.259313633398513], [166.49756377110245, -22.2592333443132], [166.49739340906802, -22.25849472894403]]], [[[166.49822982949527, -22.257738168529567], [166.49780856821283, -22.258173470002603], [166.49707210514444, -22.2578668995571], [166.49742219162516, -22.257447837077365], [166.49822982949527, -22.257738168529567]]], [[[166.4987441075129, -22.255882589352446], [166.49877392125268, -22.256434815958315], [166.49894144808917, -22.256977016029712], [166.4982433567767, -22.255599667594627], [166.4987441075129, -22.255882589352446]]], [[[166.4986111372516, -22.254040126692853], [166.49870117863026, -22.25489300752424], [166.49827736379464, -22.25532512433681], [166.49813926381177, -22.253833619216024], [166.4986111372516, -22.254040126692853]]], [[[166.48518461860235, -22.25302373070748], [166.48521706279078, -22.253028472320903], [166.48530020802693, -22.253059773764914], [166.48520592934867, -22.253035659881892], [166.48518461860235, -22.25302373070748]]], [[[166.4914758723788, -22.252696335906272], [166.4922058970179, -22.253085579311595], [166.4929517861834, -22.253107346539334], [166.49219459068337, -22.253396803149585], [166.49086533041037, -22.252700473256482], [166.4914758723788, -22.252696335906272]]], [[[166.49004210159563, -22.252277271751357], [166.49026348464042, -22.25217221891961], [166.4914648823657, -22.252179875029498], [166.4894886280897, -22.252735843326313], [166.49004210159563, -22.252277271751357]]], [[[166.49816710175793, -22.25072087647079], [166.49841616844105, -22.2509521216555], [166.49798793627758, -22.25163592226116], [166.49746381116128, -22.25071296283886], [166.49816710175793, -22.25072087647079]]], [[[166.4944098065167, -22.249640593256807], [166.49523245670716, -22.250668074215532], [166.4959568001334, -22.250594381918347], [166.49525131303992, -22.250816250017984], [166.49397152988087, -22.25034920561211], [166.4944098065167, -22.249640593256807]]], [[[166.4872481451679, -22.245616172764464], [166.4912033829017, -22.24603931374461], [166.49324682391918, -22.249990820283514], [166.49134689342392, -22.24698720545579], [166.4872481451679, -22.245616172764464]]], [[[166.48630361242596, -22.246375634356184], [166.48631265378353, -22.246357147465332], [166.4863666757972, -22.246326021069944], [166.48634676807652, -22.24635758112296], [166.48630361242596, -22.246375634356184]]], [[[166.48649593005936, -22.244303735147604], [166.48719528277044, -22.244902325116815], [166.4869022893568, -22.24549759958377], [166.48612047801396, -22.24492719807527], [166.48649593005936, -22.244303735147604]]], [[[166.4909876798615, -22.24420753189074], [166.49149245235125, -22.24380530562936], [166.49206158688952, -22.243741676603296], [166.49057493581537, -22.244756445127003], [166.4909876798615, -22.24420753189074]]], [[[166.48828947582567, -22.24279164293172], [166.48903553200148, -22.242192773552816], [166.4903497915058, -22.24248629860037], [166.48894427206827, -22.24366742011241], [166.48828947582567, -22.24279164293172]]], [[[166.50171229229116, -22.240510033244895], [166.50377611120692, -22.240961719724904], [166.50382968187532, -22.241217803485384], [166.50115088796161, -22.24055700645771], [166.50171229229116, -22.240510033244895]]], [[[166.48560088636975, -22.23926120902307], [166.4840823854084, -22.23948952938641], [166.48583429796795, -22.24113209474496], [166.48316401484308, -22.23871429367749], [166.4868169047541, -22.237557318683407], [166.4888863290867, -22.23947707778119], [166.48560088636975, -22.23926120902307]]], [[[166.49774965771223, -22.2379397081406], [166.4986811743956, -22.23803683772098], [166.50046327850345, -22.2397645286752], [166.49725210166474, -22.23766180162502], [166.49774965771223, -22.2379397081406]]], [[[166.48881897322406, -22.235659532382375], [166.4894261084011, -22.236122146168018], [166.48947039489678, -22.236492673422493], [166.48803243577277, -22.235292817778518], [166.48881897322406, -22.235659532382375]]], [[[166.48809979922382, -22.233380724859767], [166.4883964832477, -22.232563150735484], [166.49227337797717, -22.235525120113117], [166.49656627399776, -22.236290064186406], [166.48974343940387, -22.23612081936015], [166.48809979922382, -22.233380724859767]]], [[[166.48467500706144, -22.23084454967171], [166.48727748955196, -22.232955136076026], [166.48698032861705, -22.234529908850053], [166.4845318978774, -22.23396371871183], [166.48467500706144, -22.23084454967171]]], [[[166.4856637348842, -22.22770061768079], [166.48661736546546, -22.228728761636667], [166.4860231441602, -22.229235631188978], [166.484737363363, -22.22732360006964], [166.4856637348842, -22.22770061768079]]]]}", "forest_cover_percentage": null, "forest_fragmentation_effective_mesh_size": 0.17220835936358733, "forest_fragmentation_fragment_size_distribution": {"10": 41.82839584938499, "100": 99.99999999999997, "1000": 99.99999999999997, "1100": 99.99999999999997, "1200": 99.99999999999997, "12000": 99.99999999999997, "125": 99.99999999999997, "1300": 99.99999999999997, "1400": 99.99999999999997, "150": 99.99999999999997, "1500": 99.99999999999997, "1600": 99.99999999999997, "1700": 99.99999999999997, "17000": 99.99999999999997, "175": 99.99999999999997, "1800": 99.99999999999997, "1900": 99.99999999999997, "20": 58.958712759059985, "200": 99.99999999999997, "2000": 99.99999999999997, "225": 99.99999999999997, "250": 99.99999999999997, "27000": 99.99999999999997, "275": 99.99999999999997, "30": 66.69909813746696, "300": 99.99999999999997, "325": 99.99999999999997, "350": 99.99999999999997, "375": 99.99999999999997, "40": 99.99999999999997, "400": 99.99999999999997, "425": 99.99999999999997, "450": 99.99999999999997, "475": 99.99999999999997, "50": 99.99999999999997, "500": 99.99999999999997, "500000": 99.99999999999997, "60": 99.99999999999997, "600": 99.99999999999997, "70": 99.99999999999997, "700": 99.99999999999997, "7000": 99.99999999999997, "80": 99.99999999999997, "800": 99.99999999999997, "90": 99.99999999999997, "900": 99.99999999999997}, "forest_humidity_category_distribution": null, "frequencies": {}, "id": 14, "land_use_category_distribution": null, "name": "NOUMEA", "num_families_unique_taxonomic_count": 65, "num_occurrences_count": 1781, "num_species_unique_taxonomic_count": 213, "rainfall_mean": "992.1052856445312", "rainfall_range": "{\"min\": 880.0, \"max\": 1080.0}", "shape_area": "4940.431824218239", "shape_coordinates": "{\"type\": \"FeatureCollection\", \"features\": [{\"id\": \"0\", \"type\": \"Feature\", \"properties\": {}, \"geometry\": {\"type\": \"MultiPolygon\", \"coordinates\": [[[[166.48976729076495, -22.222493677542136], [166.48886371066, -22.22307303517339], [166.49235475431595, -22.224521674275145], [166.49172697578516, -22.223164710207808], [166.49412214726712, -22.223925454927848], [166.4915745818024, -22.227276746079124], [166.4953646538621, -22.22580143013689], [166.49265784159812, -22.231475054652122], [166.50323195258613, -22.238788030712094], [166.5040255347626, -22.240977929539653], [166.49655527695143, -22.23874924306627], [166.49271642703184, -22.240371204113604], [166.487935680628, -22.23499128973772], [166.48576187573155, -22.237330179102486], [166.48855040599705, -22.23795138586779], [166.48886083121062, -22.239504016883608], [166.48595881987097, -22.238972151078986], [166.48735349219086, -22.240604182983695], [166.48578667735578, -22.241129716497994], [166.48281528036654, -22.238840788015356], [166.4834788493358, -22.24248951339916], [166.49047807405145, -22.241993063582804], [166.48816260928285, -22.24439774139993], [166.49221666629063, -22.243621573357075], [166.49032842352705, -22.245504946367713], [166.493472011262, -22.24628425531466], [166.4931753683938, -22.248544230046832], [166.49611852090285, -22.250122202543576], [166.4932671793213, -22.250909566916036], [166.4891915664084, -22.245901375089108], [166.4847231581686, -22.246050394175864], [166.48678731545849, -22.24675220308734], [166.48382079245062, -22.247333312448113], [166.48550567303863, -22.24865073541104], [166.48906965710358, -22.24808662931202], [166.48722616140628, -22.250264621492562], [166.4906603761599, -22.249716809787024], [166.4896622760672, -22.252130941673865], [166.4939391270668, -22.2534594188972], [166.49211646174905, -22.255256392647386], [166.49164957948776, -22.25450215207741], [166.490150532359, -22.254426662060773], [166.48998452301575, -22.254844367206527], [166.49021203174067, -22.25578544314346], [166.49037275234417, -22.256052715254285], [166.49103402172344, -22.25460491475723], [166.4934883293806, -22.256865916893727], [166.49059134729936, -22.259798881413822], [166.48865994291268, -22.259745316682448], [166.48959305531702, -22.257607626125935], [166.48919255680815, -22.2568980693039], [166.48831434021176, -22.256839734440423], [166.48844011091617, -22.255144938351336], [166.48742322815306, -22.25261338799623], [166.48675794528458, -22.252062210539787], [166.48675382024754, -22.253707313448267], [166.4857487840707, -22.252117844082257], [166.48368856379648, -22.25249783397751], [166.48641544679657, -22.25394722411548], [166.4866488633691, -22.256113302215237], [166.48484952067778, -22.256566470875782], [166.48714281555527, -22.256722684667256], [166.48533887856064, -22.257789243607654], [166.4859226376218, -22.258840886200105], [166.4825503931637, -22.256971372660225], [166.48043668429622, -22.25766587281937], [166.48313116278504, -22.25450156611473], [166.48073505315094, -22.25268244783585], [166.47835754351522, -22.253127084316354], [166.4785621637571, -22.255765909800573], [166.47677219887623, -22.255882773481062], [166.4797131937665, -22.256855805870444], [166.47593696277934, -22.258888251396705], [166.47412707837628, -22.255231719242953], [166.47720084070156, -22.251983873553087], [166.47397999617715, -22.251229357851326], [166.47696809469304, -22.24942690311597], [166.47264571904796, -22.250810355085278], [166.4734763689345, -22.25606992220231], [166.47586042613804, -22.259023136637367], [166.47198032591953, -22.2673549952187], [166.47544159653555, -22.26865901897353], [166.4756476213316, -22.271190259569888], [166.48073121736982, -22.27698090375513], [166.47873013627643, -22.27738564199381], [166.47823703722952, -22.27945079889415], [166.47949042417054, -22.27992750370329], [166.48140460173354, -22.283282065806645], [166.47904770309208, -22.283593094840267], [166.47807431743442, -22.281419031636243], [166.4796519497449, -22.280848892492607], [166.48002202649153, -22.28256128134497], [166.47974142174616, -22.28042339453967], [166.477641910361, -22.281035167689993], [166.4767370632845, -22.28046392566018], [166.47838561164033, -22.280070519398855], [166.47654768199976, -22.279335268430927], [166.47619505040836, -22.279791219733063], [166.4769880535969, -22.280890928141584], [166.47411455672446, -22.28289043472869], [166.4748682891977, -22.284420013679362], [166.47275434202186, -22.28328451168857], [166.46834086343074, -22.286156174282144], [166.46620941962115, -22.285795705686926], [166.4665079649334, -22.282601803057418], [166.468584799546, -22.28157226953112], [166.47017941036975, -22.28269395287812], [166.4725345249294, -22.280567450879193], [166.47115171117838, -22.28037974507606], [166.4709331273663, -22.280199276024696], [166.47076876869664, -22.279888332090945], [166.47256916120875, -22.280275213310976], [166.47310325723285, -22.280935293701443], [166.47624845583843, -22.277797363026405], [166.4699418348791, -22.279059546373105], [166.4720450426099, -22.277938664607635], [166.47115060097138, -22.27708368504186], [166.47123806038545, -22.27571498947469], [166.47214166821607, -22.277750371555946], [166.47261666141245, -22.275607562345986], [166.47462576009346, -22.275452329608957], [166.47194807381058, -22.275553994875978], [166.47299055571605, -22.272157398212958], [166.47198489878863, -22.271527585099363], [166.47112379812958, -22.273698297959736], [166.46992982227457, -22.27065753477417], [166.4695535468529, -22.2741819066716], [166.47066590824858, -22.273840997164314], [166.46879072287672, -22.280574235034983], [166.46093538059804, -22.279278156201414], [166.458225651427, -22.28173710995479], [166.4591649353131, -22.284604411074532], [166.45746425135673, -22.286417274172294], [166.4591009616055, -22.288044146537334], [166.45951379467192, -22.29242746361036], [166.45750961115456, -22.301063294712375], [166.46212716636782, -22.306641191213643], [166.45604875120247, -22.311810483807662], [166.4497364252729, -22.311249687828308], [166.44820025026084, -22.312444009604786], [166.4470027171395, -22.30430787096752], [166.44100159100284, -22.302680320697327], [166.43439695532155, -22.30370315341515], [166.43494482512918, -22.301915793142904], [166.4377776544108, -22.300875446202628], [166.43802241750413, -22.297010448068317], [166.43587552140886, -22.294835080190445], [166.43068136197385, -22.293810576721427], [166.43660815117101, -22.291470811028], [166.4379195843858, -22.294127207779557], [166.43884309695423, -22.292537046674212], [166.4365587499313, -22.289799860001843], [166.4392655780528, -22.290025905645294], [166.4394276304705, -22.288459393161183], [166.44237931527533, -22.289747010152887], [166.44416264563145, -22.2880922652702], [166.4437661816336, -22.28415734759803], [166.43997481082, -22.284173191143555], [166.4401969725343, -22.28602220342292], [166.43986817260463, -22.283687144586313], [166.4324278847465, -22.283552244797573], [166.4364757453544, -22.278868890538373], [166.43588698301647, -22.277776653775366], [166.43632991052255, -22.27666441655571], [166.43713507287836, -22.27919019864289], [166.4410351573265, -22.277173981901065], [166.44088737064473, -22.275564411288283], [166.4357980185075, -22.27633021258437], [166.438013766173, -22.274847197840398], [166.43694474028652, -22.268372596210156], [166.42720460978842, -22.268363688354846], [166.42397449688036, -22.265850689378233], [166.4265166256685, -22.263246846160897], [166.43913916393012, -22.26556479297064], [166.44336171529105, -22.261706637894946], [166.44100146952607, -22.25916760324296], [166.43858029366876, -22.261802185851256], [166.43334973446105, -22.254829376801275], [166.4261956168232, -22.25268720948005], [166.42941191659781, -22.246012445992466], [166.43168585935098, -22.244669201654443], [166.44726810123657, -22.249936010257866], [166.4468975222889, -22.24918277247515], [166.4473805903611, -22.24958928544386], [166.44894570957018, -22.249234980687326], [166.44951277843137, -22.249010283142386], [166.4495681757937, -22.248904364958197], [166.44243731947216, -22.246837418230026], [166.4385712378343, -22.242715529753706], [166.4353272177008, -22.244739444968825], [166.4343942948455, -22.242743861669833], [166.43040225592196, -22.242098370069975], [166.42916330580425, -22.240387481455834], [166.42328215576845, -22.241889530692102], [166.42681186824043, -22.24646751307237], [166.42439561152446, -22.248898171402363], [166.4189006214254, -22.24364258127857], [166.41477541370136, -22.247833533567434], [166.41671393886332, -22.23876692800063], [166.41309531502844, -22.23945589771226], [166.4106221660271, -22.243302722196326], [166.4064966845483, -22.24017711743205], [166.40894288166632, -22.237037483035426], [166.4076851187987, -22.234617162665412], [166.39913243586713, -22.235081625883566], [166.39404148472795, -22.229930452637895], [166.39867452911753, -22.230676959849646], [166.4026741790816, -22.227387526656035], [166.40919788460715, -22.23335097564335], [166.41493399818572, -22.228527620003785], [166.41869616321657, -22.227821966672472], [166.42094395588938, -22.229913768235665], [166.42359605482025, -22.228704265422596], [166.4256479212127, -22.23160540002075], [166.4281293008897, -22.231702071377914], [166.42968191025776, -22.23124723522454], [166.43015948078852, -22.228199031044216], [166.42822231260436, -22.22805461061694], [166.42847979957722, -22.22306020727052], [166.42659941514654, -22.22315737332733], [166.4292414714914, -22.22214568142358], [166.43024816213983, -22.224696053217915], [166.43514852951748, -22.22533041236471], [166.43266952645243, -22.22916339190445], [166.43817686891998, -22.232499883003893], [166.43860905442162, -22.224981048897614], [166.44776755395816, -22.22611728212571], [166.43903448578737, -22.224756050166047], [166.43919042878974, -22.222043134134548], [166.44518230219603, -22.221577592612565], [166.45392699510418, -22.2252686473136], [166.4538043796952, -22.22827677014388], [166.4479223980487, -22.226197940132757], [166.45419131414712, -22.228914781997897], [166.45689684143625, -22.234516404899296], [166.45639225055027, -22.24091465970768], [166.45393228558407, -22.241526390489476], [166.45195965877497, -22.23944404120856], [166.4534494075629, -22.241626502452853], [166.45541337126696, -22.241953453279933], [166.45441882447284, -22.242185704580844], [166.45369438704932, -22.24294701929366], [166.45528994966597, -22.242255113688568], [166.4554797887083, -22.244360328950744], [166.45358133384693, -22.246831935602394], [166.45465779397324, -22.2478362143379], [166.45817368138933, -22.244344782324635], [166.46147152010082, -22.244353154588257], [166.4612929507052, -22.24551847955498], [166.46188192491977, -22.244301841466843], [166.46399387118075, -22.24825789839326], [166.46382084550814, -22.24674485703299], [166.46649527855416, -22.24699259827208], [166.46362229923594, -22.245652154030537], [166.46730470239314, -22.24456194727908], [166.46730477957712, -22.239483379924103], [166.46983792976638, -22.23745827651803], [166.46831871077518, -22.236532749090355], [166.471016578743, -22.237808463471], [166.46870701307404, -22.235852005970273], [166.46980166653682, -22.23520675638804], [166.4687199782538, -22.235663909406657], [166.46727773493694, -22.237936799318014], [166.4661701255149, -22.23816318585161], [166.46693613501998, -22.234598170481828], [166.46490500673937, -22.24100525039305], [166.46235156631124, -22.24411995782388], [166.46348214003947, -22.24190431994646], [166.4619943119068, -22.244085007061507], [166.4581622238406, -22.24410115948782], [166.4556568098116, -22.242177978922527], [166.45770566987392, -22.240787153444586], [166.45740875488787, -22.234730796600523], [166.45581812930666, -22.230892750511764], [166.45721067959732, -22.23020940289511], [166.45536939869464, -22.22927663165057], [166.457243528475, -22.22995142536564], [166.4587589609305, -22.228128916369542], [166.45811523437663, -22.226366781316326], [166.45889156597994, -22.22773104698896], [166.46060129172625, -22.226307365417647], [166.45929675455278, -22.22430958833515], [166.46811962892036, -22.227625221545775], [166.47691548335197, -22.22588536369653], [166.48005087814326, -22.22080976731776], [166.47941337825065, -22.21926445848481], [166.48434602946344, -22.216726124483454], [166.48654946037064, -22.21665515373606], [166.48727624375104, -22.219691109199513], [166.48488431751707, -22.21904617764843], [166.48450195143894, -22.22286576935559], [166.48689530235941, -22.220957027766733], [166.48750685908942, -22.22268151071853], [166.48976729076495, -22.222493677542136]]], [[[166.41096460570213, -22.27236659336816], [166.41011675280703, -22.273941987328744], [166.40906821869174, -22.271150824859024], [166.39912321335632, -22.27043993196153], [166.39001000007752, -22.263667653520304], [166.38653488824966, -22.259035663869334], [166.38957706227828, -22.260561748639834], [166.39143053019995, -22.258309451044504], [166.38574028622017, -22.252554980626524], [166.3871900721216, -22.248314913090862], [166.39201792381317, -22.247195161074785], [166.40066037470322, -22.258357340097493], [166.40320567467026, -22.258475639586486], [166.40376832749158, -22.26124000586886], [166.40968475987972, -22.262141216420297], [166.41352292467298, -22.266860720927383], [166.41621229548846, -22.264025690590735], [166.42656492794848, -22.268232524833383], [166.42834264522256, -22.271512223909845], [166.42617604581767, -22.27826284908476], [166.4274263237509, -22.280260382303805], [166.42669261271456, -22.28276980036645], [166.4241370754115, -22.280733842149605], [166.42578158465983, -22.27452522165481], [166.42354748916915, -22.271689738837292], [166.4182487582107, -22.270492119295174], [166.4165185078248, -22.273050452603698], [166.41495346088365, -22.269505493233833], [166.41285248450404, -22.269016856047006], [166.4104560206974, -22.27081971053759], [166.41096460570213, -22.27236659336816]]], [[[166.48054754314455, -22.288875128543467], [166.48349933810255, -22.288059704086887], [166.48354760664105, -22.29137077959507], [166.48621957421182, -22.29242984435064], [166.48571326073358, -22.296753682750897], [166.4885716324153, -22.297708586613076], [166.48300587021197, -22.30936061197736], [166.48069374588823, -22.31091695757254], [166.47767842875413, -22.310235341141208], [166.47658650759064, -22.30689382834338], [166.4831451352328, -22.302433369165655], [166.48327166932708, -22.298691696917572], [166.48286611702855, -22.297681925307216], [166.4815443021641, -22.297474092952513], [166.48138757920304, -22.296821989243455], [166.48255202989256, -22.297480800959807], [166.48272798533714, -22.296018993585687], [166.480444721907, -22.29123249930932], [166.48152743997616, -22.29166167490697], [166.4814391413239, -22.290189614575898], [166.4797786551613, -22.288704531509946], [166.4769161540745, -22.28928958688125], [166.48016531563442, -22.286956467602472], [166.48054754314455, -22.288875128543467]]], [[[166.47232630767246, -22.3142803675983], [166.47156022131304, -22.312512575918227], [166.4740802231656, -22.310771336797412], [166.47552550184287, -22.314944545085854], [166.4789872473187, -22.31294120423099], [166.48120864058868, -22.314671838094917], [166.47303562138327, -22.31605635184113], [166.47232630767246, -22.3142803675983]]], [[[166.4303705566832, -22.29361258927451], [166.42828106924446, -22.293756755569998], [166.42613029930246, -22.292406006593165], [166.42472219613683, -22.287818386293903], [166.42849565735733, -22.28945627242166], [166.42795104369992, -22.29218237312746], [166.4303705566832, -22.29361258927451]]], [[[166.49731028170623, -22.257485267360174], [166.49886705503064, -22.257047167907558], [166.49781890116415, -22.25051060274909], [166.5000447415479, -22.253112122360598], [166.49906735009603, -22.257061121564472], [166.50194739669115, -22.25995762721462], [166.49794947184895, -22.259537319944165], [166.49731028170623, -22.257485267360174]]], [[[166.29161460297846, -22.29619299429654], [166.29228652043167, -22.294317891784633], [166.29455996492206, -22.294552689661373], [166.29373625259782, -22.298912969568743], [166.29181006615636, -22.29844959014575], [166.29161460297846, -22.29619299429654]]], [[[166.38927462476147, -22.22457327243625], [166.38932363187, -22.227069659907773], [166.38765149351872, -22.22729364935631], [166.38695509094754, -22.22484977987227], [166.38927462476147, -22.22457327243625]]], [[[166.41010058422282, -22.334337822809058], [166.40898683397683, -22.336828785926674], [166.40760965142906, -22.33628436280936], [166.41162216910666, -22.330937876373984], [166.41010058422282, -22.334337822809058]]], [[[166.46623654954854, -22.477704386477537], [166.4685559341265, -22.475872068064707], [166.46973654932202, -22.47679959188743], [166.46755890748523, -22.478754639318467], [166.46623654954854, -22.477704386477537]]], [[[166.46119201948102, -22.2811861728829], [166.4631413749171, -22.281118939277352], [166.46377551811787, -22.282114397228984], [166.46140799582366, -22.28265959517661], [166.46119201948102, -22.2811861728829]]], [[[166.50462443484096, -22.274775930622525], [166.50362763231487, -22.275284711869975], [166.50331332086697, -22.27687836585695], [166.50322948549552, -22.272838758483307], [166.50462443484096, -22.274775930622525]]], [[[166.48776937282037, -22.257224686216492], [166.48732939589485, -22.256082080498235], [166.4880045946971, -22.254940163884704], [166.487891986675, -22.256141083985238], [166.48829801076968, -22.256952430414678], [166.48899798283105, -22.25723507417754], [166.48922167660373, -22.25811427587436], [166.48776937282037, -22.257224686216492]]], [[[166.4221124113576, -22.22550691374975], [166.42195997355321, -22.226438407623426], [166.4210758072225, -22.226637484262692], [166.42100766036955, -22.225689999786614], [166.4221124113576, -22.22550691374975]]], [[[166.31935176382072, -22.327807017878854], [166.31871017849872, -22.327426493547993], [166.32071092157463, -22.32682635837414], [166.3198368293419, -22.327651653554216], [166.31935176382072, -22.327807017878854]]], [[[166.50426964014054, -22.268423224845748], [166.50368880122411, -22.268359069672442], [166.50367374794877, -22.267076851695943], [166.50496675344368, -22.26803085327778], [166.50426964014054, -22.268423224845748]]], [[[166.43629691292384, -22.313518082057815], [166.434897733205, -22.312368323698756], [166.4353444062436, -22.311738260474133], [166.43565508369628, -22.31194997804964], [166.43629691292384, -22.313518082057815]]], [[[166.4363975010756, -22.289757101994823], [166.43570438421628, -22.290375054013587], [166.43695291148575, -22.288815603176552], [166.43876449879951, -22.288790710839496], [166.4363975010756, -22.289757101994823]]], [[[166.4938675677406, -22.225284870172835], [166.49392520345825, -22.22508753625337], [166.49494805864808, -22.225117505305644], [166.49630545497146, -22.225547247431866], [166.4938675677406, -22.225284870172835]]], [[[166.42559337113715, -22.221568893870547], [166.4255283395952, -22.222004794457057], [166.42491500828606, -22.221626152565452], [166.425200691118, -22.221381385123838], [166.42559337113715, -22.221568893870547]]], [[[166.4877165439577, -22.253785279940562], [166.48780492824687, -22.253966753641777], [166.48770052190252, -22.254283542584446], [166.4874490410313, -22.253724615840035], [166.4877165439577, -22.253785279940562]]], [[[166.47048820985438, -22.313415896467202], [166.47013485962376, -22.313353923614006], [166.47006971389627, -22.313167287941777], [166.47048981434332, -22.3130597756043], [166.47048820985438, -22.313415896467202]]], [[[166.4226399176606, -22.279975462055898], [166.42262374821945, -22.280164643709725], [166.42216960235845, -22.280102362491576], [166.4222599090074, -22.279793706741174], [166.4226399176606, -22.279975462055898]]], [[[166.4308238527892, -22.22262569803859], [166.4307591222357, -22.222840259538415], [166.43031673190956, -22.22293835954515], [166.43045715586834, -22.222670321410607], [166.4308238527892, -22.22262569803859]]], [[[166.42834067601737, -22.29182402397809], [166.42875649617395, -22.291725171797964], [166.42878917758387, -22.291151175529652], [166.42883917210847, -22.291885505050914], [166.42834067601737, -22.29182402397809]]], [[[166.48185893745833, -22.284700190471252], [166.48177858740124, -22.28449267394287], [166.4819132476802, -22.284159804640435], [166.4820502726183, -22.284419835999955], [166.48185893745833, -22.284700190471252]]], [[[166.50211683535463, -22.26103484687009], [166.50218591309545, -22.260831951479396], [166.50231816195875, -22.261317823163964], [166.50216796073892, -22.261252672107805], [166.50211683535463, -22.26103484687009]]], [[[166.4874796771736, -22.254741760816966], [166.4874051434339, -22.254685251439376], [166.48728404434704, -22.254217344988813], [166.48749873412842, -22.254417073982157], [166.4874796771736, -22.254741760816966]]], [[[166.47223036394433, -22.286121354124976], [166.47235457464026, -22.28577815117118], [166.4724810924299, -22.285834770570236], [166.47236096109737, -22.28588914864479], [166.47223036394433, -22.286121354124976]]], [[[166.50626225540083, -22.25787107783729], [166.5061609143795, -22.2580316723973], [166.50605684615084, -22.257943772377285], [166.50609619338755, -22.25785617166781], [166.50626225540083, -22.25787107783729]]], [[[166.43653108436735, -22.291403201145332], [166.43640281174916, -22.291126334334454], [166.43640146369307, -22.290978447380482], [166.43660180442444, -22.291406718158232], [166.43653108436735, -22.291403201145332]]], [[[166.50521552458048, -22.258553912002146], [166.5052646456523, -22.258651658945904], [166.50513506765284, -22.258928926414086], [166.50507451910588, -22.258862361305695], [166.50521552458048, -22.258553912002146]]], [[[166.4918665416583, -22.258887105340506], [166.49129922789837, -22.259203271525767], [166.49122348773602, -22.259222179761455], [166.4921288090023, -22.258727430639773], [166.4918665416583, -22.258887105340506]]], [[[166.40892308915315, -22.33394698479701], [166.40889598856708, -22.334051056322398], [166.4087714416947, -22.3340420849087], [166.40881711450407, -22.33394585194515], [166.40892308915315, -22.33394698479701]]], [[[166.472109246992, -22.287495836301343], [166.47218614616625, -22.287814379541352], [166.47214075240777, -22.287835711403172], [166.4720594217632, -22.287658692899658], [166.47210918804126, -22.28741786472067], [166.472109246992, -22.287495836301343]]], [[[166.4871628518734, -22.25398386248905], [166.4871224405495, -22.253894051918028], [166.4871649788654, -22.253856178501948], [166.48723697288946, -22.25393433970323], [166.4871628518734, -22.25398386248905]]], [[[166.40360828087057, -22.235747762273956], [166.40365847227753, -22.235831788247328], [166.40363158503206, -22.235878841727825], [166.40353853383832, -22.235819226414527], [166.40360828087057, -22.235747762273956]]], [[[166.44593536699105, -22.313257412681995], [166.4459308479751, -22.313187742070536], [166.4459990437515, -22.313028878284637], [166.4459733285431, -22.31325579295713], [166.44593536699105, -22.313257412681995]]], [[[166.4342374315454, -22.304082297907602], [166.4342674574384, -22.30412017098377], [166.43427889993282, -22.304177148714032], [166.434202684655, -22.30412619392325], [166.4342374315454, -22.304082297907602]]]]}, \"bbox\": [166.29161460297846, -22.478754639318467, 166.50626225540083, -22.21665515373606]}], \"bbox\": [166.29161460297846, -22.478754639318467, 166.50626225540083, -22.21665515373606]}", "shape_id": 14, "type": "communes"};
    var mapping = {"fields": {"elevation": {"data_source": {"name": "elevation", "type": "layer"}, "description": "Altitude metrics within the shape", "field_type": "JSON", "label": "Altitude", "transformations": [{"chart_options": {"title": "Median Altitude"}, "chart_type": "text", "name": "median"}, {"chart_options": {"title": "Maximum Altitude"}, "chart_type": "text", "name": "max"}, {"chart_options": {"title": "Elevation Distribution", "x_label": "Elevation (m)", "y_label": "Area (ha)"}, "chart_type": "stacked_bar", "data_structure": {"x_field": "altitudes", "y_fields": [{"color": "#4BC0C0", "label": "For\u00eat", "name": "forest"}, {"color": "#FF6384", "label": "Hors-for\u00eat", "name": "non_forest"}]}, "name": "elevation_distribution"}]}, "forest": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "TEXT", "label": "Forest Area", "transformations": [{"chart_options": {"title": "Forest Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "forest_coordinates", "title": "Forest Location"}, "chart_type": "map", "name": "coordinates"}]}, "forest_cover": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "JSON", "label": "Forest Area", "transformations": [{"chart_options": {"categories": ["UM", "Non-UM", "Commune"], "title": "Forest Cover"}, "chart_type": "donut", "layer_params": {"forest_cover": [{"name": "area"}, {"attribute": "cover_type"}], "soil_types": [{"attribute": "soil_category"}]}, "name": "percentage"}]}, "forest_fragmentation": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Analysis of forest fragmentation", "field_type": "JSON", "label": "Forest Fragmentation", "transformations": [{"chart_options": {"bins": [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 7000, 12000, 17000, 27000, 500000], "title": "Forest Fragment Distribution", "x_label": "Area (ha)", "y_label": "Cumulative Area (%)"}, "chart_type": "line", "data_structure": {"color": "#4BC0C0", "x_field": "keys", "y_field": "values"}, "name": "fragment_size_distribution"}, {"chart_options": {"label": "Effective Mesh Size (km\u00b2)", "max": 1000, "min": 0, "title": "Fragmentation"}, "chart_type": "gauge", "name": "effective_mesh_size"}]}, "forest_humidity": {"data_source": [{"name": "forest_cover", "type": "layer"}, {"name": "holdridge", "type": "shape"}], "description": "Distribution of forests by humidity level", "field_type": "JSON", "label": "Forest and Living Environments", "transformations": [{"chart_options": {"categories": ["Dry", "Humid", "Very Humid"], "title": "Forest and Living Environments", "x_label": "Category", "y_label": "Frequency (%)"}, "chart_type": "stacked_bar", "layer_params": {"forest_cover": [{"name": "area"}], "humidity": [{"name": "value"}]}, "name": "category_distribution"}]}, "land_use": {"data_source": [{"name": "ultramafic", "type": "shape"}, {"name": "holdridge", "type": "shape"}, {"name": "forest_cover", "type": "layer"}], "description": "Land use distribution", "field_type": "JSON", "label": "Land Use", "transformations": [{"chart_options": {"title": "Land Use", "x_label": "Category", "y_label": "Area (ha)"}, "chart_type": "bar", "name": "category_distribution"}]}, "num_families": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of families in the zone", "field_type": "INTEGER", "label": "Number of Families", "transformations": [{"chart_options": {"title": "Number of Families"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["family"]}]}, "num_occurrences": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of occurrences in the zone", "field_type": "INTEGER", "label": "Number of Occurrences", "source_field": "id_occurrence", "transformations": [{"chart_options": {"title": "Number of Occurrences"}, "chart_type": "text", "name": "count"}]}, "num_species": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of species in the zone", "field_type": "INTEGER", "label": "Number of Species", "transformations": [{"chart_options": {"title": "Number of Species"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["species", "infra"]}]}, "rainfall": {"data_source": {"name": "rainfall", "type": "layer"}, "description": "Average annual rainfall within the shape", "field_type": "TEXT", "label": "Average Rainfall", "transformations": [{"chart_options": {"title": "Average Rainfall"}, "chart_type": "text", "name": "mean"}, {"chart_options": {"title": "Rainfall Range"}, "chart_type": "text", "name": "range"}]}, "shape": {"data_source": {"name": "self", "type": "shape"}, "description": "Total area of the reference zone", "field_type": "TEXT", "label": "Shape Area", "transformations": [{"chart_options": {"title": "Total Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "shape_coordinates", "title": "Location"}, "chart_type": "map", "name": "coordinates"}]}}, "group_by": "shape", "source_location_field": "geo_pt", "source_table_name": "occurrences"};
    var currentShapeType = "communes";

    document.addEventListener('DOMContentLoaded', function () {
        loadShapeCharts(shape, mapping);
        loadShapeTypeList();
        initShapeMaps(mapping, shape);
        loadAllShapesMap(shape);
    });

    function loadShapeCharts(shape, mapping) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            if (field.field_type !== 'TEXT' && shape[field_key] !== null) {
                // Handle bins chart if present
                if (field.bins && field.bins.values && field.bins.values.length > 0) {
                    var binChartId = field_key + 'BinChart';
                    var binCtx = document.getElementById(binChartId);
                    if (binCtx) {
                        createBinChart(binCtx, field, shape);
                    }
                }

                // Handle transformations
                field.transformations.forEach(function(transformation) {
                    var transformationName = transformation.name ? transformation.name : '';
                    var valueKey = field_key + '_' + transformationName;

                    if (shape[valueKey] !== null) {
                        switch(transformation.chart_type) {
                            case 'pie':
                                var pieChartId = field_key + 'PieChart';
                                var pieCtx = document.getElementById(pieChartId);
                                if (pieCtx) {
                                    createPieChart(pieCtx, transformation, shape[valueKey]);
                                }
                                break;
                            case 'gauge':
                                var gaugeId = field_key + transformationName + 'Gauge';
                                var gaugeElement = document.getElementById(gaugeId);
                                if (gaugeElement) {
                                    createGauge({
                                        id: gaugeId,
                                        value: parseFloat(shape[valueKey]),
                                        min: 0,
                                        max: transformation.chart_options.max,
                                        title: transformation.chart_options.title,
                                        label: transformation.chart_options.label
                                    });
                                }
                                break;
                            case 'bar':
                                var barChartId = field_key + transformationName + 'BarChart';
                                var barCtx = document.getElementById(barChartId);
                                if (barCtx) {
                                    createBarChart(barCtx, field, transformation, shape[valueKey]);
                                }
                                break;
                            case 'stacked_bar':
                                if (field_key === 'elevation' && transformationName === 'elevation_distribution') {
                                    var stackedBarChartId = 'elevationDistributionChart';
                                    var stackedBarCtx = document.getElementById(stackedBarChartId);
                                    if (stackedBarCtx) {
                                        createElevationDistributionChart(stackedBarCtx, shape.elevation_elevation_distribution, transformation);
                                    }
                                }
                                break;
                            case 'line':
                                if (field_key === 'forest_fragmentation' && transformationName === 'fragment_size_distribution') {
                                    var lineChartId = 'forestFragmentationChart';
                                    var lineCtx = document.getElementById(lineChartId);
                                    if (lineCtx) {
                                        createForestFragmentationChart(lineCtx, shape.forest_fragmentation_fragment_size_distribution, transformation);
                                    }
                                }
                                break;
                        }
                    }
                });
            }
        });
    }

    function createBinChart(ctx, field, shape) {
        var binData = {
            labels: field.bins.values,
            datasets: [{
                label: field.label,
                data: field.bins.values.map(value => shape.frequencies[field.field_key][value] || 0),
                backgroundColor: field.bins.chart_options.color
            }]
        };

        new Chart(ctx, {
            type: field.bins.chart_type,
            data: binData,
            options: field.bins.chart_options
        });
    }

    function createPieChart(ctx, transformation, data) {
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['True', 'False'],
                datasets: [{
                    data: [data.true || 0, data.false || 0],
                    backgroundColor: ['#FF6384', '#36A2EB']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: transformation.chart_options.title
                }
            }
        });
    }

    function createBarChart(ctx, field, transformation, data) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: field.label,
                    data: Object.values(data),
                    backgroundColor: getColor(0).background,
                    borderColor: getColor(0).border,
                    borderWidth: 1
                }]
            },
            options: transformation.chart_options
        });
    }

    function createElevationDistributionChart(ctx, elevationData, chartConfig) {
        const altitudes = elevationData.altitudes.reverse();
        const forestData = elevationData.forest.reverse();
        const nonForestData = elevationData.non_forest.reverse();

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: altitudes,
                datasets: [
                    {
                        label: 'Forest',
                        data: forestData,
                        backgroundColor: '#4CAF50',
                        stack: 'Stack 0',
                    },
                    {
                        label: 'Non-Forest',
                        data: nonForestData,
                        backgroundColor: '#FFF59D',
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Area (ha)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString(); // Format les grands nombres
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Elevation (m)'
                        },
                        reverse: false
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                layout: {
                    padding: {
                        left: 10,
                        right: 10,
                        top: 0,
                        bottom: 10
                    }
                }
            }
        });
    }

    function createForestFragmentationChart(ctx, fragmentationData, chartConfig) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(fragmentationData),
                datasets: [{
                    label: 'Cumulative Area (%)',
                    data: Object.values(fragmentationData),
                    borderColor: '#4BC0C0',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.x_label
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.y_label
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: chartConfig.chart_options.title
                    }
                }
            }
        });
    }

    function createGauge(options) {
        new JustGage({
            id: options.id,
            value: options.value || 0,
            min: options.min || 0,
            max: options.max,
            title: options.title,
            label: options.label,
            pointer: true,
            pointerOptions: {
                toplength: 10,
                bottomlength: 10,
                bottomwidth: 2,
                color: '#8e8e93',
                stroke: '#ffffff',
                stroke_width: 3,
                stroke_linecap: 'round'
            },
            gaugeWidthScale: 0.6,
            counter: true,
            donut: true,
            relativeGaugeSize: true,
            donutStartAngle: 270,
            hideInnerShadow: true,
            customSectors: [{
                color: "#ff0000",
                lo: 0,
                hi: options.max * 0.33
            }, {
                color: "#ffff00",
                lo: options.max * 0.33,
                hi: options.max * 0.66
            }, {
                color: "#00ff00",
                lo: options.max * 0.66,
                hi: options.max
            }],
            humanFriendly: true,
            formatNumber: true,
            textRenderer: function (val) {
                return parseFloat(val).toFixed(2);
            }
        });
    }

    // Function to get a color based on the index
    function getColor(index) {
        var colors = [
            {background: 'rgba(54, 162, 235, 0.6)', border: 'rgba(54, 162, 235, 1)'},
            {background: 'rgba(75, 192, 192, 0.6)', border: 'rgba(75, 192, 192, 1)'},
            {background: 'rgba(255, 99, 132, 0.6)', border: 'rgba(255, 99, 132, 1)'}
        ];
        return colors[index % colors.length];
    }

// Rest of the code (loadShapeTypeList, initShapeMaps, loadAllShapesMap) remains the same...

    let maps = {};  // Object to keep track of initialized maps

    function initMap(field_key, geometry) {
        const mapId = field_key + 'Map';
        const mapLoaderId = field_key + 'MapLoader';

        // Check if the map already exists
        if (maps[mapId]) {
            return; // Map is already initialized, so do nothing
        }

        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        map.on('load', function () {
            document.getElementById(mapLoaderId).style.display = 'none';
        });

        if (geometry) {
            const geoJsonLayer = L.geoJSON(geometry, {
                style: function() {
                    return {
                        color: '#228b22', // Border color
                        weight: 2,       // Border width
                        fillColor: '#228b22cc', // Fill color with opacity
                        fillOpacity: 0.8 // Fill opacity
                    };
                }
            }).addTo(map);
            map.fitBounds(geoJsonLayer.getBounds());
        } else {
            console.warn("No geographic coordinates found.");
            // Set default view if no geometry is found
            map.setView([-21.291237, 165.516418], 10);
        }

        // Store the map instance in the maps object
        maps[mapId] = map;
    }

    function initShapeMaps(mapping, shape) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            field.transformations.forEach(function(transformation) {
                if (transformation.chart_type === 'map') {
                    var coordinatesField = transformation.chart_options.coordinates_field;
                    var geometry = shape[coordinatesField];

                    // Check if geometry is a string, if so, parse it as JSON
                    if (typeof geometry === 'string') {
                        try {
                            geometry = JSON.parse(geometry);
                        } catch (e) {
                            console.error("Invalid JSON for field", coordinatesField, ":", geometry);
                            return; // Skip this field if JSON is invalid
                        }
                    }

                    // Initialize the map with the parsed geometry
                    initMap(field_key, geometry);
                }
            });
        });
    }

    function loadAllShapesMap(currentShape) {
        const mapId = 'allShapesMap';
        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        var group = L.featureGroup(); // Create a group to hold all the layers

        shapeTypes.forEach(function(shapeTypeItem) {
            if (shapeTypeItem.type === currentShape.type) {
                shapeTypeItem.shapes.forEach(function(shapeItem) {
                    var geometry = shapeItem.geometry;
                    // No need to parse geometry if it's already GeoJSON
                    var layer = L.geoJSON(geometry, {
                        style: function() {
                            return {
                                color: '#228b22', // Border color
                                weight: 2,       // Border width
                                fillColor: '#228b22cc', // Fill color with opacity
                                fillOpacity: 0.8 // Fill opacity
                            };
                        }
                    }).addTo(map);
                    group.addLayer(layer); // Add each layer to the group

                    // Highlight current shape
                    if (shapeItem.id === currentShape.id) {
                        layer.setStyle({color: 'red', weight: 3, fillOpacity: 0.4});
                        layer.bringToFront(); // Ensure the highlighted shape is on top
                    } else {
                        layer.setStyle({fillOpacity: 0.2}); // Reduce opacity for other shapes
                    }

                    // Show tooltip on hover with additional content
                    var tooltipContent = "<strong>" + shapeItem.name + "</strong><br>";

                    


                    layer.bindTooltip(tooltipContent, {
                        permanent: false,
                        direction: 'right',
                        offset: L.point(10, 0),
                        opacity: 0.9,
                        className: 'custom-tooltip'
                    });


                    layer.on('mousemove', function(e) {
                        var tooltip = e.target.getTooltip();
                        tooltip.setLatLng(e.latlng);
                    });

                    layer.on('click', function() {
                        window.location.href = '../shape/' + shapeItem.id + '.html';
                    });
                });
            }
        });

        map.fitBounds(group.getBounds()); // Adjust the view to fit the bounds of the group

        map.attributionControl.setPrefix(false);
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        maps['allShapesMap'] = map;
    }

    function loadShapeTypeList() {
            var shapeTypeListElement = document.getElementById("shape-type-list");
            shapeTypes.forEach(function (shapeTypeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "javascript:void(0)";
                a.textContent = shapeTypeItem.type;
                a.className = "shape-type-link";
                if (shapeTypeItem.type === currentShapeType) {
                    a.classList.add("active");
                }
                a.onclick = function () {
                    if (shapeTypeItem.shapes.length > 0) {
                        // Redirect to the first shape of the selected type
                        window.location.href = "../shape/" + shapeTypeItem.shapes[0].id + ".html";
                    }
                    loadShapeList(shapeTypeItem.shapes);
                };
                li.appendChild(a);
                shapeTypeListElement.appendChild(li);
            });
        }

        function loadShapeList(shapes) {
            var shapeListElement = document.getElementById("shape-list");
            shapeListElement.innerHTML = ''; // Clear the previous list
            shapes.forEach(function (shapeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "../shape/" + shapeItem.id + ".html";
                a.textContent = shapeItem.name;
                a.className = "shape-link";
                if (shapeItem.id === shape.id) {
                    a.classList.add("active");
                }
                li.appendChild(a);
                shapeListElement.appendChild(li);
            });
        }

</script>

</body>
</html>