<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Niamoto - 69.0</title>
    <link rel="stylesheet" href="../js/vendor/tailwindcss/2.2.19_dist_tailwind.css">
    <link rel="stylesheet" href="../js/vendor/leaflet/1.9.4_leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
<script src="../js/shape_list.js"></script>

<style>
    #shape-type-list li, #shape-list li {
        list-style: none;
        text-transform: capitalize;
    }

    .shape-type-link, .shape-link {
        display: block;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
    }

    .shape-type-link:hover, .shape-link:hover {
        background-color: #f0f0f0;
    }

    .shape-type-link.active, .shape-link.active {
        background-color: #3498db;
        color: #fff;
    }

    #shapeMap, #allShapesMap {
        position: relative;
        height: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #allShapesMap {
        height: 400px;
    }

    .chart-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .chart-container > div {
        flex: 1 1 calc(33.333% - 10px);
        margin: 5px;
    }
    .custom-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    padding: 5px;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    font-size: 12px;
    max-width: 300px;
    word-wrap: break-word;
}
</style>

    <style>
        .gauge {
            height: 349px;
        }

        ul {
            list-style-type: none;
        }

        .loader-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bg p-4 fixed w-full top-0 shadow-md z-50 custom-nav">
    <div class="container mx-auto flex flex-wrap items-center justify-between">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <a id="home-link" class="inline-flex items-center py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                <span class="site-title">Niamoto</span>
            </a>
        </div>

        <div class="block lg:hidden">
            <button id="nav-toggle"
                class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
                <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0zm0 6h20v2H0zm0 6h20v2H0z" />
                </svg>
            </button>
        </div>
        <div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block pt-6 lg:pt-0" id="nav-content">
            <ul class="list-reset lg:flex justify-end flex-1 items-center">
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                        <i class="fas fa-home menu-icon"></i>Accueil
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#introduction">Introduction</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#project">Projet</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#objective">Objectifs</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#context">Contexte</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#flora">Flore</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="methodology.html">
                        <i class="fas fa-flask menu-icon"></i>Méthodologie
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#methodes">Nos méthodes</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#faq">FAQ</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="trees.html">
                        <i class="fas fa-leaf menu-icon"></i>Arbres
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#learnTaxon">Étudier les
                arbres</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#taxon">Les arbres de
                Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="plots.html">
                        <i class="fas fa-map-marked-alt menu-icon"></i>Peuplements
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#learnPlot">Étudier les
                            peuplements forestiers</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#plot">Les
                peuplements forestiers de Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="forests.html">
                        <i class="fas fa-tree menu-icon"></i>Forêt
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#learnForest">Étudier les
                forêts</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPN">La forêt de la
                province Nord</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPS">La forêt de la
                province Sud</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="resources.html">
                        <i class="fas fa-book menu-icon"></i>Ressources
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#equipe">L'équipe</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#article">Articles</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#academic">Académique</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#media-production">Médias</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
  document.getElementById('nav-toggle').onclick = function () {
    document.getElementById('nav-content').classList.toggle('hidden');
  };

  // Function to adjust the navigation links based on page depth
  function adjustNavLinks(depth) {
    document.querySelectorAll('a[data-link]').forEach(link => {
      link.href = depth + link.getAttribute('data-link');
    });
  }

  // Adjust the navigation links based on the depth
  adjustNavLinks("../");
</script>

<style>
    .site-title {
        font-family: 'Arial Black', sans-serif; /* Custom font for a bold effect */
        font-size: 2rem; /* Increased font size */
        text-transform: uppercase; /* Uppercase letters for visibility */
        letter-spacing: 2px; /* Spacing between letters */
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7); /* Text shadow for better visibility */
        transition: color 0.3s; /* Smooth transition for hover effect */
    }

    .site-title:hover {
        color: #ffdd57; /* Change color on hover */
    }

    .text-contour {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .nav-bg {
        background-color: rgba(34, 139, 34, 0.8); /* Fond vert semi-transparent */
        transition: background-color 0.3s;
    }

    .nav-bg:hover {
        background-color: rgba(34, 139, 34, 1); /* Fond vert opaque au survol */
    }

    .group:hover .group-hover\:block {
        display: block;
    }

    .custom-nav {
        z-index: 500;
    }

    .custom-dropdown {
        z-index: 500;
    }

    .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.2); /* Fond blanc transparent au survol */
        border-radius: 4px;
    }

    .menu-icon {
        margin-right: 8px;
    }
</style>
    <div class="flex">
        
<aside class="w-1/4 p-4 mt-28">
    <h2 class="font-semibold text-lg mb-4">Shape Types</h2>
    <ul id="shape-type-list" class="list-disc pl-5">
        <!-- The list of shape types will be generated by JavaScript -->
    </ul>
</aside>

        <div class="w-full">
            
<div id="allShapesMap" class="mt-28"></div>

<div class="rounded overflow-hidden shadow-lg mb-2 mt-8">
    <div class="px-6 py-4">
        <div class="font-bold text-4xl mb-2">69.0</div>
    </div>
</div>

<div class="chart-container">
    <!-- Section for general information -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">General Information</h2>
            
                
                    
                        
                        
                            <p>Shape Area (Total Area): 6343.564773400493</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Forest Area (Forest Area): 5959.789194009042</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Number of Families (Number of Families): 73</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Species (Number of Species): 335</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Occurrences (Number of Occurrences): 3443</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Average Rainfall (Average Rainfall): 2743.823486328125</p>
                        
                    
                
                    
                        
                        
                            <p>Average Rainfall (Rainfall Range): {"min": 2300.0, "max": 3150.0}</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Altitude (Median Altitude): 320.0</p>
                        
                    
                
                    
                        
                        
                            <p>Altitude (Maximum Altitude): 692.0</p>
                        
                    
                
                    
                
            
                
                    
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        </div>
    </div>

    <!-- Section for shape map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Shape Map</h2>
            <div id="shapeMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="shapeMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Section for forest map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Forest Map</h2>
            <div id="forestMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="forestMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>
</div>

<div class="flex flex-wrap -mx-2">
    

    

    
    
        
    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
    
        
            
            

            
            
                
            
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Elevation Distribution</h2>
        
    
    
        <canvas id="elevationDistributionChart"></canvas>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Forest Fragment Distribution</h2>
        
    
    
        <canvas id="forestFragmentationChart"></canvas>
    
    
                        </div>
                    </div>
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Fragmentation</h2>
        
    
    
        <div class="gauge" id="forest_fragmentationeffective_mesh_sizeGauge"></div>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
</div>

        </div>
    </div>
    <footer class="bg-green-700 text-white p-4 mt-8">
        <div class="container mx-auto">
            <div class="flex justify-center mb-4">
                <div class="bg-white p-2 rounded-lg shadow-md flex justify-center">
                    <figure class="mx-2"><img class="img-fluid" src="../files/ps_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/pn_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/amap_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/herbarium_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/iac_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/ird_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/cirad_100.png"></figure>
                </div>
            </div>
            <div class="text-center">
                <p>Niamoto - Portail de la forêt de Nouvelle-Calédonie</p>
                <a class="inline-block py-2 px-4 text-white no-underline" href="https://github.com/niamoto/niamoto" target="_blank">
                    <span class="fab fa-github fa-lg" aria-hidden="true"></span> Github
                </a>
            </div>
        </div>
    </footer>
    <script src="../js/vendor/chart/4.4.2_chart.js"></script>
    <script src="../js/vendor/d3/7.8.5_d3.js"></script>
    <script src="../js/vendor/jquery/3.6.0_jquery.js"></script>
    <script src="../js/vendor/raphael/2.3.0_raphael.js"></script>
    <script src="../js/vendor/justgage/1.6.1_justgage.js"></script>
    <script src="../js/vendor/leaflet/1.9.4_leaflet.js"></script>
    
<script>
    var shape = {"elevation_elevation_distribution": {"altitudes": [24.0, 124.0, 224.0, 324.0, 424.0, 524.0, 624.0], "forest": [306.71355501890577, 1006.8205827794516, 1662.4763706821848, 1605.801039863474, 982.3724008576547, 337.82942291937445, 31.1158679004687], "non_forest": [48.896363843593676, 115.57322363031231, 100.01528968007797, 95.57016569429672, 43.33995886136712, 13.335371957343728, 0.0]}, "elevation_max": 692.0, "elevation_median": 320.0, "forest_area": "5959.789194009042", "forest_coordinates": "{\"type\": \"MultiPolygon\", \"coordinates\": [[[[165.25632436895674, -21.048557278467307], [165.25646189297407, -21.04816231111642], [165.25723518467345, -21.048929032249696], [165.25648678286615, -21.04892778182121], [165.25632436895674, -21.048557278467307]]], [[[165.2298843394813, -21.032796830445243], [165.23030681719723, -21.033318378524715], [165.23024748843272, -21.033549896338993], [165.2296263817585, -21.03254202645542], [165.2298843394813, -21.032796830445243]]], [[[165.2225186533265, -21.026846726724635], [165.2253728170673, -21.0270609968058], [165.22598554359885, -21.028138849724893], [165.22541548587412, -21.02716365306705], [165.2225186533265, -21.026846726724635]]], [[[165.2546967813476, -21.02426412561609], [165.25364635070147, -21.024644375452414], [165.2519445911582, -21.02290268053006], [165.2527239417879, -21.02264079045127], [165.2546967813476, -21.02426412561609]]], [[[165.25297835002226, -21.019888916397083], [165.25321024670225, -21.019704968786748], [165.25341058524694, -21.019733358384155], [165.25324453643984, -21.019914646309523], [165.25297835002226, -21.019888916397083]]], [[[165.2070488541182, -21.016108871729564], [165.20704889342363, -21.01610810007822], [165.2070490758941, -21.016108273166086], [165.2070488541182, -21.016108871729564]]], [[[165.23052581364072, -20.982939114071822], [165.23024464775622, -20.982846611618495], [165.23056186861018, -20.982547825765888], [165.2304705843678, -20.98277853561164], [165.23052581364072, -20.982939114071822]]], [[[165.23943378243519, -20.975726122923582], [165.24011582168046, -20.9781980752074], [165.2393832063809, -20.978491724313358], [165.2384572473222, -20.97534380745602], [165.23943378243519, -20.975726122923582]]], [[[165.2379737148061, -20.975225157286097], [165.23810657379923, -20.975239447117907], [165.2379913527548, -20.975269134142472], [165.2379737148061, -20.975225157286097]]], [[[165.26807943513086, -21.034040428425783], [165.26783738019205, -21.033906083438136], [165.26838387157508, -21.033988466453607], [165.26838439998835, -21.034283531608583], [165.26807943513086, -21.034040428425783]]], [[[165.25785118215686, -21.017841890572154], [165.25850417618375, -21.017596953540423], [165.259010604016, -21.016916378849906], [165.25899989715464, -21.017623083215465], [165.25785118215686, -21.017841890572154]]], [[[165.25974456874798, -21.017316890625466], [165.2600382789695, -21.017216576872435], [165.2594453977647, -21.01746078662437], [165.2594514091226, -21.017403401645883], [165.25974456874798, -21.017316890625466]]], [[[165.26269466265848, -21.008663849211086], [165.26267767526102, -21.00850534549471], [165.26287026795535, -21.008408214039488], [165.26299572052542, -21.008627340087482], [165.26269466265848, -21.008663849211086]]], [[[165.26257911348452, -21.00807488855293], [165.26253629241572, -21.008029124038032], [165.2625194995624, -21.007959204040947], [165.2626539229776, -21.00811582545391], [165.26257911348452, -21.00807488855293]]], [[[165.2740235070183, -20.958819614034816], [165.27547274386905, -20.96047006873267], [165.27710537849583, -20.957895488390893], [165.27588022908998, -20.957444296743155], [165.27991032906706, -20.95695937177709], [165.27981428026584, -20.95531871931412], [165.28197805793278, -20.956506606060415], [165.27995615688715, -20.95507989076426], [165.27989536810782, -20.952938437012907], [165.28110712183891, -20.9506954144894], [165.28336914697593, -20.95214631040516], [165.28318054559804, -20.94807846938348], [165.28804414360147, -20.948165901315615], [165.28727665774858, -20.951245006888108], [165.28982507145466, -20.949489218051706], [165.29054020088273, -20.95072002051479], [165.2931934047614, -20.949539583341775], [165.28984652326645, -20.948970674905272], [165.2905188526972, -20.947074209865598], [165.293104206202, -20.94773693965973], [165.29213040709593, -20.94676929975948], [165.2935868994517, -20.946097311689474], [165.2966228667766, -20.948496494373348], [165.29872244563518, -20.94802018226461], [165.29649612609458, -20.946528136906245], [165.29814675826816, -20.94680108545875], [165.2997229864143, -20.947805907268098], [165.30032153967323, -20.94850761371766], [165.30083591276906, -20.949556764763326], [165.299872, -20.949276999999988], [165.29853, -20.953020000000002], [165.298833, -20.954923999999995], [165.299262, -20.952416000000003], [165.30104587350147, -20.95218601821518], [165.3008759062563, -20.959166939469476], [165.29803470890633, -20.961365517584273], [165.290682, -20.961424999999988], [165.29131857380847, -20.96319192121137], [165.28933, -20.963527000000003], [165.289456, -20.965327999999992], [165.293572, -20.964702], [165.29272947388012, -20.96292585985933], [165.30028505743985, -20.963722281157075], [165.30212927757253, -20.96022233861985], [165.3053724469368, -20.958586578561516], [165.318320668342, -20.960468096099742], [165.3215334824005, -20.963473879095186], [165.321668, -20.970262], [165.32579219966883, -20.969823772354886], [165.324704, -20.970342], [165.325226, -20.971637999999995], [165.32600681640542, -20.969863442338458], [165.3329456311295, -20.970870860585894], [165.33528216299217, -20.97589352450365], [165.3373666781187, -20.9754577565356], [165.33742959621256, -20.97906682339489], [165.33491794677565, -20.98261328256793], [165.32623916539325, -20.98230135111125], [165.3243931146455, -20.984894714521637], [165.323666, -20.983543999999988], [165.32146800000004, -20.983948999999996], [165.3226303753037, -20.986401089733544], [165.3213039287873, -20.987181443860774], [165.31668434545696, -20.9870327101485], [165.3114833814836, -20.989258614426173], [165.30548043941266, -20.98786584681726], [165.302775780929, -20.985579293817384], [165.2952821333281, -20.985796911593976], [165.291569, -20.984011999999996], [165.28336213905376, -20.98565802953498], [165.2824171580688, -20.98530702558217], [165.28163214805338, -20.98481628889144], [165.2810055739521, -20.984229899404827], [165.281918, -20.984992000000005], [165.282962, -20.984295999999993], [165.2740594752953, -20.982194764460672], [165.26795933769498, -20.978898260231606], [165.2690107758348, -20.986986872654107], [165.2671839339491, -20.990300818476793], [165.26295499373623, -20.990758397331167], [165.26689307870913, -20.990574880687085], [165.26505847405602, -20.995448904364032], [165.2630358038638, -20.995038519489004], [165.26350890126926, -20.997135802021077], [165.2622404227535, -20.99777160464949], [165.25659705181542, -20.997443526852816], [165.26201988218182, -21.007457909148204], [165.2609495108491, -21.006592950402187], [165.25873925998224, -21.00788374477777], [165.26328552484506, -21.00920998992388], [165.26100541184704, -21.01177363027318], [165.2635432295482, -21.01149583151706], [165.26334569437302, -21.013607668827795], [165.25930520232197, -21.014127465029127], [165.26085902583458, -21.015140642194005], [165.25784849950236, -21.016281272347094], [165.2561544656274, -21.01545761914648], [165.2554212521211, -21.015487409302022], [165.25818522175325, -21.01665370457218], [165.2574358502693, -21.017918015723627], [165.25544149372482, -21.01660907647786], [165.25566362552996, -21.01787101100474], [165.25097303680025, -21.02123497377438], [165.2513912402785, -21.0257493385065], [165.25578903006848, -21.026907509539768], [165.25662973380707, -21.025380047787934], [165.2547724223948, -21.025623818245066], [165.25496486978733, -21.023798980134693], [165.26402099833038, -21.02362121348594], [165.2690836981024, -21.027664062912855], [165.26930018977384, -21.030478993169645], [165.26626518699706, -21.033139258765427], [165.26838473747645, -21.03447198443673], [165.2681782251444, -21.03722811173142], [165.26291585902842, -21.042509186617284], [165.26226018267968, -21.04677081988084], [165.26131193022698, -21.041851218774948], [165.2603255744886, -21.048575222624017], [165.25878190582054, -21.048923701337678], [165.25953776516195, -21.0478677957905], [165.25855991771937, -21.045224311438115], [165.2582594899143, -21.048583590489017], [165.25662197536914, -21.047461015311807], [165.2579583661461, -21.047101177364574], [165.25522979907277, -21.04632313917086], [165.25442828486817, -21.047951901781982], [165.2533203929627, -21.04842283787395], [165.25259807624838, -21.048043934489108], [165.25196896445664, -21.043270751637614], [165.24793824555084, -21.041044427517875], [165.24801662707424, -21.043576297352853], [165.24615123831424, -21.043936558134114], [165.2438041255224, -21.043356168002457], [165.24526992238452, -21.042446011727865], [165.243678678679, -21.04108275876281], [165.24354156198447, -21.043204766079523], [165.23848243286, -21.04174421157811], [165.24196084558704, -21.04078685897784], [165.23921929429102, -21.038553085869413], [165.2401889442219, -21.041070512917635], [165.23844477218103, -21.03958119963655], [165.2367344497014, -21.040758273028153], [165.23547185355574, -21.039166475146697], [165.23683457657546, -21.037317370768008], [165.23430250412093, -21.03628024884015], [165.2332, -21.033799999999996], [165.23263261590398, -21.036392625292706], [165.23044755909694, -21.033950831025763], [165.23138880233046, -21.033506249683604], [165.2291540515367, -21.030079873141617], [165.2308011682493, -21.029452845756715], [165.23038938907115, -21.027412667101366], [165.22710476165375, -21.02922732856433], [165.22646260416053, -21.02840214402112], [165.22812002814075, -21.027982506118388], [165.2268934173125, -21.025075191200226], [165.22195181880744, -21.0265275833797], [165.22051255640048, -21.026131751348423], [165.22068643684662, -21.024143243389005], [165.21866087706925, -21.026489445243442], [165.2186311161978, -21.022014980823673], [165.21530742268635, -21.01816929515453], [165.2182800854794, -21.026519778243387], [165.21422329654195, -21.026118247751025], [165.2132916379788, -21.023750195517962], [165.21214346686588, -21.024925875021736], [165.20882300954923, -21.023900513608677], [165.20931135018358, -21.02274758541138], [165.20789924532644, -21.023035437879308], [165.20615474143145, -21.01994767329113], [165.2070493310523, -21.01648359591052], [165.20913484295977, -21.017586022271384], [165.20741385314258, -21.014403762128477], [165.20807545660804, -21.011746778647876], [165.20308266749552, -21.012784002340194], [165.20215194855302, -21.01044743182893], [165.20020306971273, -21.0113593594819], [165.19879030198072, -21.01029276662463], [165.20014746499606, -21.012165468252306], [165.1936617988974, -21.010147951836675], [165.19428141076702, -21.007177067780038], [165.19233312961384, -21.00897671084572], [165.19135331901293, -21.00615012459398], [165.1940267391921, -21.00615124999514], [165.1934188543162, -21.004841959493195], [165.1954221140104, -21.004332945132663], [165.19575328046804, -21.002279382810535], [165.193259869041, -21.004421116117562], [165.19316634829084, -21.002429124139592], [165.1902039897099, -21.00500726610888], [165.1873867659322, -21.003504612766204], [165.1881910443834, -21.002055041139048], [165.18596937508488, -21.001564057200802], [165.1860192143482, -20.99745787742342], [165.18927086330245, -20.992182760263134], [165.1960840075661, -20.991733249463103], [165.19770651314232, -20.989200370368305], [165.2007999839673, -20.988167275991835], [165.22068197778682, -20.991144867365932], [165.2219427712316, -20.988930548616278], [165.22297705140986, -20.98807157440285], [165.22340855377826, -20.989236027862482], [165.22537050734564, -20.98483496118953], [165.23004804871502, -20.983053208430444], [165.2296365699006, -20.984707499907778], [165.2318330512589, -20.98285127600589], [165.2309610323515, -20.982190785109655], [165.23365793664803, -20.976161690238435], [165.23632166072386, -20.975148348152878], [165.23872973682245, -20.97861599980255], [165.2417926026536, -20.980005920924228], [165.24036760781712, -20.979021067751702], [165.2411049859357, -20.976112738014283], [165.24458189897055, -20.973055691853514], [165.248285, -20.972882999999996], [165.2503134510681, -20.969112019408865], [165.252861255284, -20.969239845288598], [165.25742483945433, -20.971304356862575], [165.2588775321079, -20.97242043969649], [165.2605695403662, -20.974628419646354], [165.257247, -20.974967000000003], [165.257163, -20.976131999999996], [165.2656238130626, -20.97644613672301], [165.26657822481218, -20.968813905723312], [165.27278967687587, -20.966315242816556], [165.2716108039267, -20.963924387848444], [165.27163106789325, -20.961551972307895], [165.27216144861393, -20.960290880769605], [165.274341, -20.961336], [165.27290235179936, -20.9593505778626], [165.2740235070183, -20.958819614034816]], [[165.282759, -20.980279999999997], [165.283409, -20.981605], [165.2838990455048, -20.981310999999998], [165.283817, -20.980880999999997], [165.282759, -20.980279999999997]], [[165.333718, -20.981774], [165.333988, -20.982352999999996], [165.334728, -20.981970999999998], [165.333296, -20.981304999999995], [165.333718, -20.981774]], [[165.32668, -20.974325999999998], [165.326691, -20.97385], [165.325995, -20.974236000000005], [165.326455, -20.974929000000003], [165.32668, -20.974325999999998]], [[165.325064, -20.972958000000006], [165.325541, -20.97336399999999], [165.326372, -20.973139000000003], [165.325325, -20.972108], [165.325064, -20.972958000000006]], [[165.324509, -20.973533], [165.324838, -20.973003999999996], [165.32397, -20.97258699999999], [165.323946, -20.973144], [165.324509, -20.973533]], [[165.321239, -20.966832], [165.321141, -20.966596999999997], [165.320603, -20.966625999999998], [165.320483, -20.967401], [165.321239, -20.966832]], [[165.32125900000003, -20.973314999999992], [165.32174600000002, -20.972729], [165.321623, -20.972276], [165.323014, -20.971526999999995], [165.32125900000003, -20.973314999999992]], [[165.320852, -20.971697999999993], [165.320455, -20.971686999999996], [165.320218, -20.971992000000004], [165.320701, -20.972219999999997], [165.320852, -20.971697999999993]], [[165.319549, -20.973753999999992], [165.319408, -20.973215], [165.318974, -20.973274], [165.319716, -20.974367999999995], [165.320638, -20.974229], [165.319549, -20.973753999999992]], [[165.31221000000002, -20.966046000000006], [165.310882, -20.965841000000005], [165.31218, -20.966854999999995], [165.315623, -20.966257], [165.31221000000002, -20.966046000000006]], [[165.313573, -20.971511], [165.312259, -20.971099999999996], [165.311177, -20.973983], [165.313056, -20.972504999999998], [165.313573, -20.971511]], [[165.309106, -20.972270999999992], [165.308373, -20.972272], [165.30682200000004, -20.975464999999996], [165.309219, -20.973647999999994], [165.309106, -20.972270999999992]], [[165.305102, -20.974051000000003], [165.304442, -20.974069], [165.304682, -20.974957999999994], [165.305286, -20.974572999999996], [165.305102, -20.974051000000003]], [[165.309095, -20.983249000000004], [165.30902900000004, -20.983731], [165.309137, -20.982980000000005], [165.308233, -20.982769000000005], [165.309095, -20.983249000000004]], [[165.30594, -20.98514], [165.306147, -20.98448], [165.305748, -20.983958999999995], [165.304999, -20.984849], [165.30594, -20.98514]], [[165.298792, -20.94956], [165.29895, -20.94925], [165.298161, -20.948889], [165.298132, -20.94933699999999], [165.298792, -20.94956]], [[165.298951, -20.949874999999995], [165.297338, -20.949453000000002], [165.296868, -20.949654999999996], [165.29825, -20.950438], [165.298951, -20.949874999999995]], [[165.301116, -20.964935], [165.300694, -20.964425], [165.300103, -20.965149], [165.300677, -20.965273999999997], [165.301116, -20.964935]], [[165.295451, -20.949542000000008], [165.294322, -20.949935], [165.296594, -20.949918999999998], [165.295842, -20.94940399999999], [165.295451, -20.949542000000008]], [[165.29637, -20.954250999999996], [165.29739600000002, -20.954221000000004], [165.297956, -20.953324999999996], [165.296423, -20.953247], [165.29637, -20.954250999999996]], [[165.293848, -20.959187], [165.293722, -20.960203], [165.294266, -20.960334], [165.294948, -20.95960999999999], [165.293848, -20.959187]], [[165.296694, -20.975718000000008], [165.297036, -20.975878], [165.2976640066161, -20.975296521091735], [165.297322, -20.975092000000004], [165.296694, -20.975718000000008]], [[165.291842, -20.980080999999995], [165.294536, -20.982745000000005], [165.297136, -20.981885], [165.294277, -20.981706999999997], [165.291842, -20.980080999999995]], [[165.288691, -20.960625999999998], [165.289233, -20.960492000000002], [165.287883, -20.960465000000003], [165.287993, -20.960597000000003], [165.288691, -20.960625999999998]], [[165.287455, -20.979343000000004], [165.287536, -20.980370000000008], [165.288878, -20.979570000000002], [165.288573, -20.979416], [165.287455, -20.979343000000004]], [[165.283462, -20.955034], [165.283384, -20.955366999999992], [165.283946, -20.955825000000004], [165.284152, -20.954481999999995], [165.283462, -20.955034]], [[165.28278980981977, -20.95688295426906], [165.28345420692253, -20.957367168676555], [165.28418378248455, -20.9571844941767], [165.28209923039395, -20.956517901237167], [165.28278980981977, -20.95688295426906]], [[165.290039, -20.982717999999988], [165.289579, -20.981530999999993], [165.28824100000003, -20.981756999999998], [165.288757, -20.982881000000003], [165.290039, -20.982717999999988]], [[165.288971, -20.983443], [165.29023100000003, -20.983877000000003], [165.287113, -20.982584999999993], [165.287056, -20.981603999999997], [165.285065, -20.982220999999996], [165.288971, -20.983443]], [[165.28624752165956, -20.98375685363985], [165.28614481226356, -20.984359473562918], [165.28689052277022, -20.984559035143324], [165.28635120335704, -20.98366487788954], [165.28624752165956, -20.98375685363985]], [[165.284079, -20.98403], [165.2850975607067, -20.984861100395396], [165.285703, -20.983276000000004], [165.28358559514197, -20.982688364096447], [165.284079, -20.98403]], [[165.18867735228415, -21.000914087987347], [165.18960320771052, -21.000109809536145], [165.1897902492108, -20.9984638443337], [165.18681628935636, -21.001624845688408], [165.18867735228415, -21.000914087987347]], [[165.19546695874428, -21.005449844369103], [165.1946907365181, -21.005908096044777], [165.19548098748936, -21.007519950718894], [165.19573086457436, -21.00562408385462], [165.19546695874428, -21.005449844369103]], [[165.197003142595, -21.008757231737953], [165.19580917388862, -21.009780564950137], [165.19818069828258, -21.010904125307157], [165.19730931752193, -21.008152594048113], [165.19855726178855, -21.006840809780762], [165.1969701186522, -21.007338933720085], [165.197003142595, -21.008757231737953]], [[165.19948853209527, -21.005794018918873], [165.19902688144936, -21.003153417593534], [165.19858595646818, -21.00479099300227], [165.19688851055082, -21.004514687395066], [165.19948853209527, -21.005794018918873]], [[165.19994256570266, -20.998652921337314], [165.20016426043563, -20.998152772357663], [165.19970221979904, -20.997638474802965], [165.19974321950298, -21.000280375399278], [165.19994256570266, -20.998652921337314]], [[165.291374, -20.954391999999995], [165.291131, -20.955047], [165.292754, -20.953868000000003], [165.291629, -20.953439000000003], [165.291374, -20.954391999999995]], [[165.21135091258, -21.022795267453887], [165.2117466790229, -21.021776352576484], [165.21031134589026, -21.022280172569005], [165.21079380268827, -21.023154558265446], [165.21135091258, -21.022795267453887]], [[165.2071013744696, -21.009727998130103], [165.21051693079647, -21.014004057073517], [165.21227925357852, -21.01373082169353], [165.20853699591987, -21.009520890214745], [165.2071013744696, -21.009727998130103]], [[165.2142980007608, -21.01248910586361], [165.2144944783924, -21.01304111444764], [165.21516811598647, -21.013087894836122], [165.21496228227716, -21.012114862755794], [165.2142980007608, -21.01248910586361]], [[165.23199735341518, -21.03184152233141], [165.2311700627102, -21.03235329855349], [165.23177376773364, -21.033477037473087], [165.2331651991307, -21.032230080411942], [165.23199735341518, -21.03184152233141]], [[165.23312417607252, -20.984192115472872], [165.232683389948, -20.98359887521724], [165.23120208360788, -20.984206925599157], [165.2312737056792, -20.98436565089845], [165.23312417607252, -20.984192115472872]], [[165.23272025923904, -20.979791918110365], [165.23243582453105, -20.980216252357952], [165.23386936420394, -20.98017476492338], [165.233128953435, -20.979395463970874], [165.23272025923904, -20.979791918110365]], [[165.24069464758705, -21.03629613686276], [165.24028500139354, -21.03618196482172], [165.23997083541033, -21.03653813818264], [165.24058621439326, -21.036738918398072], [165.24069464758705, -21.03629613686276]], [[165.24334318439284, -21.02835845129192], [165.24335909068728, -21.02869292401903], [165.24406227411188, -21.02894436978037], [165.24415321136007, -21.028496708118528], [165.24334318439284, -21.02835845129192]], [[165.24619904377084, -21.02327114022686], [165.24552010143873, -21.02288196598396], [165.24482277373792, -21.022950734916808], [165.24582077349135, -21.02363889252889], [165.24619904377084, -21.02327114022686]], [[165.24442248317186, -21.018689372899534], [165.241134395487, -21.017129124687774], [165.24662378653093, -21.022101479074717], [165.2474647471053, -21.020688812477754], [165.2459987066703, -21.02101798101791], [165.24528110265913, -21.019401018524864], [165.24973888315265, -21.017581456607605], [165.24442248317186, -21.018689372899534]], [[165.24922341614732, -21.02546564987567], [165.24992055951694, -21.025762981035026], [165.25012212489457, -21.025705308949227], [165.24919171722846, -21.024777186792782], [165.24850789522375, -21.025139654778563], [165.24922341614732, -21.02546564987567]], [[165.25013694017463, -21.023596726729778], [165.25017050024599, -21.025398277337366], [165.25094173099302, -21.025638368989636], [165.2507175672076, -21.023653247699098], [165.25013694017463, -21.023596726729778]], [[165.2510244194965, -21.033558720891307], [165.25233174596713, -21.03326990717901], [165.25255683727224, -21.032661390253956], [165.25050933901656, -21.032156922701294], [165.2510244194965, -21.033558720891307]], [[165.23957010892954, -21.012555056641492], [165.2403872112647, -21.013485392263117], [165.2403834122577, -21.010531745280232], [165.24011871223496, -21.010573415451738], [165.23957010892954, -21.012555056641492]], [[165.25333679993582, -21.014390357245198], [165.25215011367052, -21.013646233712915], [165.2511852296842, -21.013986178348393], [165.2520790345475, -21.014983196497038], [165.25333679993582, -21.014390357245198]], [[165.24892415412788, -20.997287368994336], [165.2496574425498, -20.99735514657557], [165.24942391737525, -20.996540749865137], [165.2490696849599, -20.99662159476459], [165.24892415412788, -20.997287368994336]], [[165.2446330506674, -20.979832606852213], [165.24374193519608, -20.980333056140566], [165.24360835350623, -20.980838156963966], [165.24410935697097, -20.980871865558726], [165.2446330506674, -20.979832606852213]], [[165.24541716786356, -20.977410207034918], [165.24435609007955, -20.978570729672832], [165.24498053847896, -20.979384573904632], [165.2463438046483, -20.976232659330634], [165.24513397483977, -20.976073750777946], [165.24541716786356, -20.977410207034918]], [[165.251308, -20.977815999999997], [165.252531, -20.978679999999997], [165.253411, -20.976936000000002], [165.252824, -20.976499999999998], [165.251308, -20.977815999999997]], [[165.252958, -20.973048], [165.253381, -20.973626999999997], [165.25390000000002, -20.97362000000001], [165.25361, -20.972174999999996], [165.252958, -20.973048]], [[165.25295762777574, -21.018471764417306], [165.2542040628879, -21.018389580457114], [165.25410545672756, -21.017896295668578], [165.2534761695339, -21.017960347786648], [165.25295762777574, -21.018471764417306]], [[165.26420767677192, -21.037730039866812], [165.26416019138892, -21.038527635288997], [165.2652848515815, -21.038611947450573], [165.26474482308618, -21.037356262452217], [165.26420767677192, -21.037730039866812]], [[165.26481747316458, -21.03350911048575], [165.26505556841764, -21.03337103785438], [165.26557450597772, -21.033336913739117], [165.26484078264102, -21.032866466484673], [165.26481747316458, -21.03350911048575]], [[165.254658883371, -21.01634058321109], [165.2540898754206, -21.014515461247722], [165.25208566567687, -21.01529301627203], [165.25271614684533, -21.016593064741954], [165.254658883371, -21.01634058321109]], [[165.25271397221, -21.01283926637173], [165.25216998138018, -21.012742534397457], [165.25398462402836, -21.013913328292844], [165.25492148888145, -21.013811363251232], [165.25271397221, -21.01283926637173]], [[165.25758803090048, -21.003627432684628], [165.25814046273643, -21.001543850112277], [165.25691126345322, -21.000903577246277], [165.2567501412662, -21.003152478407287], [165.25758803090048, -21.003627432684628]], [[165.253327, -20.979906999999997], [165.253755, -20.979878], [165.253392, -20.978747999999996], [165.253223, -20.979717999999995], [165.253327, -20.979906999999997]], [[165.256168, -20.971098], [165.254153, -20.971238999999997], [165.254032, -20.97221499999999], [165.256487, -20.971688999999998], [165.256168, -20.971098]], [[165.265302, -20.986254999999993], [165.265607, -20.986535000000007], [165.264719, -20.985223], [165.264763, -20.985705], [165.265302, -20.986254999999993]], [[165.272572, -20.963019999999997], [165.27281, -20.965945999999995], [165.274149, -20.967063000000003], [165.274911, -20.965729999999994], [165.272572, -20.963019999999997]], [[165.278026, -20.959017999999997], [165.277304, -20.958226999999997], [165.277545, -20.959976999999995], [165.278946, -20.961346], [165.278026, -20.959017999999997]], [[165.2829, -20.955052], [165.281806, -20.954537], [165.2803, -20.952617999999998], [165.281142, -20.955180999999996], [165.2829, -20.955052]]], [[[165.292647, -20.963268999999997], [165.292777, -20.964272999999995], [165.291696, -20.964475000000007], [165.29150308742948, -20.963131491021063], [165.292647, -20.963268999999997]]], [[[165.30054, -20.950181999999995], [165.30015, -20.950481000000003], [165.30089933560396, -20.94976646987867], [165.3010387716327, -20.95037591295441], [165.30054, -20.950181999999995]]]]}", "forest_cover_percentage": null, "forest_fragmentation_effective_mesh_size": 59.59789194009041, "forest_fragmentation_fragment_size_distribution": {"10": 0.0, "100": 0.0, "1000": 0.0, "1100": 0.0, "1200": 0.0, "12000": 100.0, "125": 0.0, "1300": 0.0, "1400": 0.0, "150": 0.0, "1500": 0.0, "1600": 0.0, "1700": 0.0, "17000": 100.0, "175": 0.0, "1800": 0.0, "1900": 0.0, "20": 0.0, "200": 0.0, "2000": 0.0, "225": 0.0, "250": 0.0, "27000": 100.0, "275": 0.0, "30": 0.0, "300": 0.0, "325": 0.0, "350": 0.0, "375": 0.0, "40": 0.0, "400": 0.0, "425": 0.0, "450": 0.0, "475": 0.0, "50": 0.0, "500": 0.0, "500000": 100.0, "60": 0.0, "600": 0.0, "70": 0.0, "700": 0.0, "7000": 100.0, "80": 0.0, "800": 0.0, "90": 0.0, "900": 0.0}, "forest_humidity_category_distribution": null, "frequencies": {}, "id": 171, "land_use_category_distribution": null, "name": "69.0", "num_families_unique_taxonomic_count": 73, "num_occurrences_count": 3443, "num_species_unique_taxonomic_count": 335, "rainfall_mean": "2743.823486328125", "rainfall_range": "{\"min\": 2300.0, \"max\": 3150.0}", "shape_area": "6343.564773400493", "shape_coordinates": "{\"type\": \"FeatureCollection\", \"features\": [{\"id\": \"0\", \"type\": \"Feature\", \"properties\": {}, \"geometry\": {\"type\": \"Polygon\", \"coordinates\": [[[165.18673217332466, -20.99614178335586], [165.18927086330245, -20.992182760263134], [165.1960840075661, -20.991733249463103], [165.20028547147587, -20.988193616209653], [165.22068197778682, -20.991144867365932], [165.22537050734564, -20.98483496118953], [165.23160580911596, -20.981784895299988], [165.23365793664803, -20.976161690238435], [165.2370658276536, -20.975127508234213], [165.2421204811777, -20.97635169715051], [165.25008901323466, -20.969133236551354], [165.25690761456764, -20.971048724183397], [165.26199224454516, -20.975995849524175], [165.2656238130626, -20.97644613672301], [165.26657822481218, -20.968813905723312], [165.27278967687587, -20.966315242816556], [165.2719392848184, -20.960654386101787], [165.27626121861073, -20.95724469124587], [165.27991032906706, -20.95695937177709], [165.27989536810782, -20.952938437012907], [165.28245749268874, -20.94862663099161], [165.28581674364972, -20.9473340040125], [165.28964454687915, -20.94825770745924], [165.29359687763147, -20.945691961150988], [165.30032153967323, -20.94850761371766], [165.3014172803193, -20.957479129209613], [165.2989051271431, -20.961025072864572], [165.2905460556451, -20.96157695768805], [165.29120661969955, -20.963162516166047], [165.30028505743985, -20.963722281157075], [165.30212927757253, -20.96022233861985], [165.3053724469368, -20.958586578561516], [165.318320668342, -20.960468096099742], [165.3215334824005, -20.963473879095186], [165.32175896136525, -20.970081101295396], [165.33318469145888, -20.970933423804656], [165.3373564442921, -20.9753621338733], [165.33724758091958, -20.979935805527195], [165.33491794677565, -20.98261328256793], [165.32623916539325, -20.98230135111125], [165.32211870693024, -20.986782914393398], [165.31668434545696, -20.9870327101485], [165.3128019082098, -20.98923444368881], [165.3063523751312, -20.98820320066174], [165.302775780929, -20.985579293817384], [165.2952821333281, -20.985796911593976], [165.28944204712596, -20.984025036034655], [165.2832890286444, -20.985644498368], [165.28031941845097, -20.983186090170577], [165.2740594752953, -20.982194764460672], [165.26795933769498, -20.978898260231606], [165.26919319471483, -20.986117959318587], [165.26505847405602, -20.995448904364032], [165.2622404227535, -20.99777160464949], [165.25659705181542, -20.997443526852816], [165.26322197454127, -21.009022534449127], [165.26334569437302, -21.013607668827795], [165.26038189713844, -21.017062703655167], [165.25444399232268, -21.017536271281056], [165.25097303680025, -21.02123497377438], [165.25379846829767, -21.02420644977523], [165.26494643564138, -21.023792554107583], [165.2690836981024, -21.027664062912855], [165.26781868630474, -21.038046900673127], [165.26341649760002, -21.042736330236593], [165.26177513396345, -21.047454722928006], [165.25852957056583, -21.049089662068205], [165.25244843795332, -21.047961392203707], [165.249362261565, -21.043795730610068], [165.2452943318987, -21.04386561816674], [165.2367344497014, -21.040758273028153], [165.22541548587412, -21.02716365306705], [165.2150952557806, -21.026456067409647], [165.20882300954923, -21.023900513608677], [165.20613051681053, -21.019179720006594], [165.20884888955248, -21.012548577630806], [165.20308266749552, -21.012784002340194], [165.19286495695687, -21.009559306788198], [165.1914844443669, -21.005027584973114], [165.18638655710214, -21.002641137240964], [165.18673217332466, -20.99614178335586]]]}, \"bbox\": [165.18638655710214, -21.049089662068205, 165.3373564442921, -20.945691961150988]}], \"bbox\": [165.18638655710214, -21.049089662068205, 165.3373564442921, -20.945691961150988]}", "shape_id": 171, "type": "hotspots"};
    var mapping = {"fields": {"elevation": {"data_source": {"name": "elevation", "type": "layer"}, "description": "Altitude metrics within the shape", "field_type": "JSON", "label": "Altitude", "transformations": [{"chart_options": {"title": "Median Altitude"}, "chart_type": "text", "name": "median"}, {"chart_options": {"title": "Maximum Altitude"}, "chart_type": "text", "name": "max"}, {"chart_options": {"title": "Elevation Distribution", "x_label": "Elevation (m)", "y_label": "Area (ha)"}, "chart_type": "stacked_bar", "data_structure": {"x_field": "altitudes", "y_fields": [{"color": "#4BC0C0", "label": "For\u00eat", "name": "forest"}, {"color": "#FF6384", "label": "Hors-for\u00eat", "name": "non_forest"}]}, "name": "elevation_distribution"}]}, "forest": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "TEXT", "label": "Forest Area", "transformations": [{"chart_options": {"title": "Forest Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "forest_coordinates", "title": "Forest Location"}, "chart_type": "map", "name": "coordinates"}]}, "forest_cover": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "JSON", "label": "Forest Area", "transformations": [{"chart_options": {"categories": ["UM", "Non-UM", "Commune"], "title": "Forest Cover"}, "chart_type": "donut", "layer_params": {"forest_cover": [{"name": "area"}, {"attribute": "cover_type"}], "soil_types": [{"attribute": "soil_category"}]}, "name": "percentage"}]}, "forest_fragmentation": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Analysis of forest fragmentation", "field_type": "JSON", "label": "Forest Fragmentation", "transformations": [{"chart_options": {"bins": [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 7000, 12000, 17000, 27000, 500000], "title": "Forest Fragment Distribution", "x_label": "Area (ha)", "y_label": "Cumulative Area (%)"}, "chart_type": "line", "data_structure": {"color": "#4BC0C0", "x_field": "keys", "y_field": "values"}, "name": "fragment_size_distribution"}, {"chart_options": {"label": "Effective Mesh Size (km\u00b2)", "max": 1000, "min": 0, "title": "Fragmentation"}, "chart_type": "gauge", "name": "effective_mesh_size"}]}, "forest_humidity": {"data_source": [{"name": "forest_cover", "type": "layer"}, {"name": "holdridge", "type": "shape"}], "description": "Distribution of forests by humidity level", "field_type": "JSON", "label": "Forest and Living Environments", "transformations": [{"chart_options": {"categories": ["Dry", "Humid", "Very Humid"], "title": "Forest and Living Environments", "x_label": "Category", "y_label": "Frequency (%)"}, "chart_type": "stacked_bar", "layer_params": {"forest_cover": [{"name": "area"}], "humidity": [{"name": "value"}]}, "name": "category_distribution"}]}, "land_use": {"data_source": [{"name": "ultramafic", "type": "shape"}, {"name": "holdridge", "type": "shape"}, {"name": "forest_cover", "type": "layer"}], "description": "Land use distribution", "field_type": "JSON", "label": "Land Use", "transformations": [{"chart_options": {"title": "Land Use", "x_label": "Category", "y_label": "Area (ha)"}, "chart_type": "bar", "name": "category_distribution"}]}, "num_families": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of families in the zone", "field_type": "INTEGER", "label": "Number of Families", "transformations": [{"chart_options": {"title": "Number of Families"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["family"]}]}, "num_occurrences": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of occurrences in the zone", "field_type": "INTEGER", "label": "Number of Occurrences", "source_field": "id_occurrence", "transformations": [{"chart_options": {"title": "Number of Occurrences"}, "chart_type": "text", "name": "count"}]}, "num_species": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of species in the zone", "field_type": "INTEGER", "label": "Number of Species", "transformations": [{"chart_options": {"title": "Number of Species"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["species", "infra"]}]}, "rainfall": {"data_source": {"name": "rainfall", "type": "layer"}, "description": "Average annual rainfall within the shape", "field_type": "TEXT", "label": "Average Rainfall", "transformations": [{"chart_options": {"title": "Average Rainfall"}, "chart_type": "text", "name": "mean"}, {"chart_options": {"title": "Rainfall Range"}, "chart_type": "text", "name": "range"}]}, "shape": {"data_source": {"name": "self", "type": "shape"}, "description": "Total area of the reference zone", "field_type": "TEXT", "label": "Shape Area", "transformations": [{"chart_options": {"title": "Total Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "shape_coordinates", "title": "Location"}, "chart_type": "map", "name": "coordinates"}]}}, "group_by": "shape", "source_location_field": "geo_pt", "source_table_name": "occurrences"};
    var currentShapeType = "hotspots";

    document.addEventListener('DOMContentLoaded', function () {
        loadShapeCharts(shape, mapping);
        loadShapeTypeList();
        initShapeMaps(mapping, shape);
        loadAllShapesMap(shape);
    });

    function loadShapeCharts(shape, mapping) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            if (field.field_type !== 'TEXT' && shape[field_key] !== null) {
                // Handle bins chart if present
                if (field.bins && field.bins.values && field.bins.values.length > 0) {
                    var binChartId = field_key + 'BinChart';
                    var binCtx = document.getElementById(binChartId);
                    if (binCtx) {
                        createBinChart(binCtx, field, shape);
                    }
                }

                // Handle transformations
                field.transformations.forEach(function(transformation) {
                    var transformationName = transformation.name ? transformation.name : '';
                    var valueKey = field_key + '_' + transformationName;

                    if (shape[valueKey] !== null) {
                        switch(transformation.chart_type) {
                            case 'pie':
                                var pieChartId = field_key + 'PieChart';
                                var pieCtx = document.getElementById(pieChartId);
                                if (pieCtx) {
                                    createPieChart(pieCtx, transformation, shape[valueKey]);
                                }
                                break;
                            case 'gauge':
                                var gaugeId = field_key + transformationName + 'Gauge';
                                var gaugeElement = document.getElementById(gaugeId);
                                if (gaugeElement) {
                                    createGauge({
                                        id: gaugeId,
                                        value: parseFloat(shape[valueKey]),
                                        min: 0,
                                        max: transformation.chart_options.max,
                                        title: transformation.chart_options.title,
                                        label: transformation.chart_options.label
                                    });
                                }
                                break;
                            case 'bar':
                                var barChartId = field_key + transformationName + 'BarChart';
                                var barCtx = document.getElementById(barChartId);
                                if (barCtx) {
                                    createBarChart(barCtx, field, transformation, shape[valueKey]);
                                }
                                break;
                            case 'stacked_bar':
                                if (field_key === 'elevation' && transformationName === 'elevation_distribution') {
                                    var stackedBarChartId = 'elevationDistributionChart';
                                    var stackedBarCtx = document.getElementById(stackedBarChartId);
                                    if (stackedBarCtx) {
                                        createElevationDistributionChart(stackedBarCtx, shape.elevation_elevation_distribution, transformation);
                                    }
                                }
                                break;
                            case 'line':
                                if (field_key === 'forest_fragmentation' && transformationName === 'fragment_size_distribution') {
                                    var lineChartId = 'forestFragmentationChart';
                                    var lineCtx = document.getElementById(lineChartId);
                                    if (lineCtx) {
                                        createForestFragmentationChart(lineCtx, shape.forest_fragmentation_fragment_size_distribution, transformation);
                                    }
                                }
                                break;
                        }
                    }
                });
            }
        });
    }

    function createBinChart(ctx, field, shape) {
        var binData = {
            labels: field.bins.values,
            datasets: [{
                label: field.label,
                data: field.bins.values.map(value => shape.frequencies[field.field_key][value] || 0),
                backgroundColor: field.bins.chart_options.color
            }]
        };

        new Chart(ctx, {
            type: field.bins.chart_type,
            data: binData,
            options: field.bins.chart_options
        });
    }

    function createPieChart(ctx, transformation, data) {
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['True', 'False'],
                datasets: [{
                    data: [data.true || 0, data.false || 0],
                    backgroundColor: ['#FF6384', '#36A2EB']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: transformation.chart_options.title
                }
            }
        });
    }

    function createBarChart(ctx, field, transformation, data) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: field.label,
                    data: Object.values(data),
                    backgroundColor: getColor(0).background,
                    borderColor: getColor(0).border,
                    borderWidth: 1
                }]
            },
            options: transformation.chart_options
        });
    }

    function createElevationDistributionChart(ctx, elevationData, chartConfig) {
        const altitudes = elevationData.altitudes.reverse();
        const forestData = elevationData.forest.reverse();
        const nonForestData = elevationData.non_forest.reverse();

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: altitudes,
                datasets: [
                    {
                        label: 'Forest',
                        data: forestData,
                        backgroundColor: '#4CAF50',
                        stack: 'Stack 0',
                    },
                    {
                        label: 'Non-Forest',
                        data: nonForestData,
                        backgroundColor: '#FFF59D',
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Area (ha)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString(); // Format les grands nombres
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Elevation (m)'
                        },
                        reverse: false
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                layout: {
                    padding: {
                        left: 10,
                        right: 10,
                        top: 0,
                        bottom: 10
                    }
                }
            }
        });
    }

    function createForestFragmentationChart(ctx, fragmentationData, chartConfig) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(fragmentationData),
                datasets: [{
                    label: 'Cumulative Area (%)',
                    data: Object.values(fragmentationData),
                    borderColor: '#4BC0C0',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.x_label
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.y_label
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: chartConfig.chart_options.title
                    }
                }
            }
        });
    }

    function createGauge(options) {
        new JustGage({
            id: options.id,
            value: options.value || 0,
            min: options.min || 0,
            max: options.max,
            title: options.title,
            label: options.label,
            pointer: true,
            pointerOptions: {
                toplength: 10,
                bottomlength: 10,
                bottomwidth: 2,
                color: '#8e8e93',
                stroke: '#ffffff',
                stroke_width: 3,
                stroke_linecap: 'round'
            },
            gaugeWidthScale: 0.6,
            counter: true,
            donut: true,
            relativeGaugeSize: true,
            donutStartAngle: 270,
            hideInnerShadow: true,
            customSectors: [{
                color: "#ff0000",
                lo: 0,
                hi: options.max * 0.33
            }, {
                color: "#ffff00",
                lo: options.max * 0.33,
                hi: options.max * 0.66
            }, {
                color: "#00ff00",
                lo: options.max * 0.66,
                hi: options.max
            }],
            humanFriendly: true,
            formatNumber: true,
            textRenderer: function (val) {
                return parseFloat(val).toFixed(2);
            }
        });
    }

    // Function to get a color based on the index
    function getColor(index) {
        var colors = [
            {background: 'rgba(54, 162, 235, 0.6)', border: 'rgba(54, 162, 235, 1)'},
            {background: 'rgba(75, 192, 192, 0.6)', border: 'rgba(75, 192, 192, 1)'},
            {background: 'rgba(255, 99, 132, 0.6)', border: 'rgba(255, 99, 132, 1)'}
        ];
        return colors[index % colors.length];
    }

// Rest of the code (loadShapeTypeList, initShapeMaps, loadAllShapesMap) remains the same...

    let maps = {};  // Object to keep track of initialized maps

    function initMap(field_key, geometry) {
        const mapId = field_key + 'Map';
        const mapLoaderId = field_key + 'MapLoader';

        // Check if the map already exists
        if (maps[mapId]) {
            return; // Map is already initialized, so do nothing
        }

        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        map.on('load', function () {
            document.getElementById(mapLoaderId).style.display = 'none';
        });

        if (geometry) {
            const geoJsonLayer = L.geoJSON(geometry, {
                style: function() {
                    return {
                        color: '#228b22', // Border color
                        weight: 2,       // Border width
                        fillColor: '#228b22cc', // Fill color with opacity
                        fillOpacity: 0.8 // Fill opacity
                    };
                }
            }).addTo(map);
            map.fitBounds(geoJsonLayer.getBounds());
        } else {
            console.warn("No geographic coordinates found.");
            // Set default view if no geometry is found
            map.setView([-21.291237, 165.516418], 10);
        }

        // Store the map instance in the maps object
        maps[mapId] = map;
    }

    function initShapeMaps(mapping, shape) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            field.transformations.forEach(function(transformation) {
                if (transformation.chart_type === 'map') {
                    var coordinatesField = transformation.chart_options.coordinates_field;
                    var geometry = shape[coordinatesField];

                    // Check if geometry is a string, if so, parse it as JSON
                    if (typeof geometry === 'string') {
                        try {
                            geometry = JSON.parse(geometry);
                        } catch (e) {
                            console.error("Invalid JSON for field", coordinatesField, ":", geometry);
                            return; // Skip this field if JSON is invalid
                        }
                    }

                    // Initialize the map with the parsed geometry
                    initMap(field_key, geometry);
                }
            });
        });
    }

    function loadAllShapesMap(currentShape) {
        const mapId = 'allShapesMap';
        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        var group = L.featureGroup(); // Create a group to hold all the layers

        shapeTypes.forEach(function(shapeTypeItem) {
            if (shapeTypeItem.type === currentShape.type) {
                shapeTypeItem.shapes.forEach(function(shapeItem) {
                    var geometry = shapeItem.geometry;
                    // No need to parse geometry if it's already GeoJSON
                    var layer = L.geoJSON(geometry, {
                        style: function() {
                            return {
                                color: '#228b22', // Border color
                                weight: 2,       // Border width
                                fillColor: '#228b22cc', // Fill color with opacity
                                fillOpacity: 0.8 // Fill opacity
                            };
                        }
                    }).addTo(map);
                    group.addLayer(layer); // Add each layer to the group

                    // Highlight current shape
                    if (shapeItem.id === currentShape.id) {
                        layer.setStyle({color: 'red', weight: 3, fillOpacity: 0.4});
                        layer.bringToFront(); // Ensure the highlighted shape is on top
                    } else {
                        layer.setStyle({fillOpacity: 0.2}); // Reduce opacity for other shapes
                    }

                    // Show tooltip on hover with additional content
                    var tooltipContent = "<strong>" + shapeItem.name + "</strong><br>";

                    


                    layer.bindTooltip(tooltipContent, {
                        permanent: false,
                        direction: 'right',
                        offset: L.point(10, 0),
                        opacity: 0.9,
                        className: 'custom-tooltip'
                    });


                    layer.on('mousemove', function(e) {
                        var tooltip = e.target.getTooltip();
                        tooltip.setLatLng(e.latlng);
                    });

                    layer.on('click', function() {
                        window.location.href = '../shape/' + shapeItem.id + '.html';
                    });
                });
            }
        });

        map.fitBounds(group.getBounds()); // Adjust the view to fit the bounds of the group

        map.attributionControl.setPrefix(false);
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        maps['allShapesMap'] = map;
    }

    function loadShapeTypeList() {
            var shapeTypeListElement = document.getElementById("shape-type-list");
            shapeTypes.forEach(function (shapeTypeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "javascript:void(0)";
                a.textContent = shapeTypeItem.type;
                a.className = "shape-type-link";
                if (shapeTypeItem.type === currentShapeType) {
                    a.classList.add("active");
                }
                a.onclick = function () {
                    if (shapeTypeItem.shapes.length > 0) {
                        // Redirect to the first shape of the selected type
                        window.location.href = "../shape/" + shapeTypeItem.shapes[0].id + ".html";
                    }
                    loadShapeList(shapeTypeItem.shapes);
                };
                li.appendChild(a);
                shapeTypeListElement.appendChild(li);
            });
        }

        function loadShapeList(shapes) {
            var shapeListElement = document.getElementById("shape-list");
            shapeListElement.innerHTML = ''; // Clear the previous list
            shapes.forEach(function (shapeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "../shape/" + shapeItem.id + ".html";
                a.textContent = shapeItem.name;
                a.className = "shape-link";
                if (shapeItem.id === shape.id) {
                    a.classList.add("active");
                }
                li.appendChild(a);
                shapeListElement.appendChild(li);
            });
        }

</script>

</body>
</html>