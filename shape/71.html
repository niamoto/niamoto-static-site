<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Niamoto - Haute Yaté</title>
    <link rel="stylesheet" href="../js/vendor/tailwindcss/2.2.19_dist_tailwind.css">
    <link rel="stylesheet" href="../js/vendor/leaflet/1.9.4_leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
<script src="../js/shape_list.js"></script>

<style>
    #shape-type-list li, #shape-list li {
        list-style: none;
        text-transform: capitalize;
    }

    .shape-type-link, .shape-link {
        display: block;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
    }

    .shape-type-link:hover, .shape-link:hover {
        background-color: #f0f0f0;
    }

    .shape-type-link.active, .shape-link.active {
        background-color: #3498db;
        color: #fff;
    }

    #shapeMap, #allShapesMap {
        position: relative;
        height: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #allShapesMap {
        height: 400px;
    }

    .chart-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .chart-container > div {
        flex: 1 1 calc(33.333% - 10px);
        margin: 5px;
    }
    .custom-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    padding: 5px;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    font-size: 12px;
    max-width: 300px;
    word-wrap: break-word;
}
</style>

    <style>
        .gauge {
            height: 349px;
        }

        ul {
            list-style-type: none;
        }

        .loader-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bg p-4 fixed w-full top-0 shadow-md z-50 custom-nav">
    <div class="container mx-auto flex flex-wrap items-center justify-between">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <a id="home-link" class="inline-flex items-center py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                <span class="site-title">Niamoto</span>
            </a>
        </div>

        <div class="block lg:hidden">
            <button id="nav-toggle"
                class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
                <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0zm0 6h20v2H0zm0 6h20v2H0z" />
                </svg>
            </button>
        </div>
        <div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block pt-6 lg:pt-0" id="nav-content">
            <ul class="list-reset lg:flex justify-end flex-1 items-center">
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                        <i class="fas fa-home menu-icon"></i>Accueil
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#introduction">Introduction</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#project">Projet</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#objective">Objectifs</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#context">Contexte</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#flora">Flore</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="methodology.html">
                        <i class="fas fa-flask menu-icon"></i>Méthodologie
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#methodes">Nos méthodes</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#faq">FAQ</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="trees.html">
                        <i class="fas fa-leaf menu-icon"></i>Arbres
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#learnTaxon">Étudier les
                arbres</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#taxon">Les arbres de
                Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="plots.html">
                        <i class="fas fa-map-marked-alt menu-icon"></i>Peuplements
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#learnPlot">Étudier les
                            peuplements forestiers</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#plot">Les
                peuplements forestiers de Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="forests.html">
                        <i class="fas fa-tree menu-icon"></i>Forêt
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#learnForest">Étudier les
                forêts</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPN">La forêt de la
                province Nord</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPS">La forêt de la
                province Sud</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="resources.html">
                        <i class="fas fa-book menu-icon"></i>Ressources
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#equipe">L'équipe</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#article">Articles</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#academic">Académique</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#media-production">Médias</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
  document.getElementById('nav-toggle').onclick = function () {
    document.getElementById('nav-content').classList.toggle('hidden');
  };

  // Function to adjust the navigation links based on page depth
  function adjustNavLinks(depth) {
    document.querySelectorAll('a[data-link]').forEach(link => {
      link.href = depth + link.getAttribute('data-link');
    });
  }

  // Adjust the navigation links based on the depth
  adjustNavLinks("../");
</script>

<style>
    .site-title {
        font-family: 'Arial Black', sans-serif; /* Custom font for a bold effect */
        font-size: 2rem; /* Increased font size */
        text-transform: uppercase; /* Uppercase letters for visibility */
        letter-spacing: 2px; /* Spacing between letters */
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7); /* Text shadow for better visibility */
        transition: color 0.3s; /* Smooth transition for hover effect */
    }

    .site-title:hover {
        color: #ffdd57; /* Change color on hover */
    }

    .text-contour {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .nav-bg {
        background-color: rgba(34, 139, 34, 0.8); /* Fond vert semi-transparent */
        transition: background-color 0.3s;
    }

    .nav-bg:hover {
        background-color: rgba(34, 139, 34, 1); /* Fond vert opaque au survol */
    }

    .group:hover .group-hover\:block {
        display: block;
    }

    .custom-nav {
        z-index: 500;
    }

    .custom-dropdown {
        z-index: 500;
    }

    .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.2); /* Fond blanc transparent au survol */
        border-radius: 4px;
    }

    .menu-icon {
        margin-right: 8px;
    }
</style>
    <div class="flex">
        
<aside class="w-1/4 p-4 mt-28">
    <h2 class="font-semibold text-lg mb-4">Shape Types</h2>
    <ul id="shape-type-list" class="list-disc pl-5">
        <!-- The list of shape types will be generated by JavaScript -->
    </ul>
</aside>

        <div class="w-full">
            
<div id="allShapesMap" class="mt-28"></div>

<div class="rounded overflow-hidden shadow-lg mb-2 mt-8">
    <div class="px-6 py-4">
        <div class="font-bold text-4xl mb-2">Haute Yaté</div>
    </div>
</div>

<div class="chart-container">
    <!-- Section for general information -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">General Information</h2>
            
                
                    
                        
                        
                            <p>Shape Area (Total Area): 5541.4732847966425</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Forest Area (Forest Area): 4160.2293497122355</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Number of Families (Number of Families): 78</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Species (Number of Species): 452</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Occurrences (Number of Occurrences): 3826</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Average Rainfall (Average Rainfall): 3129.888916015625</p>
                        
                    
                
                    
                        
                        
                            <p>Average Rainfall (Rainfall Range): {"min": 2495.0, "max": 3930.0}</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Altitude (Median Altitude): 595.0</p>
                        
                    
                
                    
                        
                        
                            <p>Altitude (Maximum Altitude): 1216.0</p>
                        
                    
                
                    
                
            
                
                    
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        </div>
    </div>

    <!-- Section for shape map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Shape Map</h2>
            <div id="shapeMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="shapeMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Section for forest map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Forest Map</h2>
            <div id="forestMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="forestMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>
</div>

<div class="flex flex-wrap -mx-2">
    

    

    
    
        
    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
    
        
            
            

            
            
                
            
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Elevation Distribution</h2>
        
    
    
        <canvas id="elevationDistributionChart"></canvas>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Forest Fragment Distribution</h2>
        
    
    
        <canvas id="forestFragmentationChart"></canvas>
    
    
                        </div>
                    </div>
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Fragmentation</h2>
        
    
    
        <div class="gauge" id="forest_fragmentationeffective_mesh_sizeGauge"></div>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
</div>

        </div>
    </div>
    <footer class="bg-green-700 text-white p-4 mt-8">
        <div class="container mx-auto">
            <div class="flex justify-center mb-4">
                <div class="bg-white p-2 rounded-lg shadow-md flex justify-center">
                    <figure class="mx-2"><img class="img-fluid" src="../files/ps_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/pn_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/amap_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/herbarium_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/iac_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/ird_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/cirad_100.png"></figure>
                </div>
            </div>
            <div class="text-center">
                <p>Niamoto - Portail de la forêt de Nouvelle-Calédonie</p>
                <a class="inline-block py-2 px-4 text-white no-underline" href="https://github.com/niamoto/niamoto" target="_blank">
                    <span class="fab fa-github fa-lg" aria-hidden="true"></span> Github
                </a>
            </div>
        </div>
    </footer>
    <script src="../js/vendor/chart/4.4.2_chart.js"></script>
    <script src="../js/vendor/d3/7.8.5_d3.js"></script>
    <script src="../js/vendor/jquery/3.6.0_jquery.js"></script>
    <script src="../js/vendor/raphael/2.3.0_raphael.js"></script>
    <script src="../js/vendor/justgage/1.6.1_justgage.js"></script>
    <script src="../js/vendor/leaflet/1.9.4_leaflet.js"></script>
    
<script>
    var shape = {"elevation_elevation_distribution": {"altitudes": [178.0, 278.0, 378.0, 478.0, 578.0, 678.0, 778.0, 878.0, 978.0, 1078.0, 1178.0], "forest": [130.01987658410135, 496.7426054110539, 583.4225231337881, 685.6603748067567, 688.9942177960927, 592.3127711053506, 462.29289452124925, 270.0412821362105, 161.13574448457007, 80.01223174406238, 4.445123985781243], "non_forest": [126.68603359476542, 191.14033138859344, 225.59004227839807, 208.9208273317184, 215.58851331039028, 220.03363729617152, 115.57322363031231, 68.89942177960927, 18.89177693957028, 2.2225619928906215, 0.0]}, "elevation_max": 1216.0, "elevation_median": 595.0, "forest_area": "4160.2293497122355", "forest_coordinates": "{\"type\": \"MultiPolygon\", \"coordinates\": [[[[166.59965060321858, -22.148115609047753], [166.60227684922418, -22.14726950633406], [166.6021328841281, -22.149114227804468], [166.60408680021789, -22.14964655039031], [166.59883608141823, -22.152349151452967], [166.59977424173132, -22.150559847337984], [166.59696152505697, -22.149960448622654], [166.59947941143173, -22.149551717926453], [166.59965060321858, -22.148115609047753]]], [[[166.6022184604444, -22.143492416553496], [166.60016512424036, -22.143484811604594], [166.59919169078069, -22.142412513809166], [166.6032263907973, -22.143309852041003], [166.6022184604444, -22.143492416553496]]], [[[166.60498685460976, -22.10844273733557], [166.6049773520585, -22.1086232858096], [166.60496639819758, -22.108645193531444], [166.6049291, -22.1085659], [166.60498685460976, -22.10844273733557]]], [[[166.64945795797792, -22.127821012669862], [166.65227114668465, -22.131432538712247], [166.65325956433836, -22.12866687008505], [166.65524214929576, -22.1296184640025], [166.65473182220762, -22.133960797802267], [166.6461982, -22.1308223], [166.64703236122253, -22.132301734869934], [166.64547102330746, -22.1319172435232], [166.64435617400966, -22.133915797892577], [166.6464021, -22.1339523], [166.6451161, -22.134301], [166.645318959053, -22.13662173139421], [166.64323757957072, -22.13525315310446], [166.64357972414317, -22.13311474952673], [166.63805313889668, -22.134435807736974], [166.63863288386662, -22.13171765918928], [166.6363513260492, -22.12948213644845], [166.63788147260922, -22.128702807144595], [166.63720668748027, -22.12577557024719], [166.63877572857308, -22.124639050696967], [166.63593729035722, -22.125208256221534], [166.63715916740077, -22.123418574303823], [166.63555023060053, -22.121474267980368], [166.63364715117032, -22.12663809827558], [166.63131456082945, -22.12538561182438], [166.63405094826322, -22.12104349704233], [166.63114371933662, -22.12282190030593], [166.6291007473848, -22.120549427089006], [166.6328252747252, -22.119371260277248], [166.62852116532417, -22.11879167821662], [166.6330438056661, -22.118934198395465], [166.63410795633476, -22.116862905129626], [166.6323882128434, -22.118126584048692], [166.63099151509076, -22.116302325759516], [166.62835251644583, -22.117913991448585], [166.63046894110167, -22.115798754460943], [166.6286850635298, -22.113866418369472], [166.63087037293874, -22.11404694392935], [166.63046181509267, -22.111766621067872], [166.62837151913632, -22.110901998649563], [166.62708883752674, -22.112935286534377], [166.62849503662466, -22.11377140491691], [166.62676579178805, -22.113514868594994], [166.6250181956654, -22.11591095965864], [166.62751619799286, -22.119170437691704], [166.62637586202663, -22.11920844889058], [166.62692493932113, -22.12120501991168], [166.62973102133162, -22.122623007756427], [166.63100101643602, -22.125813172360907], [166.628134786956, -22.128410361955517], [166.6317513823533, -22.127429269013906], [166.63048718567387, -22.13117621256927], [166.633766286917, -22.1308530547656], [166.63172278904085, -22.13205063956743], [166.63277250931463, -22.13299001058195], [166.62897251609056, -22.13389342449807], [166.63032560677203, -22.137192650502275], [166.62730061891392, -22.13880493391675], [166.62825359497208, -22.137439771175682], [166.62468290875944, -22.135359210154753], [166.6236880999352, -22.132664134460292], [166.62130335385157, -22.131687671926226], [166.61842504497702, -22.132788856599085], [166.61830499701605, -22.13051569280121], [166.62153952166645, -22.130526255748897], [166.61754635762242, -22.12985755817193], [166.61868692824382, -22.12848189712934], [166.6174222784931, -22.12780678335265], [166.61417983063603, -22.13133449055198], [166.6115744619767, -22.131943043815472], [166.6183743132621, -22.1339626799588], [166.61775020025004, -22.13627713849775], [166.6147656756828, -22.136353177340226], [166.61849675534904, -22.13742953183167], [166.6191908864152, -22.13508089658037], [166.6191908864152, -22.13705869468673], [166.6222245095241, -22.137738152270085], [166.61433196895197, -22.13771479117393], [166.6129110186031, -22.139994140057773], [166.6145982110047, -22.141290041596964], [166.61418672587115, -22.145499706984854], [166.61863754512763, -22.145218739954643], [166.61688992083612, -22.147056150465], [166.61753649010728, -22.14909094199479], [166.62132082201782, -22.148786674102485], [166.62070277786157, -22.151933945113512], [166.62191034105916, -22.153845127812055], [166.6206156816749, -22.154279032450006], [166.62316544611483, -22.154992075140466], [166.62221460895137, -22.15559110255344], [166.62596322767007, -22.160273152285267], [166.62329094358617, -22.160149039066667], [166.6226910036603, -22.157719111436084], [166.62105894457963, -22.16118699774995], [166.621008682153, -22.157291402578295], [166.61977214598778, -22.16021335971428], [166.61848044757136, -22.160057253192047], [166.61992156564074, -22.157207631608085], [166.6174037310399, -22.160379646800088], [166.61808916420844, -22.15704707195998], [166.6139847522438, -22.159068770498465], [166.61509723791045, -22.15663016605448], [166.62000510109286, -22.154080460010007], [166.61910180578752, -22.14991579323408], [166.6164679868448, -22.151189915033108], [166.6155551831679, -22.150277111356193], [166.614674399863, -22.15651401670866], [166.6126342981253, -22.15941358941547], [166.6147374632073, -22.15038170344418], [166.61101018152655, -22.15241649497397], [166.61268365493424, -22.155953609222014], [166.61140953313523, -22.158568411421513], [166.61091509781028, -22.15506933066], [166.60901342348336, -22.156381485945566], [166.6099262271603, -22.15392832606386], [166.607929469117, -22.152644695893194], [166.60815705617168, -22.15042723391605], [166.60686809713337, -22.151981486971685], [166.60724843199876, -22.156516980241353], [166.60555594184783, -22.156535996984623], [166.60617491242908, -22.15326087330851], [166.6051660986108, -22.152590022756293], [166.60379689309542, -22.154624814286084], [166.6030172066214, -22.151401476301977], [166.60804713521605, -22.14966144429286], [166.6092166649271, -22.15057424796978], [166.61698500455248, -22.14893880804864], [166.61493119627943, -22.14607678818665], [166.6108196576546, -22.14714279202729], [166.61050842969408, -22.145442679137147], [166.6072241182431, -22.145121206814505], [166.6076329202888, -22.14359057589916], [166.60394874427715, -22.138264249491982], [166.60613733641574, -22.13563966538943], [166.6054791316404, -22.1389296353021], [166.60921479768865, -22.137408753450398], [166.61118949664603, -22.140391407824612], [166.61380899349118, -22.136811469923426], [166.6119333739986, -22.135754794436668], [166.61189535195228, -22.134091329911367], [166.60940649097557, -22.133483444263693], [166.60996750101535, -22.132599140302677], [166.6070483470795, -22.13329327136885], [166.60677529401178, -22.135529807557088], [166.6052287, -22.134547], [166.60716244731682, -22.132145559310622], [166.6053182066345, -22.132105128450934], [166.604482604589, -22.130245706379675], [166.60608620750594, -22.129025520996215], [166.60681169640898, -22.130880634880256], [166.6087370476712, -22.129956329493634], [166.60695486231208, -22.126743569465315], [166.6086818218504, -22.126152250593552], [166.61110970128325, -22.12796751064771], [166.61010228843145, -22.126231825137843], [166.61329299221933, -22.128419736306665], [166.61472086526734, -22.126581975768573], [166.61082122914448, -22.12410103724798], [166.6064745499512, -22.123040261611916], [166.61131660440157, -22.122379623718963], [166.60489929543442, -22.12238053965324], [166.60607797886948, -22.120593503477487], [166.60329590893116, -22.119695379739635], [166.60339237820838, -22.11633686704304], [166.60580231903387, -22.11417728316561], [166.6057522479639, -22.108882213481696], [166.6073675364168, -22.107646992900058], [166.60469518419688, -22.10750001352798], [166.6036936, -22.1042714], [166.6014251, -22.1045508], [166.59960702557024, -22.101837002246093], [166.60327522510516, -22.10226660448884], [166.60548139166838, -22.099749757561604], [166.60914197829072, -22.09927154411504], [166.60760270341208, -22.099034001695497], [166.60650512901657, -22.096156386265726], [166.6056263504815, -22.098463899888596], [166.60363241447885, -22.098831506681808], [166.60422519684377, -22.095875194631084], [166.5972983760277, -22.0949825566692], [166.59747399863068, -22.091611127132982], [166.59571534788535, -22.090476513748904], [166.59766514707772, -22.08980843249862], [166.59529950188266, -22.08896288060159], [166.5962684719101, -22.08763998028871], [166.59029974434364, -22.08998067630228], [166.5854283960286, -22.089399907424774], [166.58462084646402, -22.08359505114291], [166.58406031206036, -22.085694680010818], [166.58020638775233, -22.086661019779232], [166.5776771, -22.0900018], [166.5746005, -22.0885189], [166.5635583, -22.0905423], [166.5546044, -22.086841], [166.550531, -22.0792346], [166.5469513, -22.0760886], [166.5453824, -22.0711393], [166.550653, -22.0652131], [166.5541619, -22.0635716], [166.55943, -22.0645917], [166.5734162, -22.0608959], [166.5760352, -22.0620186], [166.5827012, -22.0593026], [166.5853167, -22.0559897], [166.59362717845383, -22.059115483906037], [166.60253265687535, -22.054681732922166], [166.6069953, -22.0545318], [166.6120244, -22.0567559], [166.6204146, -22.0539406], [166.6236401, -22.0578994], [166.6166755, -22.0616145], [166.6103028, -22.0676387], [166.6132662, -22.0730821], [166.6249211, -22.0813982], [166.6228476, -22.0835399], [166.6237648, -22.086542], [166.6219789, -22.0872658], [166.6225387, -22.0882722], [166.6253799, -22.0878222], [166.6259739, -22.0913681], [166.6309468, -22.0911035], [166.6306428, -22.0955069], [166.6289343, -22.0954996], [166.628274, -22.0973229], [166.6292929, -22.0993869], [166.63831613441792, -22.104129118004206], [166.63529799982805, -22.10857416906182], [166.6386311949287, -22.109217181688695], [166.63763507498658, -22.10822106174655], [166.64054689650183, -22.10694708529696], [166.63968054265402, -22.1057649797518], [166.63766549086264, -22.107498684689272], [166.63900980662595, -22.10448883679661], [166.64224104719477, -22.10669112281816], [166.64066855032723, -22.106445943454474], [166.64074509831738, -22.108190645870454], [166.64370286614312, -22.107083998603695], [166.64501393589015, -22.10812486387907], [166.64357508031873, -22.10830764240327], [166.6482422, -22.1106878], [166.6477994, -22.1146887], [166.6451657, -22.1179408], [166.6475152, -22.1254335], [166.6503103, -22.1265053], [166.64945795797792, -22.127821012669862]], [[166.62734114940878, -22.13632772814541], [166.62753124223448, -22.135386768658257], [166.62594396714, -22.134559864866517], [166.62586793000972, -22.135253703680277], [166.62734114940878, -22.13632772814541]], [[166.6458654399673, -22.12383883000733], [166.6448295022341, -22.12274586817871], [166.64463942191608, -22.12273636416281], [166.6449435504249, -22.123800813943724], [166.6458654399673, -22.12383883000733]], [[166.62304126444764, -22.12100192865682], [166.6230887711739, -22.121381982467067], [166.62349732901993, -22.120232319691073], [166.6232882994243, -22.120298829107867], [166.62304126444764, -22.12100192865682]], [[166.62325029404326, -22.12250314120729], [166.6235448357462, -22.122417629099985], [166.6235258330557, -22.1215910120627], [166.62333580615058, -22.12169552686052], [166.62325029404326, -22.12250314120729]], [[166.6257586491909, -22.108203616596832], [166.6248275173558, -22.107776056060306], [166.62429544202146, -22.107928077584404], [166.62534058999964, -22.108498158299774], [166.6257586491909, -22.108203616596832]], [[166.63641915856823, -22.10486151840298], [166.63685622045003, -22.10555511660668], [166.63728378098654, -22.105289078939506], [166.6369702365931, -22.104852017057723], [166.63641915856823, -22.10486151840298]], [[166.5748257452748, -22.083538047644232], [166.5751107627682, -22.0841840872959], [166.57591831233276, -22.08384206630384], [166.5753387767629, -22.0832150278184], [166.5748257452748, -22.083538047644232]], [[166.597351627835, -22.090663484978766], [166.59699060567672, -22.09065398439565], [166.59670558818334, -22.09081549430857], [166.59771264999327, -22.09114801471751], [166.597351627835, -22.090663484978766]], [[166.6238867564689, -22.089803682207062], [166.62412427104672, -22.089946190953754], [166.62522633868778, -22.089015133808708], [166.62420977629472, -22.08884412331268], [166.6238867564689, -22.089803682207062]], [[166.62373474713908, -22.092238206629695], [166.62272768532915, -22.09121214365352], [166.6223191602553, -22.09328327077209], [166.62334522323147, -22.093226267273415], [166.62373474713908, -22.092238206629695]], [[166.61979656545336, -22.102027882662266], [166.6201672580895, -22.102778772874007], [166.62084210878615, -22.102788277813396], [166.62067101987714, -22.102379565419664], [166.61979656545336, -22.102027882662266]], [[166.62188599035804, -22.12356766775386], [166.62161990914632, -22.123909772168933], [166.62229461507604, -22.123643690957213], [166.6222756092752, -22.12302600243], [166.62188599035804, -22.12356766775386]], [[166.6082937424498, -22.096108425794018], [166.60741950773345, -22.09644101508828], [166.60726746691324, -22.097153706433133], [166.6082177220397, -22.097077686023017], [166.6082937424498, -22.096108425794018]], [[166.641001772969, -22.11994011350925], [166.6421040886451, -22.11954099921273], [166.64237966756414, -22.1173553733032], [166.6406881831646, -22.1191608903589], [166.641001772969, -22.11994011350925]], [[166.63340202299662, -22.108758923442398], [166.63417690820225, -22.1079142163813], [166.63304496804895, -22.107391478961883], [166.63255876556698, -22.108491512077318], [166.63340202299662, -22.108758923442398]], [[166.63999907570343, -22.117239468788856], [166.6400370869023, -22.116859356800106], [166.63946691891917, -22.117513149420756], [166.63983942866815, -22.11780963677198], [166.63999907570343, -22.117239468788856]], [[166.60431866294283, -22.103522048875956], [166.60463006795257, -22.103096715204106], [166.60402244842135, -22.1020941429776], [166.6036184872276, -22.10385300507474], [166.60431866294283, -22.103522048875956]], [[166.6053798613385, -22.11950532963326], [166.60487052705338, -22.119368493556664], [166.60566873750017, -22.11997665389708], [166.60607924572997, -22.119680175731126], [166.6053798613385, -22.11950532963326]], [[166.61116197791313, -22.108664029158867], [166.61076702521785, -22.10839060036982], [166.61012902471006, -22.10903619612174], [166.61120754937798, -22.108899481727214], [166.61116197791313, -22.108664029158867]], [[166.60992395311825, -22.10817793353389], [166.60886421668584, -22.10806720286932], [166.60813907074532, -22.108322243172555], [166.6091568334601, -22.108610862449883], [166.60992395311825, -22.10817793353389]], [[166.62063796009414, -22.1007934289288], [166.62024278794016, -22.100565444993798], [166.62028838472713, -22.101340590372804], [166.62080514831314, -22.1011658026893], [166.62063796009414, -22.1007934289288]], [[166.6157692534119, -22.09467443035342], [166.61548046200338, -22.09437043939705], [166.61479648235152, -22.09482642583161], [166.61514607195136, -22.095267212718348], [166.6157692534119, -22.09467443035342]], [[166.6398731579417, -22.133133757558532], [166.64075703142052, -22.133181277638037], [166.64320906752303, -22.13226889211154], [166.64121322418382, -22.131461050759953], [166.6398731579417, -22.133133757558532]], [[166.60863496148266, -22.120042183806245], [166.60772127864908, -22.120083081956647], [166.60728796440654, -22.1203795601226], [166.60941441343167, -22.12025130506085], [166.60863496148266, -22.120042183806245]], [[166.61746714166335, -22.126437543680304], [166.61809801445736, -22.126734835679926], [166.61805632148932, -22.12574383194974], [166.61740062136042, -22.125895878356438], [166.61746714166335, -22.126437543680304]], [[166.61959579135714, -22.11375117162137], [166.61856947811194, -22.113931726729323], [166.61879754772198, -22.115290641489196], [166.62031801178895, -22.115167103783744], [166.61959579135714, -22.11375117162137]], [[166.624282896845, -22.105468670721116], [166.6223333196183, -22.104565427035485], [166.62168758194693, -22.10493767581074], [166.62316138322038, -22.10641147708418], [166.624282896845, -22.105468670721116]], [[166.6267066563892, -22.10521203735761], [166.62478665863262, -22.105801343599737], [166.62469697228207, -22.10656011210238], [166.62665099286906, -22.10687330820038], [166.6267066563892, -22.10521203735761]], [[166.6215644841797, -22.102531644449886], [166.62239141390654, -22.103206495146512], [166.62274309666395, -22.103206495146512], [166.62189715705833, -22.10142907148075], [166.6215644841797, -22.102531644449886]], [[166.61805716154515, -22.095032247271885], [166.61803815166635, -22.09435739657526], [166.61482548215284, -22.09614432518041], [166.61757243141767, -22.096535439128893], [166.61805716154515, -22.095032247271885]], [[166.60933542585894, -22.090787586345655], [166.6088353366167, -22.090278253445877], [166.60845827091117, -22.090380558094655], [166.609173915946, -22.091633138242695], [166.60933542585894, -22.090787586345655]], [[166.61154906172422, -22.094540316675207], [166.61431009682133, -22.09567760050945], [166.6139681069954, -22.094780827188153], [166.61635443600295, -22.093048078736828], [166.61154906172422, -22.094540316675207]], [[166.61780574742033, -22.092278984361993], [166.61684640255388, -22.09188954733699], [166.61665333942636, -22.09307099293905], [166.61791972898862, -22.092734910635166], [166.61780574742033, -22.092278984361993]], [[166.62768920378002, -22.100370945101286], [166.6236929448232, -22.099197541383788], [166.62629956114668, -22.097540858122766], [166.6226385423307, -22.0979027389674], [166.62734496872193, -22.093720297595276], [166.62574887075897, -22.093330773687654], [166.62417921678065, -22.094598984199973], [166.62275618707847, -22.09362529176415], [166.62037284512314, -22.096841707388766], [166.6196444864231, -22.094224327423813], [166.6190598018994, -22.096705416950268], [166.61581636623856, -22.09697756908129], [166.6152488931493, -22.098241983775562], [166.61298013638728, -22.098117127934337], [166.6097308346403, -22.10124847763236], [166.61364686966854, -22.103120950692013], [166.61589003536437, -22.102636198783166], [166.61245875224498, -22.10127699245053], [166.61315740866226, -22.10033120760913], [166.61955894196856, -22.10218946663188], [166.6194543876353, -22.100450062723674], [166.61636035882523, -22.100233132265416], [166.61609914403098, -22.098396995815634], [166.62839230332898, -22.10248974509343], [166.62768920378002, -22.100370945101286]], [[166.62570164111938, -22.109134748431934], [166.62310428436072, -22.108377182174188], [166.62226043081105, -22.110115237194496], [166.62118428660412, -22.108814409386085], [166.6225910176337, -22.11095302074863], [166.62570164111938, -22.109134748431934]], [[166.62189549325848, -22.11626944023232], [166.62015646248184, -22.115651751705105], [166.6234545729663, -22.117913991448585], [166.62331542351592, -22.112784042911752], [166.6216861604658, -22.112138987510004], [166.62070763070614, -22.114653947161145], [166.62189549325848, -22.11626944023232]], [[166.63589420924293, -22.119380761622505], [166.63520511294809, -22.120187184264235], [166.63532412852754, -22.120824966101434], [166.6365498020656, -22.11900070781226], [166.63589420924293, -22.119380761622505]], [[166.64104393837175, -22.11599828271132], [166.63988995457154, -22.11523626644309], [166.63901570420774, -22.11569239706769], [166.6402985715894, -22.11699426989206], [166.64104393837175, -22.11599828271132]], [[166.6381821403972, -22.11850144059151], [166.63933768084303, -22.118037703965232], [166.63950493011808, -22.117802034532208], [166.63796550250876, -22.117936557143572], [166.63737641910288, -22.119304750860454], [166.6381821403972, -22.11850144059151]], [[166.63547615005166, -22.11850663785894], [166.6361897577789, -22.116841795300566], [166.63325283526171, -22.120159871933506], [166.63427737018296, -22.12024339707], [166.63547615005166, -22.11850663785894]], [[166.63842156708105, -22.120406906910166], [166.63920067739207, -22.119817823504285], [166.63897264510592, -22.118516139204193], [166.6365617027551, -22.12020018062704], [166.63842156708105, -22.120406906910166]], [[166.608281076413, -22.13876611416496], [166.60743545539236, -22.13852638491935], [166.60844265531483, -22.13971657829341], [166.6085757202928, -22.139450448337442], [166.608281076413, -22.13876611416496]], [[166.61447459862305, -22.13575601035706], [166.61572023108425, -22.134158558040383], [166.6134952082146, -22.13318867627669], [166.61282668519962, -22.135497740362354], [166.61447459862305, -22.13575601035706]], [[166.6108327876868, -22.12928062328768], [166.61064261479197, -22.12977507281427], [166.61312586011616, -22.128599542097923], [166.61079505403285, -22.128130420567686], [166.6108327876868, -22.12928062328768]], [[166.62721758907207, -22.13140432396009], [166.62839616459132, -22.131385314677523], [166.62831062281975, -22.12909469612799], [166.62605908678773, -22.130441234263383], [166.62721758907207, -22.13140432396009]], [[166.6258679300097, -22.132050639567428], [166.62507919808374, -22.130815342801803], [166.62493172284317, -22.129180237899547], [166.6236390916285, -22.130624943374773], [166.6258679300097, -22.132050639567428]], [[166.60980508623905, -22.142429707850003], [166.61074720988415, -22.143866884322076], [166.61324576638398, -22.145471193061002], [166.61096465247573, -22.142676828523395], [166.60980508623905, -22.142429707850003]], [[166.6198589535629, -22.15633949551082], [166.62047691014362, -22.15571203190577], [166.62031887735674, -22.154261119071062], [166.61985296714664, -22.15469850416625], [166.6198589535629, -22.15633949551082]]], [[[166.6018578038414, -22.099595307655477], [166.6023135184898, -22.10087890391517], [166.60159956554065, -22.10100042782141], [166.6006379596711, -22.100088690038262], [166.6018578038414, -22.099595307655477]]], [[[166.59578184803053, -22.097714339917154], [166.59733136919107, -22.09681060464858], [166.5983581713858, -22.09883910645573], [166.59642395714837, -22.099471079747456], [166.59578184803053, -22.097714339917154]]], [[[166.59191729429455, -22.094872243297694], [166.59143099029734, -22.095676105883392], [166.59113881706853, -22.09426414748849], [166.59143276455578, -22.094321209477155], [166.59191729429455, -22.094872243297694]]], [[[166.59270584269288, -22.095470780033793], [166.59281033643194, -22.094355239849225], [166.59487197564258, -22.094919746213257], [166.59669608760024, -22.093304647084096], [166.59512826747428, -22.0957231991529], [166.59270584269288, -22.095470780033793]]], [[[166.59021411656252, -22.094474442206252], [166.59022585411947, -22.094506301289407], [166.59018025849164, -22.094432119617625], [166.59021411656252, -22.094474442206252]]], [[[166.59013812519407, -22.094379452995664], [166.59014009293574, -22.094381912672752], [166.59011345038505, -22.09436599400892], [166.59013812519407, -22.094379452995664]]], [[[166.58930602147842, -22.09388356312319], [166.58931503560697, -22.093884633196616], [166.58931719079263, -22.093890236679353], [166.58930602147842, -22.09388356312319]]], [[[166.58750281247728, -22.092723620144447], [166.58750940602584, -22.092727283226978], [166.58751914717627, -22.092744817297728], [166.58750281247728, -22.092723620144447]]], [[[166.58743340298787, -22.092590477758613], [166.58743708356715, -22.09263832528925], [166.58734939496807, -22.09252453386405], [166.58741060207646, -22.092552476239625], [166.58743340298787, -22.092590477758613]]], [[[166.58698649165908, -22.090549477981412], [166.58729643263578, -22.090483412679944], [166.58796516141362, -22.090764582734273], [166.58694686986553, -22.091364918796216], [166.58698649165908, -22.090549477981412]]], [[[166.5490077711372, -22.066931732877332], [166.5490093, -22.0669187], [166.54902383989955, -22.06690361254323], [166.5490077711372, -22.066931732877332]]], [[[166.6068929668684, -22.157274369644995], [166.60717828651318, -22.15698905000022], [166.6074445848483, -22.158073264650362], [166.60706415865528, -22.158025711376233], [166.6068929668684, -22.157274369644995]]], [[[166.62154094206488, -22.14984926845262], [166.62220510057983, -22.15041260565199], [166.62245231824232, -22.15176279442409], [166.62153000619378, -22.150878515862082], [166.62154094206488, -22.14984926845262]]], [[[166.6212776148456, -22.146295500483372], [166.62168421842236, -22.14728641353735], [166.6214444352191, -22.147461152034598], [166.62024327024568, -22.146346839764554], [166.6212776148456, -22.146295500483372]]], [[[166.6213675511016, -22.143822726754575], [166.61959102950044, -22.142950674400467], [166.62053581078877, -22.14259886619741], [166.61866989238993, -22.139976046674477], [166.62045908401333, -22.141248177824732], [166.6213675511016, -22.143822726754575]]], [[[166.61472182338642, -22.140481806793886], [166.61654226648227, -22.14050700965592], [166.61761323139416, -22.14290313117676], [166.61566395922208, -22.142075879084224], [166.61472182338642, -22.140481806793886]]], [[[166.62536418402163, -22.14051927495182], [166.62750222192562, -22.141752585163005], [166.62360133146595, -22.141845797842475], [166.62096900298192, -22.140881169873055], [166.62536418402163, -22.14051927495182]]], [[[166.62547823971704, -22.137335220121553], [166.62589050664164, -22.136557299392216], [166.62634692158926, -22.13790752694555], [166.62477479360265, -22.137416240556032], [166.62547823971704, -22.137335220121553]]], [[[166.60970308925022, -22.136106374719887], [166.61031233736418, -22.13589731851357], [166.61071666851723, -22.136429685758362], [166.60988018349877, -22.136657818036117], [166.60970308925022, -22.136106374719887]]], [[[166.60873001659843, -22.13421490156182], [166.6084586458414, -22.13482734936152], [166.60791254260315, -22.134956331464522], [166.6077775468879, -22.13444094392309], [166.60873001659843, -22.13421490156182]]], [[[166.60853469310436, -22.125351270905487], [166.60792653276397, -22.125746575126755], [166.6065125599725, -22.124218572271467], [166.6097566118483, -22.12443373015304], [166.6102755520788, -22.125457698965057], [166.60853469310436, -22.125351270905487]]], [[[166.60539987820832, -22.11413271993345], [166.60531974249852, -22.11397987197744], [166.60534605447836, -22.11400618395729], [166.60539987820832, -22.11413271993345]]], [[[166.6048918290971, -22.113136997660323], [166.60501536226357, -22.113336551236884], [166.60506165018168, -22.113487596022274], [166.6048986, -22.1131766], [166.60487816449282, -22.11310199621382], [166.6048918290971, -22.113136997660323]]], [[[166.6184797121761, -22.098065221173275], [166.6186013036081, -22.09770044687727], [166.61919406183912, -22.09772324527077], [166.6186844875448, -22.09870115387608], [166.6184797121761, -22.098065221173275]]], [[[166.62011359704366, -22.098164014211775], [166.61958163452866, -22.097974027599275], [166.62016679329514, -22.097221680613767], [166.6206234951802, -22.098037656836116], [166.62011359704366, -22.098164014211775]]], [[[166.61711617254562, -22.097703135240224], [166.61608883737486, -22.098052445893547], [166.61582749906557, -22.097958828670272], [166.61820613145412, -22.096970898285264], [166.61711617254562, -22.097703135240224]]], [[[166.62554253902346, -22.153860578915957], [166.6277051736628, -22.15447680797756], [166.6271574875865, -22.15777813793759], [166.62689885805045, -22.155906877176836], [166.62461683273247, -22.156401315995737], [166.62410677490664, -22.15418386355153], [166.6256361373745, -22.14922814974618], [166.62792576944358, -22.151061376751635], [166.62595562091903, -22.149988824852176], [166.62554253902346, -22.153860578915957]]], [[[166.6264102, -22.1473869], [166.62636787675925, -22.148059103168812], [166.62535630405154, -22.148516554635215], [166.625075065393, -22.148007284631923], [166.6264102, -22.1473869]]], [[[166.63879044573926, -22.142085499811905], [166.6387828401207, -22.14156071213237], [166.63945213455258, -22.141910570585395], [166.63885129068763, -22.14271676615106], [166.63879044573926, -22.142085499811905]]], [[[166.63248573161522, -22.13998428465954], [166.63273287870817, -22.14045006187317], [166.63221957320744, -22.1412770540688], [166.63204847137385, -22.140469073188015], [166.63248573161522, -22.13998428465954]]], [[[166.6364085771941, -22.140766395625217], [166.6344473375248, -22.141571107386806], [166.6340229122317, -22.140272154278428], [166.63457705249184, -22.1396039583229], [166.63479278817573, -22.14092797452705], [166.6364085771941, -22.140766395625217]]], [[[166.64194677743504, -22.140146067083183], [166.6424259314033, -22.139864659197055], [166.6429279022272, -22.14040465811368], [166.64157344608606, -22.140616959392585], [166.64194677743504, -22.140146067083183]]], [[[166.63054421352157, -22.138694383825207], [166.63194390914222, -22.139014707602595], [166.6316207167899, -22.1407352315958], [166.629025672314, -22.14081127685517], [166.63054421352157, -22.138694383825207]]], [[[166.62796845573357, -22.13916961588944], [166.62896644306838, -22.138257170326124], [166.6293276194372, -22.138238161043557], [166.62884534603586, -22.13932253032073], [166.62796845573357, -22.13916961588944]]], [[[166.64429252533574, -22.13711594022106], [166.6450148305442, -22.137543620936608], [166.64152561182263, -22.13744627412813], [166.64343624896424, -22.138995696287758], [166.64237161533308, -22.139318888640073], [166.64063347921388, -22.137039908093854], [166.64257123413893, -22.13679038376608], [166.6422860644163, -22.13568772750524], [166.64429252533574, -22.13711594022106]]], [[[166.63212198397483, -22.136451288482107], [166.63249523727265, -22.136267572607917], [166.63412417676508, -22.13812089104047], [166.63267945807462, -22.137807235008985], [166.63212198397483, -22.136451288482107]]], [[[166.6340636707471, -22.136685821534442], [166.63433933481232, -22.136239055635656], [166.63498571951695, -22.137189621377757], [166.63471005545176, -22.137256160979707], [166.6340636707471, -22.136685821534442]]], [[[166.63558457593447, -22.13493678056897], [166.63534693449893, -22.13530750120839], [166.6347861007111, -22.13429039586434], [166.6356035872493, -22.13453754295729], [166.63558457593447, -22.13493678056897]]], [[[166.65244535175492, -22.128165280986245], [166.6520620583348, -22.128172661258198], [166.6517563974263, -22.127869702380845], [166.6519271, -22.1278866], [166.65244535175492, -22.128165280986245]]]]}", "forest_cover_percentage": null, "forest_fragmentation_effective_mesh_size": 39.780894148273326, "forest_fragmentation_fragment_size_distribution": {"10": 1.4941540126219932, "100": 2.2156105710476495, "1000": 2.2156105710476495, "1100": 2.2156105710476495, "1200": 2.2156105710476495, "12000": 100.0, "125": 2.2156105710476495, "1300": 2.2156105710476495, "1400": 2.2156105710476495, "150": 2.2156105710476495, "1500": 2.2156105710476495, "1600": 2.2156105710476495, "1700": 2.2156105710476495, "17000": 100.0, "175": 2.2156105710476495, "1800": 2.2156105710476495, "1900": 2.2156105710476495, "20": 2.2156105710476495, "200": 2.2156105710476495, "2000": 2.2156105710476495, "225": 2.2156105710476495, "250": 2.2156105710476495, "27000": 100.0, "275": 2.2156105710476495, "30": 2.2156105710476495, "300": 2.2156105710476495, "325": 2.2156105710476495, "350": 2.2156105710476495, "375": 2.2156105710476495, "40": 2.2156105710476495, "400": 2.2156105710476495, "425": 2.2156105710476495, "450": 2.2156105710476495, "475": 2.2156105710476495, "50": 2.2156105710476495, "500": 2.2156105710476495, "500000": 100.0, "60": 2.2156105710476495, "600": 2.2156105710476495, "70": 2.2156105710476495, "700": 2.2156105710476495, "7000": 100.0, "80": 2.2156105710476495, "800": 2.2156105710476495, "90": 2.2156105710476495, "900": 2.2156105710476495}, "forest_humidity_category_distribution": null, "frequencies": {}, "id": 71, "land_use_category_distribution": null, "name": "Haute Yat\u00e9", "num_families_unique_taxonomic_count": 78, "num_occurrences_count": 3826, "num_species_unique_taxonomic_count": 452, "rainfall_mean": "3129.888916015625", "rainfall_range": "{\"min\": 2495.0, \"max\": 3930.0}", "shape_area": "5541.4732847966425", "shape_coordinates": "{\"type\": \"FeatureCollection\", \"features\": [{\"id\": \"0\", \"type\": \"Feature\", \"properties\": {}, \"geometry\": {\"type\": \"Polygon\", \"coordinates\": [[[166.6238113, -22.0572757], [166.6103028, -22.0676387], [166.6132662, -22.0730821], [166.6249211, -22.0813982], [166.6228476, -22.0835399], [166.6237648, -22.086542], [166.6219789, -22.0872658], [166.6225387, -22.0882722], [166.6253799, -22.0878222], [166.6259739, -22.0913681], [166.6309468, -22.0911035], [166.6306428, -22.0955069], [166.6289343, -22.0954996], [166.628274, -22.0973229], [166.6292929, -22.0993869], [166.6482422, -22.1106878], [166.6477994, -22.1146887], [166.6451657, -22.1179408], [166.6475152, -22.1254335], [166.6553067, -22.1287318], [166.6548653, -22.1353595], [166.6526851, -22.1327423], [166.6453899, -22.1311755], [166.6470621, -22.1321961], [166.644746, -22.1326873], [166.6464021, -22.1339523], [166.6449942, -22.1348435], [166.6470468, -22.1358489], [166.6457127, -22.1374511], [166.647352, -22.138922], [166.645611, -22.1387911], [166.6437635, -22.1438324], [166.6361525, -22.1437747], [166.6340563, -22.1415213], [166.6321956, -22.1429826], [166.6283056, -22.142297], [166.6296768, -22.1451556], [166.6262762, -22.147839], [166.6292537, -22.1515457], [166.6286885, -22.1562614], [166.6261329, -22.1607387], [166.6213621, -22.1618379], [166.6080273, -22.1592505], [166.6012745, -22.1526187], [166.5965903, -22.1517639], [166.5945046, -22.1447693], [166.5927624, -22.1435586], [166.5978426, -22.13815], [166.60616, -22.1356229], [166.604111, -22.1311251], [166.6053907, -22.128868], [166.6040639, -22.1281594], [166.6046723, -22.1224028], [166.6030516, -22.1184623], [166.6054513, -22.1142308], [166.6036936, -22.1042714], [166.6019075, -22.1047511], [166.5935252, -22.1008357], [166.5915501, -22.0961417], [166.5858717, -22.0908984], [166.5746005, -22.0885189], [166.5635583, -22.0905423], [166.5546044, -22.086841], [166.5453016, -22.0716959], [166.550653, -22.0652131], [166.5541619, -22.0635716], [166.55943, -22.0645917], [166.5734162, -22.0608959], [166.5760352, -22.0620186], [166.5827012, -22.0593026], [166.5853167, -22.0559897], [166.5936433, -22.0585529], [166.6022026, -22.0541884], [166.6120244, -22.0567559], [166.6204146, -22.0539406], [166.6238113, -22.0572757]]]}, \"bbox\": [166.5453016, -22.1618379, 166.6553067, -22.0539406]}], \"bbox\": [166.5453016, -22.1618379, 166.6553067, -22.0539406]}", "shape_id": 71, "type": "protected_areas"};
    var mapping = {"fields": {"elevation": {"data_source": {"name": "elevation", "type": "layer"}, "description": "Altitude metrics within the shape", "field_type": "JSON", "label": "Altitude", "transformations": [{"chart_options": {"title": "Median Altitude"}, "chart_type": "text", "name": "median"}, {"chart_options": {"title": "Maximum Altitude"}, "chart_type": "text", "name": "max"}, {"chart_options": {"title": "Elevation Distribution", "x_label": "Elevation (m)", "y_label": "Area (ha)"}, "chart_type": "stacked_bar", "data_structure": {"x_field": "altitudes", "y_fields": [{"color": "#4BC0C0", "label": "For\u00eat", "name": "forest"}, {"color": "#FF6384", "label": "Hors-for\u00eat", "name": "non_forest"}]}, "name": "elevation_distribution"}]}, "forest": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "TEXT", "label": "Forest Area", "transformations": [{"chart_options": {"title": "Forest Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "forest_coordinates", "title": "Forest Location"}, "chart_type": "map", "name": "coordinates"}]}, "forest_cover": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "JSON", "label": "Forest Area", "transformations": [{"chart_options": {"categories": ["UM", "Non-UM", "Commune"], "title": "Forest Cover"}, "chart_type": "donut", "layer_params": {"forest_cover": [{"name": "area"}, {"attribute": "cover_type"}], "soil_types": [{"attribute": "soil_category"}]}, "name": "percentage"}]}, "forest_fragmentation": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Analysis of forest fragmentation", "field_type": "JSON", "label": "Forest Fragmentation", "transformations": [{"chart_options": {"bins": [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 7000, 12000, 17000, 27000, 500000], "title": "Forest Fragment Distribution", "x_label": "Area (ha)", "y_label": "Cumulative Area (%)"}, "chart_type": "line", "data_structure": {"color": "#4BC0C0", "x_field": "keys", "y_field": "values"}, "name": "fragment_size_distribution"}, {"chart_options": {"label": "Effective Mesh Size (km\u00b2)", "max": 1000, "min": 0, "title": "Fragmentation"}, "chart_type": "gauge", "name": "effective_mesh_size"}]}, "forest_humidity": {"data_source": [{"name": "forest_cover", "type": "layer"}, {"name": "holdridge", "type": "shape"}], "description": "Distribution of forests by humidity level", "field_type": "JSON", "label": "Forest and Living Environments", "transformations": [{"chart_options": {"categories": ["Dry", "Humid", "Very Humid"], "title": "Forest and Living Environments", "x_label": "Category", "y_label": "Frequency (%)"}, "chart_type": "stacked_bar", "layer_params": {"forest_cover": [{"name": "area"}], "humidity": [{"name": "value"}]}, "name": "category_distribution"}]}, "land_use": {"data_source": [{"name": "ultramafic", "type": "shape"}, {"name": "holdridge", "type": "shape"}, {"name": "forest_cover", "type": "layer"}], "description": "Land use distribution", "field_type": "JSON", "label": "Land Use", "transformations": [{"chart_options": {"title": "Land Use", "x_label": "Category", "y_label": "Area (ha)"}, "chart_type": "bar", "name": "category_distribution"}]}, "num_families": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of families in the zone", "field_type": "INTEGER", "label": "Number of Families", "transformations": [{"chart_options": {"title": "Number of Families"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["family"]}]}, "num_occurrences": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of occurrences in the zone", "field_type": "INTEGER", "label": "Number of Occurrences", "source_field": "id_occurrence", "transformations": [{"chart_options": {"title": "Number of Occurrences"}, "chart_type": "text", "name": "count"}]}, "num_species": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of species in the zone", "field_type": "INTEGER", "label": "Number of Species", "transformations": [{"chart_options": {"title": "Number of Species"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["species", "infra"]}]}, "rainfall": {"data_source": {"name": "rainfall", "type": "layer"}, "description": "Average annual rainfall within the shape", "field_type": "TEXT", "label": "Average Rainfall", "transformations": [{"chart_options": {"title": "Average Rainfall"}, "chart_type": "text", "name": "mean"}, {"chart_options": {"title": "Rainfall Range"}, "chart_type": "text", "name": "range"}]}, "shape": {"data_source": {"name": "self", "type": "shape"}, "description": "Total area of the reference zone", "field_type": "TEXT", "label": "Shape Area", "transformations": [{"chart_options": {"title": "Total Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "shape_coordinates", "title": "Location"}, "chart_type": "map", "name": "coordinates"}]}}, "group_by": "shape", "source_location_field": "geo_pt", "source_table_name": "occurrences"};
    var currentShapeType = "protected_areas";

    document.addEventListener('DOMContentLoaded', function () {
        loadShapeCharts(shape, mapping);
        loadShapeTypeList();
        initShapeMaps(mapping, shape);
        loadAllShapesMap(shape);
    });

    function loadShapeCharts(shape, mapping) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            if (field.field_type !== 'TEXT' && shape[field_key] !== null) {
                // Handle bins chart if present
                if (field.bins && field.bins.values && field.bins.values.length > 0) {
                    var binChartId = field_key + 'BinChart';
                    var binCtx = document.getElementById(binChartId);
                    if (binCtx) {
                        createBinChart(binCtx, field, shape);
                    }
                }

                // Handle transformations
                field.transformations.forEach(function(transformation) {
                    var transformationName = transformation.name ? transformation.name : '';
                    var valueKey = field_key + '_' + transformationName;

                    if (shape[valueKey] !== null) {
                        switch(transformation.chart_type) {
                            case 'pie':
                                var pieChartId = field_key + 'PieChart';
                                var pieCtx = document.getElementById(pieChartId);
                                if (pieCtx) {
                                    createPieChart(pieCtx, transformation, shape[valueKey]);
                                }
                                break;
                            case 'gauge':
                                var gaugeId = field_key + transformationName + 'Gauge';
                                var gaugeElement = document.getElementById(gaugeId);
                                if (gaugeElement) {
                                    createGauge({
                                        id: gaugeId,
                                        value: parseFloat(shape[valueKey]),
                                        min: 0,
                                        max: transformation.chart_options.max,
                                        title: transformation.chart_options.title,
                                        label: transformation.chart_options.label
                                    });
                                }
                                break;
                            case 'bar':
                                var barChartId = field_key + transformationName + 'BarChart';
                                var barCtx = document.getElementById(barChartId);
                                if (barCtx) {
                                    createBarChart(barCtx, field, transformation, shape[valueKey]);
                                }
                                break;
                            case 'stacked_bar':
                                if (field_key === 'elevation' && transformationName === 'elevation_distribution') {
                                    var stackedBarChartId = 'elevationDistributionChart';
                                    var stackedBarCtx = document.getElementById(stackedBarChartId);
                                    if (stackedBarCtx) {
                                        createElevationDistributionChart(stackedBarCtx, shape.elevation_elevation_distribution, transformation);
                                    }
                                }
                                break;
                            case 'line':
                                if (field_key === 'forest_fragmentation' && transformationName === 'fragment_size_distribution') {
                                    var lineChartId = 'forestFragmentationChart';
                                    var lineCtx = document.getElementById(lineChartId);
                                    if (lineCtx) {
                                        createForestFragmentationChart(lineCtx, shape.forest_fragmentation_fragment_size_distribution, transformation);
                                    }
                                }
                                break;
                        }
                    }
                });
            }
        });
    }

    function createBinChart(ctx, field, shape) {
        var binData = {
            labels: field.bins.values,
            datasets: [{
                label: field.label,
                data: field.bins.values.map(value => shape.frequencies[field.field_key][value] || 0),
                backgroundColor: field.bins.chart_options.color
            }]
        };

        new Chart(ctx, {
            type: field.bins.chart_type,
            data: binData,
            options: field.bins.chart_options
        });
    }

    function createPieChart(ctx, transformation, data) {
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['True', 'False'],
                datasets: [{
                    data: [data.true || 0, data.false || 0],
                    backgroundColor: ['#FF6384', '#36A2EB']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: transformation.chart_options.title
                }
            }
        });
    }

    function createBarChart(ctx, field, transformation, data) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: field.label,
                    data: Object.values(data),
                    backgroundColor: getColor(0).background,
                    borderColor: getColor(0).border,
                    borderWidth: 1
                }]
            },
            options: transformation.chart_options
        });
    }

    function createElevationDistributionChart(ctx, elevationData, chartConfig) {
        const altitudes = elevationData.altitudes.reverse();
        const forestData = elevationData.forest.reverse();
        const nonForestData = elevationData.non_forest.reverse();

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: altitudes,
                datasets: [
                    {
                        label: 'Forest',
                        data: forestData,
                        backgroundColor: '#4CAF50',
                        stack: 'Stack 0',
                    },
                    {
                        label: 'Non-Forest',
                        data: nonForestData,
                        backgroundColor: '#FFF59D',
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Area (ha)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString(); // Format les grands nombres
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Elevation (m)'
                        },
                        reverse: false
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                layout: {
                    padding: {
                        left: 10,
                        right: 10,
                        top: 0,
                        bottom: 10
                    }
                }
            }
        });
    }

    function createForestFragmentationChart(ctx, fragmentationData, chartConfig) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(fragmentationData),
                datasets: [{
                    label: 'Cumulative Area (%)',
                    data: Object.values(fragmentationData),
                    borderColor: '#4BC0C0',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.x_label
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.y_label
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: chartConfig.chart_options.title
                    }
                }
            }
        });
    }

    function createGauge(options) {
        new JustGage({
            id: options.id,
            value: options.value || 0,
            min: options.min || 0,
            max: options.max,
            title: options.title,
            label: options.label,
            pointer: true,
            pointerOptions: {
                toplength: 10,
                bottomlength: 10,
                bottomwidth: 2,
                color: '#8e8e93',
                stroke: '#ffffff',
                stroke_width: 3,
                stroke_linecap: 'round'
            },
            gaugeWidthScale: 0.6,
            counter: true,
            donut: true,
            relativeGaugeSize: true,
            donutStartAngle: 270,
            hideInnerShadow: true,
            customSectors: [{
                color: "#ff0000",
                lo: 0,
                hi: options.max * 0.33
            }, {
                color: "#ffff00",
                lo: options.max * 0.33,
                hi: options.max * 0.66
            }, {
                color: "#00ff00",
                lo: options.max * 0.66,
                hi: options.max
            }],
            humanFriendly: true,
            formatNumber: true,
            textRenderer: function (val) {
                return parseFloat(val).toFixed(2);
            }
        });
    }

    // Function to get a color based on the index
    function getColor(index) {
        var colors = [
            {background: 'rgba(54, 162, 235, 0.6)', border: 'rgba(54, 162, 235, 1)'},
            {background: 'rgba(75, 192, 192, 0.6)', border: 'rgba(75, 192, 192, 1)'},
            {background: 'rgba(255, 99, 132, 0.6)', border: 'rgba(255, 99, 132, 1)'}
        ];
        return colors[index % colors.length];
    }

// Rest of the code (loadShapeTypeList, initShapeMaps, loadAllShapesMap) remains the same...

    let maps = {};  // Object to keep track of initialized maps

    function initMap(field_key, geometry) {
        const mapId = field_key + 'Map';
        const mapLoaderId = field_key + 'MapLoader';

        // Check if the map already exists
        if (maps[mapId]) {
            return; // Map is already initialized, so do nothing
        }

        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        map.on('load', function () {
            document.getElementById(mapLoaderId).style.display = 'none';
        });

        if (geometry) {
            const geoJsonLayer = L.geoJSON(geometry, {
                style: function() {
                    return {
                        color: '#228b22', // Border color
                        weight: 2,       // Border width
                        fillColor: '#228b22cc', // Fill color with opacity
                        fillOpacity: 0.8 // Fill opacity
                    };
                }
            }).addTo(map);
            map.fitBounds(geoJsonLayer.getBounds());
        } else {
            console.warn("No geographic coordinates found.");
            // Set default view if no geometry is found
            map.setView([-21.291237, 165.516418], 10);
        }

        // Store the map instance in the maps object
        maps[mapId] = map;
    }

    function initShapeMaps(mapping, shape) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            field.transformations.forEach(function(transformation) {
                if (transformation.chart_type === 'map') {
                    var coordinatesField = transformation.chart_options.coordinates_field;
                    var geometry = shape[coordinatesField];

                    // Check if geometry is a string, if so, parse it as JSON
                    if (typeof geometry === 'string') {
                        try {
                            geometry = JSON.parse(geometry);
                        } catch (e) {
                            console.error("Invalid JSON for field", coordinatesField, ":", geometry);
                            return; // Skip this field if JSON is invalid
                        }
                    }

                    // Initialize the map with the parsed geometry
                    initMap(field_key, geometry);
                }
            });
        });
    }

    function loadAllShapesMap(currentShape) {
        const mapId = 'allShapesMap';
        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        var group = L.featureGroup(); // Create a group to hold all the layers

        shapeTypes.forEach(function(shapeTypeItem) {
            if (shapeTypeItem.type === currentShape.type) {
                shapeTypeItem.shapes.forEach(function(shapeItem) {
                    var geometry = shapeItem.geometry;
                    // No need to parse geometry if it's already GeoJSON
                    var layer = L.geoJSON(geometry, {
                        style: function() {
                            return {
                                color: '#228b22', // Border color
                                weight: 2,       // Border width
                                fillColor: '#228b22cc', // Fill color with opacity
                                fillOpacity: 0.8 // Fill opacity
                            };
                        }
                    }).addTo(map);
                    group.addLayer(layer); // Add each layer to the group

                    // Highlight current shape
                    if (shapeItem.id === currentShape.id) {
                        layer.setStyle({color: 'red', weight: 3, fillOpacity: 0.4});
                        layer.bringToFront(); // Ensure the highlighted shape is on top
                    } else {
                        layer.setStyle({fillOpacity: 0.2}); // Reduce opacity for other shapes
                    }

                    // Show tooltip on hover with additional content
                    var tooltipContent = "<strong>" + shapeItem.name + "</strong><br>";

                    


                    layer.bindTooltip(tooltipContent, {
                        permanent: false,
                        direction: 'right',
                        offset: L.point(10, 0),
                        opacity: 0.9,
                        className: 'custom-tooltip'
                    });


                    layer.on('mousemove', function(e) {
                        var tooltip = e.target.getTooltip();
                        tooltip.setLatLng(e.latlng);
                    });

                    layer.on('click', function() {
                        window.location.href = '../shape/' + shapeItem.id + '.html';
                    });
                });
            }
        });

        map.fitBounds(group.getBounds()); // Adjust the view to fit the bounds of the group

        map.attributionControl.setPrefix(false);
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        maps['allShapesMap'] = map;
    }

    function loadShapeTypeList() {
            var shapeTypeListElement = document.getElementById("shape-type-list");
            shapeTypes.forEach(function (shapeTypeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "javascript:void(0)";
                a.textContent = shapeTypeItem.type;
                a.className = "shape-type-link";
                if (shapeTypeItem.type === currentShapeType) {
                    a.classList.add("active");
                }
                a.onclick = function () {
                    if (shapeTypeItem.shapes.length > 0) {
                        // Redirect to the first shape of the selected type
                        window.location.href = "../shape/" + shapeTypeItem.shapes[0].id + ".html";
                    }
                    loadShapeList(shapeTypeItem.shapes);
                };
                li.appendChild(a);
                shapeTypeListElement.appendChild(li);
            });
        }

        function loadShapeList(shapes) {
            var shapeListElement = document.getElementById("shape-list");
            shapeListElement.innerHTML = ''; // Clear the previous list
            shapes.forEach(function (shapeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "../shape/" + shapeItem.id + ".html";
                a.textContent = shapeItem.name;
                a.className = "shape-link";
                if (shapeItem.id === shape.id) {
                    a.classList.add("active");
                }
                li.appendChild(a);
                shapeListElement.appendChild(li);
            });
        }

</script>

</body>
</html>