<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Niamoto - 48.0</title>
    <link rel="stylesheet" href="../js/vendor/tailwindcss/2.2.19_dist_tailwind.css">
    <link rel="stylesheet" href="../js/vendor/leaflet/1.9.4_leaflet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    
<script src="../js/shape_list.js"></script>

<style>
    #shape-type-list li, #shape-list li {
        list-style: none;
        text-transform: capitalize;
    }

    .shape-type-link, .shape-link {
        display: block;
        padding: 10px;
        border-radius: 5px;
        text-decoration: none;
    }

    .shape-type-link:hover, .shape-link:hover {
        background-color: #f0f0f0;
    }

    .shape-type-link.active, .shape-link.active {
        background-color: #3498db;
        color: #fff;
    }

    #shapeMap, #allShapesMap {
        position: relative;
        height: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    #allShapesMap {
        height: 400px;
    }

    .chart-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
    }

    .chart-container > div {
        flex: 1 1 calc(33.333% - 10px);
        margin: 5px;
    }
    .custom-tooltip {
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #ccc;
    padding: 5px;
    border-radius: 5px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    font-size: 12px;
    max-width: 300px;
    word-wrap: break-word;
}
</style>

    <style>
        .gauge {
            height: 349px;
        }

        ul {
            list-style-type: none;
        }

        .loader-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <nav class="nav-bg p-4 fixed w-full top-0 shadow-md z-50 custom-nav">
    <div class="container mx-auto flex flex-wrap items-center justify-between">
        <div class="flex items-center flex-shrink-0 text-white mr-6">
            <a id="home-link" class="inline-flex items-center py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                <span class="site-title">Niamoto</span>
            </a>
        </div>

        <div class="block lg:hidden">
            <button id="nav-toggle"
                class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
                <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0zm0 6h20v2H0zm0 6h20v2H0z" />
                </svg>
            </button>
        </div>
        <div class="w-full flex-grow lg:flex lg:items-center lg:w-auto hidden lg:block pt-6 lg:pt-0" id="nav-content">
            <ul class="list-reset lg:flex justify-end flex-1 items-center">
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="index.html">
                        <i class="fas fa-home menu-icon"></i>Accueil
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#introduction">Introduction</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#project">Projet</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#objective">Objectifs</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#context">Contexte</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="index.html#flora">Flore</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="methodology.html">
                        <i class="fas fa-flask menu-icon"></i>Méthodologie
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#methodes">Nos méthodes</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="methodology.html#faq">FAQ</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="trees.html">
                        <i class="fas fa-leaf menu-icon"></i>Arbres
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#learnTaxon">Étudier les
                arbres</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="trees.html#taxon">Les arbres de
                Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="plots.html">
                        <i class="fas fa-map-marked-alt menu-icon"></i>Peuplements
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#learnPlot">Étudier les
                            peuplements forestiers</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="plots.html#plot">Les
                peuplements forestiers de Nouvelle-Calédonie</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="forests.html">
                        <i class="fas fa-tree menu-icon"></i>Forêt
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#preambule">Préambule</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#learnForest">Étudier les
                forêts</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPN">La forêt de la
                province Nord</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="forests.html#forestPS">La forêt de la
                province Sud</a></li>
                    </ul>
                </li>
                <li class="relative group mr-3">
                    <a class="nav-link inline-block py-2 px-4 text-white no-underline" href="#" data-link="resources.html">
                        <i class="fas fa-book menu-icon"></i>Ressources
                    </a>
                    <ul class="absolute hidden text-gray-700 pt-1 group-hover:block bg-white shadow-lg rounded-md z-50 w-48 custom-dropdown">
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#equipe">L'équipe</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#article">Articles</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#academic">Académique</a></li>
                        <li><a class="py-2 px-4 block whitespace-no-wrap hover:bg-gray-100" href="#" data-link="resources.html#media-production">Médias</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
  document.getElementById('nav-toggle').onclick = function () {
    document.getElementById('nav-content').classList.toggle('hidden');
  };

  // Function to adjust the navigation links based on page depth
  function adjustNavLinks(depth) {
    document.querySelectorAll('a[data-link]').forEach(link => {
      link.href = depth + link.getAttribute('data-link');
    });
  }

  // Adjust the navigation links based on the depth
  adjustNavLinks("../");
</script>

<style>
    .site-title {
        font-family: 'Arial Black', sans-serif; /* Custom font for a bold effect */
        font-size: 2rem; /* Increased font size */
        text-transform: uppercase; /* Uppercase letters for visibility */
        letter-spacing: 2px; /* Spacing between letters */
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7); /* Text shadow for better visibility */
        transition: color 0.3s; /* Smooth transition for hover effect */
    }

    .site-title:hover {
        color: #ffdd57; /* Change color on hover */
    }

    .text-contour {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .nav-bg {
        background-color: rgba(34, 139, 34, 0.8); /* Fond vert semi-transparent */
        transition: background-color 0.3s;
    }

    .nav-bg:hover {
        background-color: rgba(34, 139, 34, 1); /* Fond vert opaque au survol */
    }

    .group:hover .group-hover\:block {
        display: block;
    }

    .custom-nav {
        z-index: 500;
    }

    .custom-dropdown {
        z-index: 500;
    }

    .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.2); /* Fond blanc transparent au survol */
        border-radius: 4px;
    }

    .menu-icon {
        margin-right: 8px;
    }
</style>
    <div class="flex">
        
<aside class="w-1/4 p-4 mt-28">
    <h2 class="font-semibold text-lg mb-4">Shape Types</h2>
    <ul id="shape-type-list" class="list-disc pl-5">
        <!-- The list of shape types will be generated by JavaScript -->
    </ul>
</aside>

        <div class="w-full">
            
<div id="allShapesMap" class="mt-28"></div>

<div class="rounded overflow-hidden shadow-lg mb-2 mt-8">
    <div class="px-6 py-4">
        <div class="font-bold text-4xl mb-2">48.0</div>
    </div>
</div>

<div class="chart-container">
    <!-- Section for general information -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">General Information</h2>
            
                
                    
                        
                        
                            <p>Shape Area (Total Area): 6296.821309606773</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Forest Area (Forest Area): 5907.701300028731</p>
                        
                    
                
                    
                
            
                
                    
                        
                        
                            <p>Number of Families (Number of Families): 68</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Species (Number of Species): 309</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Number of Occurrences (Number of Occurrences): 1942</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Average Rainfall (Average Rainfall): 2221.634521484375</p>
                        
                    
                
                    
                        
                        
                            <p>Average Rainfall (Rainfall Range): {"min": 1830.0, "max": 2620.0}</p>
                        
                    
                
            
                
                    
                        
                        
                            <p>Altitude (Median Altitude): 698.0</p>
                        
                    
                
                    
                        
                        
                            <p>Altitude (Maximum Altitude): 1057.0</p>
                        
                    
                
                    
                
            
                
                    
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
        </div>
    </div>

    <!-- Section for shape map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Shape Map</h2>
            <div id="shapeMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="shapeMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Section for forest map -->
    <div>
        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
            <h2 class="font-bold text-xl mb-2">Forest Map</h2>
            <div id="forestMap" style="height: 400px; position: relative;">
                <div class="loader-container" id="forestMapLoader">
                    <div class="loader"></div>
                </div>
                <!-- The Leaflet map will be loaded here -->
            </div>
        </div>
    </div>
</div>

<div class="flex flex-wrap -mx-2">
    

    

    
    
        
    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
    
        
            
            

            
            
                
            
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Elevation Distribution</h2>
        
    
    
        <canvas id="elevationDistributionChart"></canvas>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Forest Fragment Distribution</h2>
        
    
    
        <canvas id="forestFragmentationChart"></canvas>
    
    
                        </div>
                    </div>
                
            
                
                    <div class="w-1/2 px-2 mb-4">
                        <div class="rounded overflow-hidden shadow-lg p-4 bg-white">
                            
    
        
            <h2 class="font-bold text-xl mb-2">Fragmentation</h2>
        
    
    
        <div class="gauge" id="forest_fragmentationeffective_mesh_sizeGauge"></div>
    
    
                        </div>
                    </div>
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
        
            
            

            
            
                
            

    
        
    
</div>

        </div>
    </div>
    <footer class="bg-green-700 text-white p-4 mt-8">
        <div class="container mx-auto">
            <div class="flex justify-center mb-4">
                <div class="bg-white p-2 rounded-lg shadow-md flex justify-center">
                    <figure class="mx-2"><img class="img-fluid" src="../files/ps_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/pn_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/amap_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/herbarium_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/iac_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/ird_100.png"></figure>
                    <figure class="mx-2"><img class="img-fluid" src="../files/cirad_100.png"></figure>
                </div>
            </div>
            <div class="text-center">
                <p>Niamoto - Portail de la forêt de Nouvelle-Calédonie</p>
                <a class="inline-block py-2 px-4 text-white no-underline" href="https://github.com/niamoto/niamoto" target="_blank">
                    <span class="fab fa-github fa-lg" aria-hidden="true"></span> Github
                </a>
            </div>
        </div>
    </footer>
    <script src="../js/vendor/chart/4.4.2_chart.js"></script>
    <script src="../js/vendor/d3/7.8.5_d3.js"></script>
    <script src="../js/vendor/jquery/3.6.0_jquery.js"></script>
    <script src="../js/vendor/raphael/2.3.0_raphael.js"></script>
    <script src="../js/vendor/justgage/1.6.1_justgage.js"></script>
    <script src="../js/vendor/leaflet/1.9.4_leaflet.js"></script>
    
<script>
    var shape = {"elevation_elevation_distribution": {"altitudes": [367.0, 467.0, 567.0, 667.0, 767.0, 867.0, 967.0], "forest": [134.4650005698826, 780.1192595046082, 1538.01289908031, 1586.9092629239037, 960.1467809287485, 608.9819860520303, 293.378183061562], "non_forest": [1.1112809964453108, 34.449710889804635, 117.79578562320295, 120.01834761609356, 52.2302068329296, 38.89483487558588, 14.44665295378904]}, "elevation_max": 1057.0, "elevation_median": 698.0, "forest_area": "5907.701300028731", "forest_coordinates": "{\"type\": \"MultiPolygon\", \"coordinates\": [[[[165.8805815059405, -21.619091514216088], [165.88197781304686, -21.618355622633004], [165.8808813743123, -21.620409564565705], [165.87731244910026, -21.621799217861536], [165.8805815059405, -21.619091514216088]]], [[[165.82925184061156, -21.6143040601631], [165.82951763669038, -21.6144982076715], [165.82894219269954, -21.614580264634068], [165.82903800819795, -21.614529362905166], [165.82925184061156, -21.6143040601631]]], [[[165.90663314068826, -21.600761594564705], [165.90672841761918, -21.599856297518716], [165.9073743929756, -21.599940749097623], [165.9069631367525, -21.60075216610573], [165.90663314068826, -21.600761594564705]]], [[[165.8383476757, -21.580616968299996], [165.84095286774786, -21.57622977090684], [165.8419113636583, -21.576051572726605], [165.8436238117853, -21.576084120792384], [165.84180045540003, -21.576944280699998], [165.8435538429, -21.57706738589999], [165.8429506241, -21.578273823399993], [165.84460947570003, -21.57665267299999], [165.84307075777934, -21.579039563853158], [165.8486058, -21.577218190599996], [165.846191568, -21.57728168339999], [165.84666809127484, -21.575669866155184], [165.8493032716, -21.575710143699986], [165.8480025812, -21.574202096799997], [165.8487566046, -21.573881636799996], [165.849293128, -21.57291687399999], [165.8509900302, -21.572898019499988], [165.8512917017, -21.57261520249999], [165.8491422923, -21.572652911399988], [165.8478884701, -21.5741518417], [165.8450980088, -21.571427370899986], [165.8466641896, -21.5755027873], [165.84432053491585, -21.57435404649988], [165.84302115418205, -21.568714952104166], [165.8462312993, -21.566430942699988], [165.84323769045304, -21.567076575199998], [165.844768978559, -21.5649194736654], [165.8492079947914, -21.563867581336172], [165.85146461043846, -21.567868410105934], [165.85082323789834, -21.565684536779276], [165.8527115523344, -21.566105142957753], [165.85295921373853, -21.563518028626838], [165.85849341264966, -21.563152407139388], [165.86173034606327, -21.566147081126104], [165.859765347, -21.568000253999994], [165.86248755960938, -21.567621075190846], [165.86344073061724, -21.57025216591882], [165.8598738708, -21.574559944699992], [165.8624852987, -21.574163988099986], [165.86370433770065, -21.5721729770162], [165.86360337535544, -21.576135181444915], [165.86221085457905, -21.575761982213887], [165.86326931191368, -21.57709972591497], [165.86073474638232, -21.579445223487586], [165.8512825832, -21.581780032500003], [165.85315673714132, -21.5818399919081], [165.8533058819334, -21.5824119777123], [165.8507170656, -21.583043021699986], [165.85370501763242, -21.58444033260374], [165.8517161467, -21.58722785189999], [165.85373488664797, -21.587534417937253], [165.8537585483775, -21.591570370910055], [165.86075753235912, -21.59510657816664], [165.86591634059346, -21.59437604907581], [165.8656052014472, -21.597412134512908], [165.8665641010734, -21.594641722249992], [165.8705890494514, -21.597127439602968], [165.88031043634578, -21.594949299507828], [165.88056580872995, -21.596615429729297], [165.8839620218, -21.600599253699993], [165.88428062156714, -21.60263785790125], [165.88508726396765, -21.600700512252672], [165.88084540548215, -21.595006536264304], [165.88388769557642, -21.595953291840168], [165.88662123650832, -21.594420955902255], [165.8883458351, -21.595727357199994], [165.8883655014192, -21.598220624870237], [165.88919520580922, -21.593291897939682], [165.88789308815245, -21.59358149473793], [165.89026464822052, -21.592335042401213], [165.8937587072419, -21.592312444364225], [165.90061625817384, -21.596370535690244], [165.90018643186235, -21.59772798788866], [165.90177357168992, -21.5972916691901], [165.9010137791376, -21.600931306826304], [165.9026166171638, -21.60081816531857], [165.90274496814203, -21.59879195261384], [165.9050357693473, -21.599181269949202], [165.90646269370495, -21.599714953669192], [165.90582691849795, -21.602076241957985], [165.90878304720687, -21.600151132661193], [165.91328705735822, -21.601719124780626], [165.91410112615236, -21.603532895486513], [165.91529261345178, -21.60289242629394], [165.91387363570794, -21.601223178886485], [165.91593709583478, -21.59881837268773], [165.92043942395748, -21.59836109538479], [165.9234730883258, -21.595715711069257], [165.92849749483452, -21.59587299469307], [165.92673006081677, -21.593002161741172], [165.92856454780062, -21.590577402584362], [165.92519875345982, -21.588311019207456], [165.9237343559796, -21.583356664590355], [165.91640963945162, -21.579569101805554], [165.91537936239422, -21.5754419471193], [165.91637620659225, -21.573492068864063], [165.91938884203003, -21.571550828437765], [165.92520417996008, -21.571283355365136], [165.9294, -21.573199999999986], [165.9333, -21.578199999999992], [165.9308, -21.573199999999986], [165.9289, -21.57259021110944], [165.92734425216264, -21.56551715869044], [165.92258688050708, -21.559041023151117], [165.9246, -21.55819999999999], [165.92287645750244, -21.557516844442155], [165.92390746285093, -21.55591838531008], [165.92582169026176, -21.557735458272816], [165.92956370076604, -21.557094509370323], [165.92592537317248, -21.55686829211061], [165.926142164713, -21.55458726807527], [165.92536966475782, -21.554719637158883], [165.92732617153555, -21.55237330735576], [165.93016694679187, -21.553248815955335], [165.93191391683007, -21.550440161912093], [165.93433338512233, -21.550619436783155], [165.93757152861554, -21.553612597453935], [165.93741532482161, -21.55900793035865], [165.94082294312344, -21.557338757968004], [165.9445122446782, -21.55782951199781], [165.94991867957808, -21.56354066021095], [165.94757428665548, -21.566899999999986], [165.95303796656512, -21.567429958152413], [165.95307153825726, -21.572564597387814], [165.94695150111488, -21.576452236416063], [165.95074202381846, -21.575368711009627], [165.95399902882107, -21.581779742518222], [165.9544613845525, -21.583483684781612], [165.9526221216415, -21.583003122255466], [165.95101935847134, -21.585482691159847], [165.95442836313038, -21.58419856014299], [165.9573021812013, -21.589267774116877], [165.96138990528203, -21.587533690920775], [165.96398473903696, -21.587506833357544], [165.96402029483022, -21.589021089992883], [165.9660059916825, -21.588018586708564], [165.9693, -21.59019999999999], [165.96929011287037, -21.592579725436536], [165.96846023420395, -21.593517450109445], [165.9696, -21.59269999999999], [165.97, -21.59139999999999], [165.97261233876526, -21.591999999999988], [165.9731603638697, -21.59409999999999], [165.9708, -21.59469999999998], [165.97405037218317, -21.595995540297622], [165.97598090006926, -21.60079999999999], [165.9748491306851, -21.602498132900408], [165.97604326333524, -21.6012], [165.97679675748344, -21.605340983016145], [165.97343409451423, -21.606615888157723], [165.97691824425533, -21.60588336670552], [165.97638444493052, -21.607913004647703], [165.9792466417481, -21.609714949561035], [165.979730629273, -21.614216764821332], [165.9790187742446, -21.615799180054495], [165.97700392881677, -21.618606384055088], [165.97368055802124, -21.619872268902082], [165.96475408894895, -21.615563801193403], [165.95762102293997, -21.60437140982991], [165.95859036508136, -21.600833107006043], [165.9556470898459, -21.60395562015646], [165.95615650286743, -21.60716303547713], [165.9575587184458, -21.604366123774923], [165.95700835395516, -21.608050673531782], [165.95416504763335, -21.610260224315308], [165.95353128411762, -21.608774120752095], [165.95314383812686, -21.6104451286743], [165.94410890564112, -21.60688858630458], [165.9415592951374, -21.601869876398123], [165.93994658370912, -21.601878993896865], [165.93939570884203, -21.605552860438337], [165.9369585585895, -21.6076020161018], [165.93523908522653, -21.607288445292173], [165.93370924757974, -21.608311788169186], [165.93398767012928, -21.605976484802895], [165.9295821235783, -21.606889461817428], [165.92931087462424, -21.604804016406412], [165.92811911294734, -21.60775165046132], [165.93270787578246, -21.608676870616], [165.93064652944472, -21.608819164099256], [165.93064296999114, -21.61119536429974], [165.93320976511484, -21.611918204068306], [165.93240983752642, -21.6129057239373], [165.93561312596796, -21.61244720991781], [165.9346058063285, -21.61414763372704], [165.93639532825907, -21.612929604995823], [165.93729467386206, -21.616870194882292], [165.94039497436728, -21.61686763934147], [165.93989777880657, -21.62083386839886], [165.94097000769088, -21.62117869388628], [165.93924686552646, -21.62423741116457], [165.93436889936456, -21.625294198045747], [165.93099602387932, -21.62404356135045], [165.92945308208297, -21.625495544128086], [165.92797534369421, -21.62418918000573], [165.92523282546284, -21.626916357088703], [165.9255978078639, -21.62515151593705], [165.92450338660868, -21.62601950520844], [165.92488157889485, -21.628466679581337], [165.916324493436, -21.629703218729663], [165.9120561561447, -21.626284168056205], [165.89963292725614, -21.625814507274345], [165.89450719632077, -21.62118308123352], [165.89273632476386, -21.621929823419954], [165.89353886844668, -21.628065603713313], [165.8908522916766, -21.627866341076654], [165.89308816641142, -21.630714143331755], [165.89376673862301, -21.629097915214917], [165.89236170281856, -21.637856471052483], [165.88951680417597, -21.64006496365853], [165.8857747672651, -21.640084953131698], [165.87507829930058, -21.62933560790303], [165.87604664573473, -21.621970484601178], [165.87894461889346, -21.623049290102035], [165.88290239477945, -21.619770798754317], [165.88232217256973, -21.618001828602676], [165.88434580695196, -21.61756663075306], [165.87867392734327, -21.613064313345493], [165.878662527593, -21.609701387016322], [165.87795004320122, -21.613719798985926], [165.87878222497082, -21.6146830778836], [165.87919210580534, -21.615605848044137], [165.8768884901215, -21.613877032437358], [165.877619677633, -21.61032380116553], [165.8760533858763, -21.611446981734172], [165.87680103491206, -21.613770152012513], [165.86987180378014, -21.614186678079694], [165.86611202548764, -21.60948807801976], [165.8614133752155, -21.607270386339522], [165.857793103306, -21.609229664772183], [165.8560042819, -21.607576873799996], [165.85655557784406, -21.60925779009196], [165.85436992229012, -21.60912133677079], [165.85013654334543, -21.612318333801536], [165.85000409425214, -21.610747382296847], [165.84859519351804, -21.612737183883564], [165.83273342144244, -21.61261291460731], [165.82838138427354, -21.614596975110082], [165.82264100924263, -21.614599739122013], [165.81937124578343, -21.61298612778773], [165.81827046822343, -21.608847339755044], [165.82000006070854, -21.60574936803701], [165.82627329170563, -21.602289235382806], [165.83209843584368, -21.60164746326787], [165.82947903594842, -21.592293385672342], [165.83180884197537, -21.589609244212028], [165.83756500910002, -21.58783070299999], [165.83572448947703, -21.587991160162748], [165.83746667351195, -21.583144160318028], [165.841186021, -21.583323297599996], [165.8377799237924, -21.581920678704158], [165.8383476757, -21.580616968299996]], [[165.88113975699787, -21.632359843382726], [165.88010120694037, -21.63210492655043], [165.8791476291603, -21.632492022480957], [165.87982740737974, -21.632860235683165], [165.88113975699787, -21.632359843382726]], [[165.91149418918977, -21.6127107841821], [165.9112299254308, -21.612616404268184], [165.910776901844, -21.612814602087404], [165.91126767739638, -21.613286501656983], [165.91149418918977, -21.6127107841821]], [[165.9044723235945, -21.623715482144668], [165.9047932153018, -21.62402693586059], [165.9049064711985, -21.624734785214958], [165.90540668474225, -21.62361166423936], [165.9044723235945, -21.623715482144668]], [[165.89124969765493, -21.62084397326378], [165.89130632560327, -21.621589574583712], [165.89168384525894, -21.621532946635366], [165.89159890333642, -21.621013857108828], [165.89124969765493, -21.62084397326378]], [[165.89905963553144, -21.622608877654002], [165.89972973292024, -21.62248618376591], [165.89975804689442, -21.622306861929474], [165.8992295193765, -21.62204259817051], [165.89905963553144, -21.622608877654002]], [[165.9767924470264, -21.610882222212936], [165.97619813183465, -21.610957690808718], [165.9755943830684, -21.611570873149436], [165.97683018132432, -21.611212397319477], [165.9767924470264, -21.610882222212936]], [[165.9733020244716, -21.60224578478331], [165.97399067540812, -21.601877875378882], [165.97452838915305, -21.600793014314537], [165.97387511412077, -21.600976969016756], [165.9733020244716, -21.60224578478331]], [[165.97376662801437, -21.609434168531404], [165.97306854350342, -21.609886980106086], [165.97305910992893, -21.610273756659463], [165.9740307680996, -21.609651140744273], [165.97376662801437, -21.609434168531404]], [[165.9468616022478, -21.595957219877597], [165.94652219357647, -21.596258916474323], [165.94778554807527, -21.595429250833327], [165.94769126788879, -21.594995561975523], [165.9468616022478, -21.595957219877597]], [[165.91408633751007, -21.606496454737837], [165.91312463469436, -21.607260159915032], [165.91300206472764, -21.60768444056902], [165.9138387816, -21.60745114079999], [165.91469918734361, -21.60505390051426], [165.91408633751007, -21.606496454737837]], [[165.894425643427, -21.593810463183456], [165.8951278721, -21.5951578519], [165.8961981937148, -21.59556415655329], [165.89575627725046, -21.593839524809695], [165.894425643427, -21.593810463183456]], [[165.874442003, -21.606028269399996], [165.8735385509, -21.607365344599994], [165.873591074, -21.607661522199994], [165.8747212015, -21.60639249599999], [165.874442003, -21.606028269399996]], [[165.872914262026, -21.605420180550322], [165.87116092089977, -21.607147018407296], [165.8711514924408, -21.607882438207547], [165.87404937780582, -21.605475326243482], [165.8733978227922, -21.60443869356598], [165.872914262026, -21.605420180550322]], [[165.9297069369215, -21.602890069179196], [165.93018778832933, -21.60290892609715], [165.93085720891673, -21.602362075476456], [165.9302443590832, -21.602371503935434], [165.9297069369215, -21.602890069179196]], [[165.92520013353027, -21.60711873303057], [165.92562441418426, -21.606958449227953], [165.92551127267652, -21.606392741689316], [165.92520013353027, -21.6066473100817], [165.92520013353027, -21.60711873303057]], [[165.91953362968485, -21.608363289615596], [165.91985419729008, -21.60904213866197], [165.92033504869792, -21.607580727520464], [165.91954305814383, -21.608080435846276], [165.91953362968485, -21.608363289615596]], [[165.88674380647504, -21.607227160308604], [165.88711151637517, -21.60720830339065], [165.8862535266082, -21.60641631283653], [165.88614981355946, -21.6070197342111], [165.88674380647504, -21.607227160308604]], [[165.87352982121791, -21.612375098910384], [165.87438781098487, -21.612337385074472], [165.8745386663285, -21.61196024671537], [165.87322811053062, -21.611601965274218], [165.87352982121791, -21.612375098910384]], [[165.87512323078514, -21.606098102346028], [165.8750949454082, -21.60708809053869], [165.87554751143912, -21.607738654208145], [165.8757266521597, -21.607446371979833], [165.87512323078514, -21.606098102346028]], [[165.8910054699329, -21.59381046318346], [165.89108089760472, -21.593414467906403], [165.89010976633003, -21.594310171509267], [165.89047747623016, -21.594329028427218], [165.8910054699329, -21.59381046318346]], [[165.89770674715123, -21.60056595404092], [165.8976878902333, -21.59995310420738], [165.89690532813813, -21.60022652951772], [165.896961898892, -21.60083937935127], [165.89770674715123, -21.60056595404092]], [[165.8893484182676, -21.618916092326096], [165.89016869419862, -21.61893494924406], [165.88898070836746, -21.618180672525842], [165.88900899374437, -21.618331527869497], [165.8893484182676, -21.618916092326096]], [[165.88070887179146, -21.625882000971526], [165.88167826743455, -21.625985780553748], [165.8840321770497, -21.62474042556701], [165.8829519259438, -21.624273417446975], [165.88070887179146, -21.625882000971526]], [[165.9084086719573, -21.60215829144445], [165.90784259199768, -21.602158291444447], [165.90728594670406, -21.60276211006804], [165.9086728426051, -21.602252638104392], [165.9084086719573, -21.60215829144445]], [[165.8532418683274, -21.565026781118046], [165.85334433571649, -21.565506712102895], [165.85381688791713, -21.565038177685157], [165.85353165788135, -21.56476714168687], [165.8532418683274, -21.565026781118046]], [[165.85375679101472, -21.56721218872622], [165.85402054074476, -21.56643278589872], [165.85323845291796, -21.566408108707673], [165.85352741789202, -21.566989270794142], [165.85375679101472, -21.56721218872622]], [[165.8396124097869, -21.598259886408812], [165.83991424203953, -21.597788273514087], [165.8389049904448, -21.596496054182523], [165.83841451303428, -21.597693950935138], [165.8396124097869, -21.598259886408812]], [[165.83669784209744, -21.59942005412986], [165.8369336485448, -21.59910878961934], [165.8362262292027, -21.5990050347825], [165.83623566146062, -21.59940118961407], [165.83669784209744, -21.59942005412986]], [[165.87781653949722, -21.602654759886043], [165.87805234667653, -21.602352926696533], [165.87712798253364, -21.602173713240248], [165.87712798253364, -21.60225624575302], [165.87781653949722, -21.602654759886043]], [[165.87477226881234, -21.602216158532524], [165.87352249076196, -21.600980528912924], [165.87456475849453, -21.59882525129402], [165.87300843111106, -21.601574763004788], [165.87477226881234, -21.602216158532524]], [[165.86951376871374, -21.59940062081154], [165.86947603956506, -21.600956948195], [165.87067865617954, -21.597485866515516], [165.86895254762698, -21.598037655315117], [165.86951376871374, -21.59940062081154]], [[165.871180925472, -21.60441623951555], [165.87076590483642, -21.605085931904814], [165.874133231357, -21.60359563053155], [165.8735107004036, -21.60304855787555], [165.871180925472, -21.60441623951555]], [[165.94646562546458, -21.594297888595587], [165.94567367189816, -21.594618441229613], [165.9454851115252, -21.595278402534966], [165.94663532980024, -21.594976705938222], [165.94646562546458, -21.594297888595587]], [[165.9499728484016, -21.5925065650525], [165.95044424933397, -21.592638557313553], [165.95065166574423, -21.59180889167256], [165.9497842880286, -21.592242580530357], [165.9499728484016, -21.5925065650525]], [[165.9450702787047, -21.594373312744764], [165.94588108830843, -21.593543647103747], [165.9458999443457, -21.591884315821734], [165.94386349231777, -21.593694495402122], [165.9450702787047, -21.594373312744764]], [[165.94495714248092, -21.590338120763487], [165.9438823483551, -21.590583249248333], [165.9463713452781, -21.590752953583998], [165.9458245201965, -21.590375832838085], [165.94495714248092, -21.590338120763487]], [[165.95176417194466, -21.592563133164376], [165.95231099702625, -21.594071616148035], [165.953442359264, -21.591865459784444], [165.95223557287704, -21.591771179597956], [165.95176417194466, -21.592563133164376]], [[165.95282011003323, -21.5955235310198], [165.95446058527796, -21.594731577453384], [165.9547434258374, -21.59256313316438], [165.95412117660663, -21.592657413350864], [165.95282011003323, -21.5955235310198]], [[165.9490300465368, -21.594109328222626], [165.9495203035065, -21.594203608409092], [165.95106649856473, -21.593072246171367], [165.95021797688642, -21.59312881428324], [165.9490300465368, -21.594109328222626]], [[165.93868751008011, -21.569030798619362], [165.9388006463039, -21.568729102022623], [165.93731101935754, -21.568003144586736], [165.93781070434588, -21.570407289341947], [165.93868751008011, -21.569030798619362]], [[165.94168562001013, -21.57382966011111], [165.94296783054625, -21.57399936444677], [165.94173276010338, -21.571284095076198], [165.94079938625723, -21.57325455097359], [165.93882893035985, -21.57042614537924], [165.93784841642045, -21.57102011055406], [165.94054482975375, -21.574319917080796], [165.94168562001013, -21.57382966011111]], [[165.93037553313968, -21.569136863829172], [165.93072436982965, -21.567486960565805], [165.92983813607677, -21.56639331040265], [165.92872562987628, -21.569353708258074], [165.93037553313968, -21.569136863829172]], [[165.930714941811, -21.587144379446624], [165.93097892633313, -21.586569270309102], [165.93079979397882, -21.58644670606668], [165.93030010899048, -21.587295227744992], [165.9308563620907, -21.58780434075197], [165.930714941811, -21.587144379446624]], [[165.94916622418327, -21.60019869912276], [165.94942093069403, -21.59937797814365], [165.9482330651949, -21.59953885883263], [165.94856247541702, -21.600094929803564], [165.94916622418327, -21.60019869912276]], [[165.9479587266508, -21.602200975304562], [165.94793042592738, -21.60182363232566], [165.94738705784835, -21.60161180921684], [165.94745874720374, -21.60216324100667], [165.9479587266508, -21.602200975304562]], [[165.94750030913963, -21.60404671197919], [165.94765131086132, -21.604669594081177], [165.94842097179995, -21.604049955901186], [165.94773232086345, -21.603314137092326], [165.94750030913963, -21.60404671197919]], [[165.94947753214086, -21.607012098285566], [165.9495388323825, -21.606427192678357], [165.94908582721743, -21.605009347954994], [165.9485573211915, -21.606783618184917], [165.94947753214086, -21.607012098285566]], [[165.94581730524553, -21.606380048795906], [165.94655654837902, -21.60650048995674], [165.94671349482041, -21.605785733604133], [165.9464902414526, -21.60569139785941], [165.94581730524553, -21.606380048795906]], [[165.97293159895966, -21.616478663276656], [165.97315141271895, -21.615801497547416], [165.9724502649519, -21.616318218607407], [165.9726767750732, -21.617384703761825], [165.97293159895966, -21.616478663276656]], [[165.92862009471605, -21.590846399548596], [165.9286861100369, -21.591968660002983], [165.93171338403573, -21.591440537436213], [165.9302138931765, -21.590959568670044], [165.92862009471605, -21.590846399548596]], [[165.93082689258435, -21.59401513494924], [165.93352408997896, -21.59294002829545], [165.93528764212158, -21.589450647050686], [165.9318831377179, -21.590469169143756], [165.93337319781702, -21.592393044208432], [165.93082689258435, -21.59401513494924]], [[165.93091176942545, -21.59705183970819], [165.93150590731307, -21.596335101939005], [165.92972349365022, -21.597287608711216], [165.93027990849734, -21.597627116075575], [165.93091176942545, -21.59705183970819]], [[165.931345584391, -21.59908888389433], [165.93204346063996, -21.59954156038013], [165.93736240934822, -21.596108763696094], [165.93494813475724, -21.595806979372224], [165.931345584391, -21.59908888389433]], [[165.925, -21.576099999999997], [165.9259, -21.576699999999988], [165.9262, -21.574599999999993], [165.9251, -21.575299999999988], [165.925, -21.576099999999997]], [[165.92002862378112, -21.600073317059692], [165.92172631443654, -21.600946309899726], [165.92116003885843, -21.598272481395004], [165.92013188996327, -21.59910151548511], [165.92002862378112, -21.600073317059692]], [[165.92429500146844, -21.603116352194654], [165.92394427679943, -21.603475580220223], [165.92473653735806, -21.604308922866803], [165.924990350318, -21.602871212261245], [165.92429500146844, -21.603116352194654]], [[165.97502601020645, -21.614936300842523], [165.9747052686744, -21.616200399821846], [165.9785398170207, -21.616308225437056], [165.97740327097355, -21.615370245268263], [165.97502601020645, -21.614936300842523]], [[165.9772452586011, -21.609986032638044], [165.97763203515447, -21.609910564042263], [165.9765919835689, -21.60978085239327], [165.97664047444258, -21.609985860072662], [165.9772452586011, -21.609986032638044]], [[165.96682852951662, -21.608237009756245], [165.96735703554256, -21.609275146592896], [165.9668118513145, -21.606812480261013], [165.96678118164994, -21.607680672322722], [165.96682852951662, -21.608237009756245]], [[165.96547064757095, -21.60106639101651], [165.96509801681003, -21.60011618257615], [165.9653215952666, -21.60254759829116], [165.9632113727582, -21.60346307321827], [165.96719378500052, -21.602809440858046], [165.96547064757095, -21.60106639101651]], [[165.96802316828325, -21.600740339100703], [165.96757601137014, -21.60020934026638], [165.96717104049426, -21.600820949575247], [165.96765053752233, -21.600917338712144], [165.96802316828325, -21.600740339100703]], [[165.9315832002578, -21.6136715120198], [165.93128384668523, -21.614703928277848], [165.92973791455503, -21.616500870128625], [165.93157024939836, -21.61515091466177], [165.9315832002578, -21.6136715120198]], [[165.94010417005882, -21.619057519210763], [165.93950074868428, -21.619217803013388], [165.93864307388878, -21.620635757096053], [165.93961476265972, -21.620720661940116], [165.94010417005882, -21.619057519210763]], [[165.9383620106803, -21.620354252793696], [165.93690203416983, -21.620160580905203], [165.93677516731944, -21.620484815151055], [165.9375864802738, -21.62110745067417], [165.9383620106803, -21.620354252793696]], [[165.9249215077013, -21.62377487785843], [165.92360709333929, -21.623651404044104], [165.92302214404768, -21.624387307991586], [165.92345613868338, -21.624613739975434], [165.9249215077013, -21.62377487785843]], [[165.8344459624822, -21.605284489596173], [165.8339931366472, -21.60467128794462], [165.833434280866, -21.604777576614012], [165.83347900796448, -21.605048576399994], [165.8344459624822, -21.605284489596173]], [[165.88367015218904, -21.621061588228923], [165.88383054151095, -21.62128802021276], [165.88436831747256, -21.620740809585154], [165.88339256982135, -21.620681167912277], [165.88367015218904, -21.621061588228923]], [[165.88067585101524, -21.623756878162684], [165.88088206411123, -21.6228943768936], [165.8791946333416, -21.62463900461164], [165.87995882844712, -21.6250211021644], [165.88067585101524, -21.623756878162684]], [[165.8844968148142, -21.620629258959625], [165.88522818169434, -21.62040578884456], [165.884945327925, -21.6195477990776], [165.88432693096917, -21.619704335803252], [165.8844968148142, -21.620629258959625]], [[165.88226001085442, -21.622129899590885], [165.88305020767052, -21.622319766017032], [165.8832293483911, -21.621876628445076], [165.88200518508685, -21.621676876004088], [165.88226001085442, -21.622129899590885]], [[165.87924506540227, -21.60261888113001], [165.87977845522911, -21.602197293958184], [165.8792623242763, -21.599627822372653], [165.8788633245939, -21.601323186312328], [165.87924506540227, -21.60261888113001]], [[165.88014867250058, -21.604868989299803], [165.88026421801845, -21.604336065074556], [165.87976850124463, -21.603338851120768], [165.87908255083593, -21.605659739158654], [165.88014867250058, -21.604868989299803]], [[165.8479042741, -21.598302544599996], [165.84874708452884, -21.598634444771143], [165.8497334416, -21.597436493599993], [165.84764647877995, -21.59731297256593], [165.8479042741, -21.598302544599996]], [[165.9686488222746, -21.591966382147834], [165.96661845620895, -21.59144903513058], [165.965, -21.59449999999999], [165.9669800758719, -21.591883011710188], [165.9686488222746, -21.591966382147834]], [[165.96179753180658, -21.592345391473508], [165.9611260666309, -21.593069668516932], [165.96136131949632, -21.593955810505694], [165.962619888033, -21.59083648096635], [165.96179753180658, -21.592345391473508]], [[165.935110610473, -21.569306341204776], [165.93416656455665, -21.569589010822924], [165.93444581152283, -21.570447270799214], [165.9356960286324, -21.568972833038302], [165.935110610473, -21.569306341204776]], [[165.9337983470651, -21.551357752450055], [165.93362096405295, -21.5518976137913], [165.93362867635784, -21.553267830910528], [165.9339774439227, -21.550707348072276], [165.9337983470651, -21.551357752450055]], [[165.9298, -21.57929999999999], [165.9294, -21.580099999999995], [165.9274, -21.57959999999998], [165.9296, -21.580899999999993], [165.9298, -21.57929999999999]], [[165.9249, -21.57409999999999], [165.9238, -21.574499999999997], [165.9234, -21.575599999999994], [165.92468664027797, -21.574522315686554], [165.9249, -21.57409999999999]], [[165.9233, -21.57209999999999], [165.9221, -21.572399999999988], [165.9224, -21.57479999999999], [165.9237, -21.572799999999987], [165.9233, -21.57209999999999]], [[165.9229, -21.577399999999994], [165.9221, -21.575999999999993], [165.9212, -21.57639999999999], [165.9215, -21.57689999999999], [165.9229, -21.577399999999994]], [[165.9265, -21.57899999999999], [165.9269, -21.578799999999983], [165.9272, -21.577999999999992], [165.9264, -21.578499999999984], [165.9265, -21.57899999999999]], [[165.9193, -21.57539999999999], [165.9204, -21.575299999999995], [165.9211, -21.574299999999997], [165.9205, -21.57419999999999], [165.9193, -21.57539999999999]], [[165.9193, -21.57209999999999], [165.9185, -21.57239999999999], [165.9175, -21.573899999999988], [165.9203, -21.574099999999994], [165.9207, -21.573799999999988], [165.9193, -21.57209999999999]], [[165.96034897771975, -21.595385846145422], [165.96158628433562, -21.59478228194256], [165.96136749231206, -21.594156084082087], [165.9596020670187, -21.595959232138135], [165.96034897771975, -21.595385846145422]], [[165.8581264466, -21.564290954599997], [165.8591257334, -21.565384513799987], [165.8596442313, -21.564941433699993], [165.8585600994, -21.564045846499994], [165.8581264466, -21.564290954599997]], [[165.8588039671, -21.570450830199995], [165.8581765119, -21.57207198059999], [165.8606136234, -21.569677956099998], [165.8599538528, -21.569225542099986], [165.8588039671, -21.570450830199995]], [[165.84328884820002, -21.590961369599995], [165.8434774426, -21.5920552169], [165.8436848964, -21.58983923309999], [165.8425298768, -21.588097394799995], [165.84328884820002, -21.590961369599995]], [[165.8553543098, -21.570978646599993], [165.8575975296, -21.569640254999992], [165.8587687793, -21.56779855269999], [165.8540941018, -21.571594844399993], [165.8553543098, -21.570978646599993]], [[165.8462871779, -21.565662781299988], [165.84588986550003, -21.5647275022], [165.8449362898, -21.565916734699996], [165.8455017368, -21.566020942399987], [165.8462871779, -21.565662781299988]], [[165.8487000529, -21.579536812699992], [165.8513202844, -21.579536812699992], [165.8503212033, -21.57833037519999], [165.8460560697, -21.58006048199999], [165.8487000529, -21.579536812699992]], [[165.8474559142, -21.582364400599992], [165.8476444201, -21.5829487688], [165.8485869494, -21.582326699499998], [165.8477198224, -21.58176746539999], [165.8474559142, -21.582364400599992]], [[165.8524733941, -21.58499235769999], [165.851068366, -21.58510551439999], [165.8507327026, -21.586296254199993], [165.8525959804, -21.58553928139999], [165.8524733941, -21.58499235769999]], [[165.8373575553, -21.58434170719999], [165.8379795214, -21.58467338479999], [165.8382250894, -21.584454863799994], [165.8379893464, -21.58419083169999], [165.8373575553, -21.58434170719999]], [[165.8393472259, -21.58676514479999], [165.8390266155, -21.586086205099985], [165.8383665352, -21.586189932], [165.8386871456, -21.587246060499997], [165.8400882717, -21.586541757999992], [165.8393472259, -21.58676514479999]], [[165.8379139087, -21.590084405699994], [165.83585823000004, -21.589367747099992], [165.8356130573, -21.591847763099985], [165.8389511777, -21.59073505629999], [165.8379139087, -21.590084405699994]], [[165.8515587114, -21.589537482099992], [165.8514738439, -21.590999088399997], [165.8521527836, -21.591159393699993], [165.8535389523, -21.58866994799999], [165.8515587114, -21.589537482099992]], [[165.94940024992954, -21.58339937078003], [165.94900435161261, -21.583738712194528], [165.95009778505934, -21.583437075381635], [165.95040884802262, -21.582532164942982], [165.94940024992954, -21.58339937078003]], [[165.93245040755747, -21.550726200373074], [165.93239385065507, -21.551895043023006], [165.93267663516716, -21.552074139880652], [165.93305368118325, -21.551593406210124], [165.93245040755747, -21.550726200373074]], [[165.9302706297026, -21.55612366029741], [165.93104353867324, -21.55494544540312], [165.93071363850282, -21.554624970951874], [165.9298936009364, -21.554624970951874], [165.9302706297026, -21.55612366029741]], [[165.93176931904813, -21.554474159445405], [165.93212749637598, -21.554493010883714], [165.93097755863917, -21.553993447768526], [165.93108124154986, -21.55421966502823], [165.93176931904813, -21.554474159445405]], [[165.94574766055405, -21.561901626139036], [165.94624722366925, -21.56213726911789], [165.9470389840782, -21.561524597372863], [165.94558742332842, -21.561166420044987], [165.94574766055405, -21.561901626139036]], [[165.94888642503247, -21.563390889765408], [165.94862250489612, -21.562514297884057], [165.9478872988021, -21.562919603807703], [165.94809466462348, -21.56347572123781], [165.94888642503247, -21.563390889765408]], [[165.94328754785477, -21.562740515143766], [165.94355146799109, -21.563287206854724], [165.9458607691839, -21.56267453510969], [165.94521039456225, -21.56218439771366], [165.94328754785477, -21.562740515143766]], [[165.9460843349527, -21.577818965693442], [165.94646136371887, -21.577196868229258], [165.94527372310543, -21.577130888195175], [165.94505693156486, -21.577724708501897], [165.9460843349527, -21.577818965693442]], [[165.95010911703162, -21.578195994459623], [165.95090087744057, -21.578346805966092], [165.94986404833358, -21.577159165352647], [165.949157119397, -21.577894371446682], [165.95010911703162, -21.578195994459623]], [[165.97037074207705, -21.601699863310074], [165.97097626706355, -21.601308601011105], [165.97092968821843, -21.600917338712136], [165.9705943205336, -21.6011036540926], [165.97037074207705, -21.601699863310074]], [[165.96195860264928, -21.600675128717544], [165.96156734035029, -21.60044223449196], [165.9613344461247, -21.60060060256536], [165.96186544495905, -21.601103654092597], [165.9625454960977, -21.60053539218219], [165.96195860264928, -21.600675128717544]], [[165.9739107343058, -21.597498451480693], [165.97335178816442, -21.597274873024134], [165.97311889393885, -21.597600924939947], [165.9739200500748, -21.597712714168217], [165.9739107343058, -21.597498451480693]], [[165.96740832752772, -21.5982716603096], [165.96778095828864, -21.599259131826038], [165.96826537827783, -21.599762183353285], [165.96786480020987, -21.597796556089424], [165.96740832752772, -21.5982716603096]], [[165.94835122919415, -21.587547427243734], [165.947257579031, -21.587886835915054], [165.9494637353946, -21.58843366099663], [165.94927517502165, -21.58794340402693], [165.94835122919415, -21.587547427243734]], [[165.95698729427556, -21.59354364710375], [165.95664788560424, -21.593034534096766], [165.95661017352967, -21.594165896334506], [165.9568175899399, -21.59397733596155], [165.95698729427556, -21.59354364710375]]], [[[165.85332820502526, -21.582497589093446], [165.85332937532553, -21.582530240597386], [165.85332480699134, -21.582484557279585], [165.85332820502526, -21.582497589093446]]], [[[165.8389040291, -21.578721594899992], [165.8387625833, -21.578844181299996], [165.83798985164148, -21.578689174638264], [165.83822718247214, -21.578249620387158], [165.8389040291, -21.578721594899992]]], [[[165.8612922445, -21.567020023499992], [165.86193558718549, -21.56670487649478], [165.86226312940886, -21.56720852929999], [165.8617069574, -21.56718967869999], [165.8612922445, -21.567020023499992]]], [[[165.85033129852982, -21.563941700422916], [165.85058848032543, -21.563947266841552], [165.85093378642543, -21.564000816330818], [165.85029964193777, -21.564017263046644], [165.85001235540378, -21.563900719570643], [165.85033129852982, -21.563941700422916]]], [[[165.9265695784612, -21.627057318467717], [165.9270535626744, -21.625982403804027], [165.92792207460627, -21.626074475498196], [165.92614600839562, -21.627707997254127], [165.9265695784612, -21.627057318467717]]], [[[165.9379734592613, -21.61566114681918], [165.93826115167244, -21.615732375131785], [165.93911393042956, -21.615557411632167], [165.9380299597189, -21.616556420501894], [165.9379734592613, -21.61566114681918]]], [[[165.9353427982753, -21.607764582470534], [165.9356162235856, -21.60780229630644], [165.93582424383285, -21.60790178425077], [165.9350206995413, -21.607969215186014], [165.9353427982753, -21.607764582470534]]], [[[165.97352878777585, -21.595216088070035], [165.97364989277315, -21.594965532946794], [165.97386429992994, -21.595381999334858], [165.97364057700412, -21.595393087681483], [165.97352878777585, -21.595216088070035]]], [[[165.97347565745304, -21.59463368073159], [165.97363852181047, -21.594943875574703], [165.97343563008562, -21.59469440500475], [165.97347565745304, -21.59463368073159]]], [[[165.97055875485378, -21.59074388687177], [165.96986007217706, -21.590706623795686], [165.9694, -21.5895609252384], [165.97117163172126, -21.590479732300373], [165.97055875485378, -21.59074388687177]]], [[[165.92579341310432, -21.555501562833243], [165.92519016707843, -21.55586916588025], [165.92456255489, -21.55536742221933], [165.92528050005487, -21.554789309621885], [165.92579341310432, -21.555501562833243]]], [[[165.92874135662876, -21.551664798819115], [165.92972139289574, -21.550984087807276], [165.92984647234064, -21.551043197673213], [165.92980876946402, -21.55204232390358], [165.92874135662876, -21.551664798819115]]]]}", "forest_cover_percentage": null, "forest_fragmentation_effective_mesh_size": 58.94013986900424, "forest_fragmentation_fragment_size_distribution": {"10": 0.1159611940696505, "100": 0.1159611940696505, "1000": 0.1159611940696505, "1100": 0.1159611940696505, "1200": 0.1159611940696505, "12000": 100.0, "125": 0.1159611940696505, "1300": 0.1159611940696505, "1400": 0.1159611940696505, "150": 0.1159611940696505, "1500": 0.1159611940696505, "1600": 0.1159611940696505, "1700": 0.1159611940696505, "17000": 100.0, "175": 0.1159611940696505, "1800": 0.1159611940696505, "1900": 0.1159611940696505, "20": 0.1159611940696505, "200": 0.1159611940696505, "2000": 0.1159611940696505, "225": 0.1159611940696505, "250": 0.1159611940696505, "27000": 100.0, "275": 0.1159611940696505, "30": 0.1159611940696505, "300": 0.1159611940696505, "325": 0.1159611940696505, "350": 0.1159611940696505, "375": 0.1159611940696505, "40": 0.1159611940696505, "400": 0.1159611940696505, "425": 0.1159611940696505, "450": 0.1159611940696505, "475": 0.1159611940696505, "50": 0.1159611940696505, "500": 0.1159611940696505, "500000": 100.0, "60": 0.1159611940696505, "600": 0.1159611940696505, "70": 0.1159611940696505, "700": 0.1159611940696505, "7000": 100.0, "80": 0.1159611940696505, "800": 0.1159611940696505, "90": 0.1159611940696505, "900": 0.1159611940696505}, "forest_humidity_category_distribution": null, "frequencies": {}, "id": 161, "land_use_category_distribution": null, "name": "48.0", "num_families_unique_taxonomic_count": 68, "num_occurrences_count": 1942, "num_species_unique_taxonomic_count": 309, "rainfall_mean": "2221.634521484375", "rainfall_range": "{\"min\": 1830.0, \"max\": 2620.0}", "shape_area": "6296.821309606773", "shape_coordinates": "{\"type\": \"FeatureCollection\", \"features\": [{\"id\": \"0\", \"type\": \"Feature\", \"properties\": {}, \"geometry\": {\"type\": \"Polygon\", \"coordinates\": [[[165.8219455726786, -21.60485528383073], [165.82627329170563, -21.602289235382806], [165.83209843584368, -21.60164746326787], [165.82949896913698, -21.595792006043737], [165.82983669976005, -21.59147349109374], [165.83268162065102, -21.589266008142918], [165.8357778674161, -21.589216485865624], [165.83931270620354, -21.57705030065963], [165.84716704975662, -21.576033056918583], [165.84313878594753, -21.57224249777545], [165.8441032400715, -21.56554900347967], [165.85527123610615, -21.562970489169373], [165.86136325464327, -21.565330869597148], [165.86369018648637, -21.57525289569842], [165.86073474638232, -21.579445223487586], [165.85252225165607, -21.580582049877414], [165.8537585483775, -21.591570370910055], [165.86075753235912, -21.59510657816664], [165.8652811184835, -21.594191703244004], [165.87052768016477, -21.596931842749083], [165.87906300758158, -21.59491337927211], [165.88388769557642, -21.595953291840168], [165.88929551275535, -21.592639228851557], [165.8937587072419, -21.592312444364225], [165.90289542355634, -21.599094422446964], [165.9126766807287, -21.60235735608854], [165.91613464918728, -21.598693346765028], [165.92043942395748, -21.59836109538479], [165.9264002935823, -21.595132944234344], [165.92856454780062, -21.590577402584362], [165.92519875345982, -21.588311019207456], [165.9237343559796, -21.583356664590355], [165.91640963945162, -21.579569101805554], [165.91537936239422, -21.5754419471193], [165.92041666698805, -21.571318797131042], [165.92928457851258, -21.57250841056196], [165.92734425216264, -21.56551715869044], [165.92317670626812, -21.56147400358596], [165.92267191299854, -21.558169909480362], [165.92732617153555, -21.55237330735576], [165.93336074845885, -21.55044815222126], [165.9372040537444, -21.552796565526574], [165.9378141152854, -21.55834392258378], [165.9445122446782, -21.55782951199781], [165.95303796656512, -21.567429958152413], [165.95342845182577, -21.571744461287004], [165.95029559398412, -21.574747756463776], [165.9573021812013, -21.589267774116877], [165.9641993798605, -21.587517443931738], [165.97213111856212, -21.591310023434858], [165.97984503341243, -21.613244164786224], [165.97700392881677, -21.618606384055088], [165.97178799338536, -21.619684859337262], [165.96293468698659, -21.613949104660605], [165.96104219071358, -21.607897369765713], [165.95755783043538, -21.6042311880985], [165.95648713957573, -21.60878993230322], [165.95135367143382, -21.610449077831788], [165.94410890564112, -21.60688858630458], [165.94232385325174, -21.602285609878003], [165.93994658370912, -21.601878993896865], [165.93820891223504, -21.606921962665883], [165.93064652944472, -21.608819164099256], [165.93064296999114, -21.61119536429974], [165.93560483589962, -21.612442097316887], [165.94039497436728, -21.61686763934147], [165.94097000769088, -21.62117869388628], [165.93924686552646, -21.62423741116457], [165.93436889936456, -21.625294198045747], [165.93099602387932, -21.62404356135045], [165.92488157889485, -21.628466679581337], [165.916324493436, -21.629703218729663], [165.9120561561447, -21.626284168056205], [165.89963292725614, -21.625814507274345], [165.89450719632077, -21.62118308123352], [165.89273632476386, -21.621929823419954], [165.89381208306202, -21.62961643616857], [165.89271910921377, -21.637036453764896], [165.8903897334282, -21.63972142124097], [165.8867479624241, -21.640256495007716], [165.8834337097332, -21.638640442652783], [165.87986171168612, -21.633066778237126], [165.87507829930058, -21.62933560790303], [165.87552826057023, -21.62263324027225], [165.88133510277152, -21.617933919256437], [165.87635107259263, -21.613176510051368], [165.86899492353527, -21.613852392065866], [165.86611202548764, -21.60948807801976], [165.8614133752155, -21.607270386339522], [165.85876397722927, -21.609047921768706], [165.85436992229012, -21.60912133677079], [165.84859519351804, -21.612737183883564], [165.83273342144244, -21.61261291460731], [165.8300835610846, -21.61439000662063], [165.82264100924263, -21.614599739122013], [165.81937124578343, -21.61298612778773], [165.81827992290025, -21.61052820084856], [165.8188121062553, -21.607117656130967], [165.8219455726786, -21.60485528383073]]]}, \"bbox\": [165.81827992290025, -21.640256495007716, 165.97984503341243, -21.55044815222126]}], \"bbox\": [165.81827992290025, -21.640256495007716, 165.97984503341243, -21.55044815222126]}", "shape_id": 161, "type": "hotspots"};
    var mapping = {"fields": {"elevation": {"data_source": {"name": "elevation", "type": "layer"}, "description": "Altitude metrics within the shape", "field_type": "JSON", "label": "Altitude", "transformations": [{"chart_options": {"title": "Median Altitude"}, "chart_type": "text", "name": "median"}, {"chart_options": {"title": "Maximum Altitude"}, "chart_type": "text", "name": "max"}, {"chart_options": {"title": "Elevation Distribution", "x_label": "Elevation (m)", "y_label": "Area (ha)"}, "chart_type": "stacked_bar", "data_structure": {"x_field": "altitudes", "y_fields": [{"color": "#4BC0C0", "label": "For\u00eat", "name": "forest"}, {"color": "#FF6384", "label": "Hors-for\u00eat", "name": "non_forest"}]}, "name": "elevation_distribution"}]}, "forest": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "TEXT", "label": "Forest Area", "transformations": [{"chart_options": {"title": "Forest Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "forest_coordinates", "title": "Forest Location"}, "chart_type": "map", "name": "coordinates"}]}, "forest_cover": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Area covered by forest within the shape", "field_type": "JSON", "label": "Forest Area", "transformations": [{"chart_options": {"categories": ["UM", "Non-UM", "Commune"], "title": "Forest Cover"}, "chart_type": "donut", "layer_params": {"forest_cover": [{"name": "area"}, {"attribute": "cover_type"}], "soil_types": [{"attribute": "soil_category"}]}, "name": "percentage"}]}, "forest_fragmentation": {"data_source": {"name": "forest_cover", "type": "layer"}, "description": "Analysis of forest fragmentation", "field_type": "JSON", "label": "Forest Fragmentation", "transformations": [{"chart_options": {"bins": [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400, 425, 450, 475, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 7000, 12000, 17000, 27000, 500000], "title": "Forest Fragment Distribution", "x_label": "Area (ha)", "y_label": "Cumulative Area (%)"}, "chart_type": "line", "data_structure": {"color": "#4BC0C0", "x_field": "keys", "y_field": "values"}, "name": "fragment_size_distribution"}, {"chart_options": {"label": "Effective Mesh Size (km\u00b2)", "max": 1000, "min": 0, "title": "Fragmentation"}, "chart_type": "gauge", "name": "effective_mesh_size"}]}, "forest_humidity": {"data_source": [{"name": "forest_cover", "type": "layer"}, {"name": "holdridge", "type": "shape"}], "description": "Distribution of forests by humidity level", "field_type": "JSON", "label": "Forest and Living Environments", "transformations": [{"chart_options": {"categories": ["Dry", "Humid", "Very Humid"], "title": "Forest and Living Environments", "x_label": "Category", "y_label": "Frequency (%)"}, "chart_type": "stacked_bar", "layer_params": {"forest_cover": [{"name": "area"}], "humidity": [{"name": "value"}]}, "name": "category_distribution"}]}, "land_use": {"data_source": [{"name": "ultramafic", "type": "shape"}, {"name": "holdridge", "type": "shape"}, {"name": "forest_cover", "type": "layer"}], "description": "Land use distribution", "field_type": "JSON", "label": "Land Use", "transformations": [{"chart_options": {"title": "Land Use", "x_label": "Category", "y_label": "Area (ha)"}, "chart_type": "bar", "name": "category_distribution"}]}, "num_families": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of families in the zone", "field_type": "INTEGER", "label": "Number of Families", "transformations": [{"chart_options": {"title": "Number of Families"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["family"]}]}, "num_occurrences": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of occurrences in the zone", "field_type": "INTEGER", "label": "Number of Occurrences", "source_field": "id_occurrence", "transformations": [{"chart_options": {"title": "Number of Occurrences"}, "chart_type": "text", "name": "count"}]}, "num_species": {"data_source": {"name": "occurrences", "type": "source"}, "description": "Total number of species in the zone", "field_type": "INTEGER", "label": "Number of Species", "transformations": [{"chart_options": {"title": "Number of Species"}, "chart_type": "text", "name": "unique_taxonomic_count", "target_ranks": ["species", "infra"]}]}, "rainfall": {"data_source": {"name": "rainfall", "type": "layer"}, "description": "Average annual rainfall within the shape", "field_type": "TEXT", "label": "Average Rainfall", "transformations": [{"chart_options": {"title": "Average Rainfall"}, "chart_type": "text", "name": "mean"}, {"chart_options": {"title": "Rainfall Range"}, "chart_type": "text", "name": "range"}]}, "shape": {"data_source": {"name": "self", "type": "shape"}, "description": "Total area of the reference zone", "field_type": "TEXT", "label": "Shape Area", "transformations": [{"chart_options": {"title": "Total Area"}, "chart_type": "text", "name": "area"}, {"chart_options": {"coordinates_field": "shape_coordinates", "title": "Location"}, "chart_type": "map", "name": "coordinates"}]}}, "group_by": "shape", "source_location_field": "geo_pt", "source_table_name": "occurrences"};
    var currentShapeType = "hotspots";

    document.addEventListener('DOMContentLoaded', function () {
        loadShapeCharts(shape, mapping);
        loadShapeTypeList();
        initShapeMaps(mapping, shape);
        loadAllShapesMap(shape);
    });

    function loadShapeCharts(shape, mapping) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            if (field.field_type !== 'TEXT' && shape[field_key] !== null) {
                // Handle bins chart if present
                if (field.bins && field.bins.values && field.bins.values.length > 0) {
                    var binChartId = field_key + 'BinChart';
                    var binCtx = document.getElementById(binChartId);
                    if (binCtx) {
                        createBinChart(binCtx, field, shape);
                    }
                }

                // Handle transformations
                field.transformations.forEach(function(transformation) {
                    var transformationName = transformation.name ? transformation.name : '';
                    var valueKey = field_key + '_' + transformationName;

                    if (shape[valueKey] !== null) {
                        switch(transformation.chart_type) {
                            case 'pie':
                                var pieChartId = field_key + 'PieChart';
                                var pieCtx = document.getElementById(pieChartId);
                                if (pieCtx) {
                                    createPieChart(pieCtx, transformation, shape[valueKey]);
                                }
                                break;
                            case 'gauge':
                                var gaugeId = field_key + transformationName + 'Gauge';
                                var gaugeElement = document.getElementById(gaugeId);
                                if (gaugeElement) {
                                    createGauge({
                                        id: gaugeId,
                                        value: parseFloat(shape[valueKey]),
                                        min: 0,
                                        max: transformation.chart_options.max,
                                        title: transformation.chart_options.title,
                                        label: transformation.chart_options.label
                                    });
                                }
                                break;
                            case 'bar':
                                var barChartId = field_key + transformationName + 'BarChart';
                                var barCtx = document.getElementById(barChartId);
                                if (barCtx) {
                                    createBarChart(barCtx, field, transformation, shape[valueKey]);
                                }
                                break;
                            case 'stacked_bar':
                                if (field_key === 'elevation' && transformationName === 'elevation_distribution') {
                                    var stackedBarChartId = 'elevationDistributionChart';
                                    var stackedBarCtx = document.getElementById(stackedBarChartId);
                                    if (stackedBarCtx) {
                                        createElevationDistributionChart(stackedBarCtx, shape.elevation_elevation_distribution, transformation);
                                    }
                                }
                                break;
                            case 'line':
                                if (field_key === 'forest_fragmentation' && transformationName === 'fragment_size_distribution') {
                                    var lineChartId = 'forestFragmentationChart';
                                    var lineCtx = document.getElementById(lineChartId);
                                    if (lineCtx) {
                                        createForestFragmentationChart(lineCtx, shape.forest_fragmentation_fragment_size_distribution, transformation);
                                    }
                                }
                                break;
                        }
                    }
                });
            }
        });
    }

    function createBinChart(ctx, field, shape) {
        var binData = {
            labels: field.bins.values,
            datasets: [{
                label: field.label,
                data: field.bins.values.map(value => shape.frequencies[field.field_key][value] || 0),
                backgroundColor: field.bins.chart_options.color
            }]
        };

        new Chart(ctx, {
            type: field.bins.chart_type,
            data: binData,
            options: field.bins.chart_options
        });
    }

    function createPieChart(ctx, transformation, data) {
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['True', 'False'],
                datasets: [{
                    data: [data.true || 0, data.false || 0],
                    backgroundColor: ['#FF6384', '#36A2EB']
                }]
            },
            options: {
                title: {
                    display: true,
                    text: transformation.chart_options.title
                }
            }
        });
    }

    function createBarChart(ctx, field, transformation, data) {
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: Object.keys(data),
                datasets: [{
                    label: field.label,
                    data: Object.values(data),
                    backgroundColor: getColor(0).background,
                    borderColor: getColor(0).border,
                    borderWidth: 1
                }]
            },
            options: transformation.chart_options
        });
    }

    function createElevationDistributionChart(ctx, elevationData, chartConfig) {
        const altitudes = elevationData.altitudes.reverse();
        const forestData = elevationData.forest.reverse();
        const nonForestData = elevationData.non_forest.reverse();

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: altitudes,
                datasets: [
                    {
                        label: 'Forest',
                        data: forestData,
                        backgroundColor: '#4CAF50',
                        stack: 'Stack 0',
                    },
                    {
                        label: 'Non-Forest',
                        data: nonForestData,
                        backgroundColor: '#FFF59D',
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Area (ha)'
                        },
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString(); // Format les grands nombres
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Elevation (m)'
                        },
                        reverse: false
                    }
                },
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                layout: {
                    padding: {
                        left: 10,
                        right: 10,
                        top: 0,
                        bottom: 10
                    }
                }
            }
        });
    }

    function createForestFragmentationChart(ctx, fragmentationData, chartConfig) {
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: Object.keys(fragmentationData),
                datasets: [{
                    label: 'Cumulative Area (%)',
                    data: Object.values(fragmentationData),
                    borderColor: '#4BC0C0',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.x_label
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: chartConfig.chart_options.y_label
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: chartConfig.chart_options.title
                    }
                }
            }
        });
    }

    function createGauge(options) {
        new JustGage({
            id: options.id,
            value: options.value || 0,
            min: options.min || 0,
            max: options.max,
            title: options.title,
            label: options.label,
            pointer: true,
            pointerOptions: {
                toplength: 10,
                bottomlength: 10,
                bottomwidth: 2,
                color: '#8e8e93',
                stroke: '#ffffff',
                stroke_width: 3,
                stroke_linecap: 'round'
            },
            gaugeWidthScale: 0.6,
            counter: true,
            donut: true,
            relativeGaugeSize: true,
            donutStartAngle: 270,
            hideInnerShadow: true,
            customSectors: [{
                color: "#ff0000",
                lo: 0,
                hi: options.max * 0.33
            }, {
                color: "#ffff00",
                lo: options.max * 0.33,
                hi: options.max * 0.66
            }, {
                color: "#00ff00",
                lo: options.max * 0.66,
                hi: options.max
            }],
            humanFriendly: true,
            formatNumber: true,
            textRenderer: function (val) {
                return parseFloat(val).toFixed(2);
            }
        });
    }

    // Function to get a color based on the index
    function getColor(index) {
        var colors = [
            {background: 'rgba(54, 162, 235, 0.6)', border: 'rgba(54, 162, 235, 1)'},
            {background: 'rgba(75, 192, 192, 0.6)', border: 'rgba(75, 192, 192, 1)'},
            {background: 'rgba(255, 99, 132, 0.6)', border: 'rgba(255, 99, 132, 1)'}
        ];
        return colors[index % colors.length];
    }

// Rest of the code (loadShapeTypeList, initShapeMaps, loadAllShapesMap) remains the same...

    let maps = {};  // Object to keep track of initialized maps

    function initMap(field_key, geometry) {
        const mapId = field_key + 'Map';
        const mapLoaderId = field_key + 'MapLoader';

        // Check if the map already exists
        if (maps[mapId]) {
            return; // Map is already initialized, so do nothing
        }

        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        map.on('load', function () {
            document.getElementById(mapLoaderId).style.display = 'none';
        });

        if (geometry) {
            const geoJsonLayer = L.geoJSON(geometry, {
                style: function() {
                    return {
                        color: '#228b22', // Border color
                        weight: 2,       // Border width
                        fillColor: '#228b22cc', // Fill color with opacity
                        fillOpacity: 0.8 // Fill opacity
                    };
                }
            }).addTo(map);
            map.fitBounds(geoJsonLayer.getBounds());
        } else {
            console.warn("No geographic coordinates found.");
            // Set default view if no geometry is found
            map.setView([-21.291237, 165.516418], 10);
        }

        // Store the map instance in the maps object
        maps[mapId] = map;
    }

    function initShapeMaps(mapping, shape) {
        Object.entries(mapping.fields).forEach(function([field_key, field]) {
            field.transformations.forEach(function(transformation) {
                if (transformation.chart_type === 'map') {
                    var coordinatesField = transformation.chart_options.coordinates_field;
                    var geometry = shape[coordinatesField];

                    // Check if geometry is a string, if so, parse it as JSON
                    if (typeof geometry === 'string') {
                        try {
                            geometry = JSON.parse(geometry);
                        } catch (e) {
                            console.error("Invalid JSON for field", coordinatesField, ":", geometry);
                            return; // Skip this field if JSON is invalid
                        }
                    }

                    // Initialize the map with the parsed geometry
                    initMap(field_key, geometry);
                }
            });
        });
    }

    function loadAllShapesMap(currentShape) {
        const mapId = 'allShapesMap';
        const satellite = L.tileLayer.wms("https://carto10.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer", {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const carte = L.tileLayer.wms('https://carto.gouv.nc/arcgis/services/fond_cartographie/MapServer/WMSServer', {
            layers: '0',
            format: 'image/png',
            transparent: true,
            attribution: "<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>"
        });
        const map = L.map(mapId, {
            layers: [carte, satellite],
            scrollWheelZoom: false
        });
        map.attributionControl.setPrefix(false); // Remove the "Powered by Leaflet" prefix
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        const baseMaps = {
            "Carte": carte,
            "Satellite": satellite,
        };

        L.control.layers(baseMaps).addTo(map);

        var group = L.featureGroup(); // Create a group to hold all the layers

        shapeTypes.forEach(function(shapeTypeItem) {
            if (shapeTypeItem.type === currentShape.type) {
                shapeTypeItem.shapes.forEach(function(shapeItem) {
                    var geometry = shapeItem.geometry;
                    // No need to parse geometry if it's already GeoJSON
                    var layer = L.geoJSON(geometry, {
                        style: function() {
                            return {
                                color: '#228b22', // Border color
                                weight: 2,       // Border width
                                fillColor: '#228b22cc', // Fill color with opacity
                                fillOpacity: 0.8 // Fill opacity
                            };
                        }
                    }).addTo(map);
                    group.addLayer(layer); // Add each layer to the group

                    // Highlight current shape
                    if (shapeItem.id === currentShape.id) {
                        layer.setStyle({color: 'red', weight: 3, fillOpacity: 0.4});
                        layer.bringToFront(); // Ensure the highlighted shape is on top
                    } else {
                        layer.setStyle({fillOpacity: 0.2}); // Reduce opacity for other shapes
                    }

                    // Show tooltip on hover with additional content
                    var tooltipContent = "<strong>" + shapeItem.name + "</strong><br>";

                    


                    layer.bindTooltip(tooltipContent, {
                        permanent: false,
                        direction: 'right',
                        offset: L.point(10, 0),
                        opacity: 0.9,
                        className: 'custom-tooltip'
                    });


                    layer.on('mousemove', function(e) {
                        var tooltip = e.target.getTooltip();
                        tooltip.setLatLng(e.latlng);
                    });

                    layer.on('click', function() {
                        window.location.href = '../shape/' + shapeItem.id + '.html';
                    });
                });
            }
        });

        map.fitBounds(group.getBounds()); // Adjust the view to fit the bounds of the group

        map.attributionControl.setPrefix(false);
        map.attributionControl.addAttribution("<a href='http://www.geoportal.gouv.nc/'>Géorep</a> <i> - Gouvernement de la Nouvelle-Calédonie</i>");

        maps['allShapesMap'] = map;
    }

    function loadShapeTypeList() {
            var shapeTypeListElement = document.getElementById("shape-type-list");
            shapeTypes.forEach(function (shapeTypeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "javascript:void(0)";
                a.textContent = shapeTypeItem.type;
                a.className = "shape-type-link";
                if (shapeTypeItem.type === currentShapeType) {
                    a.classList.add("active");
                }
                a.onclick = function () {
                    if (shapeTypeItem.shapes.length > 0) {
                        // Redirect to the first shape of the selected type
                        window.location.href = "../shape/" + shapeTypeItem.shapes[0].id + ".html";
                    }
                    loadShapeList(shapeTypeItem.shapes);
                };
                li.appendChild(a);
                shapeTypeListElement.appendChild(li);
            });
        }

        function loadShapeList(shapes) {
            var shapeListElement = document.getElementById("shape-list");
            shapeListElement.innerHTML = ''; // Clear the previous list
            shapes.forEach(function (shapeItem) {
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = "../shape/" + shapeItem.id + ".html";
                a.textContent = shapeItem.name;
                a.className = "shape-link";
                if (shapeItem.id === shape.id) {
                    a.classList.add("active");
                }
                li.appendChild(a);
                shapeListElement.appendChild(li);
            });
        }

</script>

</body>
</html>